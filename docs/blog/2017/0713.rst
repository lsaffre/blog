:date: 2017-07-13

=======================
Thursday, July 13, 2017
=======================

I continued to work for :ticket:`1933` and added an example (in
:ref:`tera.specs.misc`) for testing intracom purchases.  The
:class:`lino_xl.lib.bevat.Declaration` now produces movements when
registered, which is equally shown in :ref:`tera.specs.misc`.


- :mod:`lino_xl.lib.vat.fixtures.novat` now creates a rule for intracom
  VAT.
     
- :mod:`lino_xl.lib.vat.fixtures.demo` assigns VAT regimes to
  partners.  Until now it also assigned useless regimes, i.e. for
  which there was no VAT rule.

- Fixed a bug which caused the returnable VAT to be added instead of
  removed from invoice total.


I think that I will soon abandon the :ref:`presto` project because I
realized that there won't be any real user for this combination.

The test suites in voga and welfare are still failing for trivial
reasons.

TODO : actually the VAT declaration should clear the 4510 movements of
the individual invoices.  This is a new feature which doesn't exist in
TIM: one voucher sets the match of movements generated by other
vouchers.  I guess that we need to add some configuration option
"automatic match assignment" on the ledger account and/or on the VAT
journal.


