<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20130110 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2013" href="index.html" />
    <link rel="next" title="20130111" href="0111.html" />
    <link rel="prev" title="20130109" href="0109.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0111.html" title="20130111"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0109.html" title="20130109"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2013</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20130110<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Excerpt from an email to a user:</p>
<blockquote>
<div>Stimmt, du hast Recht. Er wird zwar dann &#8220;ANDERLECHT&#8221; und nicht
&#8220;Anderlecht&#8221; eintragen, aber das kann man dann ja immer noch
korrigieren. Inzwischen habe ich noch weitere Ideen gehabt, was das
automatische Erstellen von Ortsnamen betrifft. Zur Erinnerung: die
Combobox für Städte ist ja &#8220;lernfähig&#8221;, d.h. &#8220;editierbar&#8221;, und wenn man
dort einen unbekannten Ort einträgt (und den Record speichert), wird der Ort
stillschweigend angelegt. Bisher kommt dann lediglich ein Eintrag in die
system.log, wo es natürlich niemand bemerkt. Willst du vielleicht auch
gar nicht immer bemerken. Aber andere Systemverwalter wollen vielleicht
so eine Mail geschickt kriegen. Oder man will es vielleicht sogar
deaktivieren. Das alles will ich also konfigurierbar machen. Ich erzähle
mehr, wenn es gemacht ist.</div></blockquote>
<p>Result:
<code class="xref py py-class docutils literal"><span class="pre">BeIdReadCardAction</span></code>
now no longer fails if there is no City named <cite>municipality</cite>,
but silently creates it using
<code class="xref py py-func docutils literal"><span class="pre">lookup_or_create</span></code>.</p>
<p>This is also my first use of a custom Django signal
(a great technique which I should use more often).</p>
<p>Configuration example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">lino.utils.instantiator</span> <span class="kn">import</span> <span class="n">auto_created</span>
<span class="kn">from</span> <span class="nn">django.core.mail</span> <span class="kn">import</span> <span class="n">mail_admins</span>

<span class="k">def</span> <span class="nf">on_auto_created</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">body</span> <span class="o">=</span> <span class="s">&#39;Record </span><span class="si">%s</span><span class="s"> has been automatically created using </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj2str</span><span class="p">(</span><span class="n">sender</span><span class="p">),</span><span class="n">kw</span><span class="p">)</span>
    <span class="n">mail_admins</span><span class="p">(</span><span class="s">&#39;auto_created&#39;</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

<span class="n">auto_created</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">on_auto_created</span><span class="p">)</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0111.html" title="20130111"
             >next</a> |</li>
        <li class="right" >
          <a href="0109.html" title="20130109"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2013</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2013/0110.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2013/0110.html">Online Link</a>
    </div>
  </body>
</html>