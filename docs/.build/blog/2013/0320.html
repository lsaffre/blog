<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20130320 (Wednesday, 20 March 2013) &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2013" href="index.html" />
    <link rel="next" title="20130321 (Thursday, 21 March 2013)" href="0321.html" />
    <link rel="prev" title="20130319 (Tuesday, 19 March 2013)" href="0319.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0321.html" title="20130321 (Thursday, 21 March 2013)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0319.html" title="20130319 (Tuesday, 19 March 2013)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2013</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="wednesday-20-march-2013">
<h1>20130320 (Wednesday, 20 March 2013)<a class="headerlink" href="#wednesday-20-march-2013" title="Permalink to this headline">¶</a></h1>
<div class="section" id="type-object-country-has-no-attribute-default-elem-action-name">
<h2>type object &#8216;Country&#8217; has no attribute &#8216;default_elem_action_name&#8217;<a class="headerlink" href="#type-object-country-has-no-attribute-default-elem-action-name" title="Permalink to this headline">¶</a></h2>
<p>The following traceback happened when trying to show the
Detail window of a <a class="reference external" href="http://www.lino-framework.org/api/lino.modlib.countries.models.html#lino.modlib.countries.models.Country" title="(in Lino v1.6)"><code class="xref py py-class docutils literal"><span class="pre">lino.modlib.countries.models.Country</span></code></a>
while using the Plain UI:</p>
<div class="highlight-python"><div class="highlight"><pre>201303-20 03:20:54 ERROR base : Internal Server Error: /countries/Country/BE
Traceback (most recent call last):
  File &quot;/usr/local/pythonenv/demo/lib/python2.6/site-packages/django/core/handlers/base.py&quot;, line 115, in get_response
    response = callback(request, *callback_args, **callback_kwargs)
  File &quot;/usr/local/pythonenv/demo/lib/python2.6/site-packages/django/views/generic/base.py&quot;, line 68, in view
    return self.dispatch(request, *args, **kwargs)
  File &quot;/usr/local/pythonenv/demo/lib/python2.6/site-packages/django/views/generic/base.py&quot;, line 86, in dispatch
    return handler(request, *args, **kwargs)
  File &quot;/home/luc/hgwork/lino/lino/ui/views.py&quot;, line 1096, in get
    ar = action_request(app_label,actor,request,request.GET,False)
  File &quot;/home/luc/hgwork/lino/lino/ui/views.py&quot;, line 85, in action_request
    action_name = rpt.default_elem_action_name
AttributeError: type object &#39;Country&#39; has no attribute &#39;default_elem_action_name&#39;
</pre></div>
</div>
<p>The reason for this was somewhere else:
<code class="xref py py-func docutils literal"><span class="pre">lino.ui.views.requested_actor()</span></code> tested on dd.Model instead of models.Model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">cl</span><span class="p">,</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cl</span><span class="o">.</span><span class="n">_lino_default_table</span>
</pre></div>
</div>
<p>This incident also raised the question whether we need a <cite>lino.mixins.BabelNamed</cite>.
This would be the same as <code class="xref py py-class docutils literal"><span class="pre">north.dbutils.BabelNamed</span></code> except that we now inherit
from Lino&#8217;s extended <cite>Model</cite> instead of Django&#8217;s plain <cite>Model</cite>.
The advantage would be that subclasses can call super() when they
override one of the methods in <a class="reference external" href="http://www.lino-framework.org/api/lino.core.model.html#lino.core.model.Model" title="(in Lino v1.6)"><code class="xref py py-class docutils literal"><span class="pre">dd.Model</span></code></a>.</p>
<p>I leave this commented out since I cannot see any concrete usage case at the moment
and because it is possible that even <cite>super()</cite> would work
since these attributes and methods are injected into plain Django models at startup.</p>
</div>
<div class="section" id="einfugetexte">
<h2>Einfügetexte<a class="headerlink" href="#einfugetexte" title="Permalink to this headline">¶</a></h2>
<p>So, den Bug bei den Einfügetexten habe ich jetzt gefunden,
das war ein Tippfehler in der <code class="xref py py-class docutils literal"><span class="pre">lino.ui.views.Templates</span></code>
(bzw. eine Nachwehe der Aufteilung von <cite>lino.Site</cite> nach <cite>lino.ui.Site</cite>).</p>
</div>
<div class="section" id="benutzergruppen">
<h2>Benutzergruppen<a class="headerlink" href="#benutzergruppen" title="Permalink to this headline">¶</a></h2>
<p>Aber bevor ich das bei Gerd release, nehme ich mir noch etwas Zeit um über
den anderen Teil der Anfrage nachzudenken:
dass Lino außer &#8220;nur für mich&#8221; und &#8220;für alle Benutzer&#8221; auch einen weiteren
Sichtbarkeitsgrad &#8220;nur für Gruppenmitglieder&#8221; der Einfügetexte ermöglichen sollte.</p>
<p>Die Frage hier ist: was sind Gruppenmitglieder?
Wie und wo definieren wir diese Gruppen?
Ich denke es ist Zeit für eine allgemeine Tabelle der Benutzergruppen,
die dann auch z.B. im <a class="reference external" href="http://www.lino-framework.org/api/lino.modlib.cal.html#module-lino.modlib.cal" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.cal</span></code></a> genutzt werden könnte
(wo sie das unsauber implementierte Konzept der &#8220;Teams&#8221; ersetzen würde).</p>
<p>Soll das eine echte Datebanktabelle sein oder eine ChoiceList?
Natürlich eine Datenbanktabelle, weil ein Lino-Experte das
konfigurieren können soll, ohne den Systemverwalter zu belästigen
oder den Server neustarten zu müssen.</p>
<p>Somit kriegt <a class="reference external" href="http://www.lino-framework.org/api/lino.modlib.users.html#module-lino.modlib.users" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.users</span></code></a> auch ein Modell &#8220;Group&#8221; und
wird somit dem Original von Django wieder etwas ähnlicher.
Insgesamt kein Problem,
aber das erinnert mich an folgendes:</p>
<p>Die Benutzerverwaltung ist ja ein empfindliches Thema, weil Lino
sich hier von Django trennt wegen des m.E. untauglichem Gesamtkonzepts
zur Verwaltung der Zugriffsrechte.
Aber dieses Urteil &#8220;untauglich&#8221; ist erstens ziemlich alt
(Django hat sich inzwischen entwickelt) und zweitens nur mein eigenes:
ich habe bisher von niemandem (der sich auskennt) bestätigt bekommen,
dass Django&#8217;s Gesamtkonzept zur Verwaltung der Zugriffsrechte untauglich sei.
Im Gegenteil, alle außer mir kommen scheinbar wunderbar damit zurecht und
schreiben tolle Erweiterungen, die ich wegen meiner Starrköpfigkeit
dann nicht benutzen kann.
Soll ich also zurück zu Django&#8217;s <cite>django.contrib.auth</cite>?</p>
<p>Okay, diese Frage ist aber komplex und sollte nicht überstürzt werden.
Und eine neue Tabelle <cite>users.Group</cite> ist ja keine Arbeit.
Aber jetzt gehe ich erstmal schlafen.</p>
</div>
<div class="section" id="users-group-and-users-memberships">
<h2>users.Group and users.Memberships<a class="headerlink" href="#users-group-and-users-memberships" title="Permalink to this headline">¶</a></h2>
<p>Here we go:</p>
<ul class="simple">
<li>new models <cite>Group</cite> and <cite>Membership</cite> in <a class="reference external" href="http://www.lino-framework.org/api/lino.modlib.users.html#module-lino.modlib.users" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.users</span></code></a></li>
<li>removed model <cite>Membership</cite> in <a class="reference external" href="http://www.lino-framework.org/api/lino.modlib.cal.html#module-lino.modlib.cal" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.cal</span></code></a></li>
<li>Adapted cal.Event.save(), views.Templates.get(), ...</li>
<li>cal.Calendar.invite_team_members is no longer a
BooleanField but a FK to user.Group</li>
</ul>
</div>
<div class="section" id="about-sitemixin">
<h2>About SiteMixin<a class="headerlink" href="#about-sitemixin" title="Permalink to this headline">¶</a></h2>
<p>A traceback
<cite>AttributeError: &#8216;Site&#8217; object has no attribute &#8216;get_todo_tables&#8217;</cite>
arrived from <a class="reference external" href="http://demo2.lino-framework.org">http://demo2.lino-framework.org</a>
because <a class="reference external" href="http://www.lino-framework.org/api/lino.projects.homeworkschool.html#module-lino.projects.homeworkschool" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.projects.homeworkschool</span></code></a>
forgot to inherit from the <cite>SiteMixin</cite> of <a class="reference external" href="http://www.lino-framework.org/api/lino.modlib.cal.html#module-lino.modlib.cal" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.cal</span></code></a>.
At least for <a class="reference external" href="http://www.lino-framework.org/api/lino.modlib.cal.html#module-lino.modlib.cal" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.cal</span></code></a> I removed the necessity for this Mixin.</p>
</div>
<div class="section" id="lino-welfare-test-suite-on-demo-data">
<h2>Lino-Welfare test suite on demo data<a class="headerlink" href="#lino-welfare-test-suite-on-demo-data" title="Permalink to this headline">¶</a></h2>
<p>The above changes would require more testing, and instead of doing it manually,
I&#8217;d like to add more unit tests.
A first step would be to reactivate
<code class="xref py py-mod docutils literal"><span class="pre">lino_welfare.modlib.pcsw.tests.pcsw_demo_tests</span></code>...</p>
<p>Aber diese Suite ist ja so ekelhaft zu warten!
Jetzt habe ich schon über eine Stunde nach einem doofen Fehler gesucht,
der nur dort auftritt, hat was mit der SiteConfig zu tun, die ja
gecached ist und offenbar doch noch nicht in jedem Fall gelöscht wird,
wenn ein TestCase sein Datenbank gelöscht kriegt.
Aber bon, c&#8217;est la vie...</p>
</div>
<div class="section" id="release">
<h2>Release<a class="headerlink" href="#release" title="Permalink to this headline">¶</a></h2>
<p>(Started, but not yet committed.)</p>
<p>Filled in the new version numbers for the coming release:</p>
<table border="1" class="docutils">
<colgroup>
<col width="62%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Project</th>
<th class="head">Old version</th>
<th class="head">New version</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="http://site.lino-framework.org">djangosite</a> &#8211; A server startup
signal for Django</td>
<td>0.1.0</td>
<td>0.1.1</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://north.lino-framework.org">north</a> &#8211; Another way to
migrate Django databases</td>
<td>0.1.0</td>
<td>0.1.1</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://www.lino-framework.org">lino</a>
&#8211; A framework for writing desktop-like
web applications using Django and ExtJS</td>
<td>1.6.3</td>
<td>1.6.4</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://welfare.lino-framework.org">lino_welfare</a> &#8211; A Lino application
for Belgian Public Welfare Centres</td>
<td>1.1.0</td>
<td>1.1.1</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0321.html" title="20130321 (Thursday, 21 March 2013)"
             >next</a> |</li>
        <li class="right" >
          <a href="0319.html" title="20130319 (Tuesday, 19 March 2013)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2013</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2013/0320.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2013/0320.html">Online Link</a>
    </div>
  </body>
</html>