<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20130409 (Tuesday, 09 April 2013) &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2013" href="index.html" />
    <link rel="next" title="20130410 (Wednesday, 10 April 2013)" href="0410.html" />
    <link rel="prev" title="20130408 (Monday, 08 April 2013)" href="0408.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0410.html" title="20130410 (Wednesday, 10 April 2013)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0408.html" title="20130408 (Monday, 08 April 2013)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2013</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tuesday-09-april-2013">
<h1>20130409 (Tuesday, 09 April 2013)<a class="headerlink" href="#tuesday-09-april-2013" title="Permalink to this headline">¶</a></h1>
<p>I moved from my 4-year-old Acer Aspire 7000 with Windows XP
to a HP ProBook 4540s with Ubuntu for my daily work.
This revealed some minor problems like stray CR-LF newlines
in some files.</p>
<p>These ones took me quite some time although the reason is rather
the new Django version than the new environment:</p>
<ul class="simple">
<li>The exceptions &#8220;Using remote authentication, but no user credentials
found&#8221; and &#8220;Unknown or inactive username %r. Please contact your
system administrator&#8221; raised by
<code class="xref py py-class docutils literal"><span class="pre">lino.utils.auth.RemoteUserMiddleware</span></code>
were <cite>PermissionDenied</cite>. This caused Django 1.5 to not show
the exception&#8217;s message at all, even on a development server
with DEBUG set to True. Now it&#8217;s again a &#8220;normal&#8221; Exception,
causing an email to the admins if it happens.</li>
</ul>
<div class="section" id="django-1-5-and-the-secret-key-setting">
<h2>Django 1.5 and the SECRET_KEY setting<a class="headerlink" href="#django-1-5-and-the-secret-key-setting" title="Permalink to this headline">¶</a></h2>
<p>Many tests failed under Django 1.5 because it refuses an empty
SECRET_KEY setting.</p>
<p>I created <a class="reference external" href="http://code.djangoproject.com/ticket/20227">Django ticket #20227</a>
&#8220;Accept an empty SECRET_KEY when DEBUG is True&#8221;,
but they didn&#8217;t agree.
So I need to either update all test cases and instructions
or set a trivial default value for it.
I choose the latter, at least as long as there is no better solution.</p>
</div>
<div class="section" id="how-to-login-through-ssh-without-typing-your-password-each-time">
<h2>How to login through ssh without typing your password each time<a class="headerlink" href="#how-to-login-through-ssh-without-typing-your-password-each-time" title="Permalink to this headline">¶</a></h2>
<p>On the client (the machine from which I want to login to
a remote server):</p>
<div class="highlight-python"><div class="highlight"><pre>(py27)luc@hoppel:~$ ssh-keygen -t dsa -f .ssh/id_dsa -P &#39;&#39;
Generating public/private dsa key pair.
Your identification has been saved in .ssh/id_dsa.
Your public key has been saved in .ssh/id_dsa.pub.
The key fingerprint is:
4f:a8:35:74:f7:5e:ac:7e:2d:5f:c5:8d:f3:94:57:51 luc@hoppel
The key&#39;s randomart image is:
+--[ DSA 1024]----+
|               .E|
|                .|
|        . . .   .|
|       . o . . ++|
|        S .   +.O|
|       o +   . *o|
|      .   .   o +|
|             .. +|
|              .+.|
+-----------------+

(py27)luc@hoppel:~$ scp .ssh/id_dsa.pub luc@remote-host-org:~/
luc@lino-framework.org&#39;s password: ***
id_dsa.pub                                    100%  600     0.6KB/s   00:00
</pre></div>
</div>
<p>On the remote host:</p>
<div class="highlight-python"><div class="highlight"><pre>(demo)luc@remote:~$ cat id_dsa.pub &gt;&gt; .ssh/authorized_keys
(demo)luc@remote:~$ rm id_dsa.pub
</pre></div>
</div>
<p>(Thanks to <a class="reference external" href="http://www.csua.berkeley.edu/~ranga/notes/ssh_nopass.html">http://www.csua.berkeley.edu/~ranga/notes/ssh_nopass.html</a>
for the cheat sheet)</p>
</div>
<div class="section" id="sphinx-cannot-embed-stylesheet">
<h2>Sphinx cannot embed stylesheet<a class="headerlink" href="#sphinx-cannot-embed-stylesheet" title="Permalink to this headline">¶</a></h2>
<p>When I run <cite>fab docs</cite> for lino on hoppel, then Sphinx 1.2b1 and
docutils 0.10 say &#8220;Cannot embed stylesheet
&#8216;...docutils/writers/html4css1/html4css1.css&#8217;: No such file or
directory.&#8221;, or more exactly:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;partial node&gt;:: (ERROR/3) Cannot embed stylesheet &#39;../../../\
pythonenvs/py27/local/lib/python2.7/site-packages/docutils/writers\
/html4css1/html4css1.css&#39;: No such file or directory.
</pre></div>
</div>
<p>(Workaround: use docutils 0.9)</p>
</div>
<div class="section" id="incompatible-changes-to-logging-config-in-django-1-5">
<h2>Incompatible changes to LOGGING config in Django 1.5<a class="headerlink" href="#incompatible-changes-to-logging-config-in-django-1-5" title="Permalink to this headline">¶</a></h2>
<p>Ouch, Django 1.5 has changed how to  <a class="reference external" href="https://docs.djangoproject.com/en/dev/topics/logging/#configuring-logging">Configure logging</a>:</p>
<blockquote>
<div>Prior to Django 1.5, the LOGGING setting overwrote the default
Django logging configuration. From Django 1.5 forward, the
project’s logging configuration is merged with Django’s
defaults, hence you can decide if you want to add to, or replace
the existing configuration. To completely override the default
configuration, set the disable_existing_loggers key to True in
the LOGGING dictConfig. Alternatively you can redefine some or
all of the loggers.</div></blockquote>
<p>It took me some time to find out that even setting
<cite>disable_existing_loggers</cite> to <cite>True</cite> doesn&#8217;t help: Django
will call my <cite>LOGGING_CONFIG</cite> function twice, once with hard-coded default
values, then another time with the local settings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LOGGING_CONFIG</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">django.utils.log</span> <span class="kn">import</span> <span class="n">DEFAULT_LOGGING</span>
    <span class="c"># First find the logging configuration function ...</span>
    <span class="n">logging_config_path</span><span class="p">,</span> <span class="n">logging_config_func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LOGGING_CONFIG</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">logging_config_module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">logging_config_path</span><span class="p">)</span>
    <span class="n">logging_config_func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">logging_config_module</span><span class="p">,</span> <span class="n">logging_config_func_name</span><span class="p">)</span>

    <span class="n">logging_config_func</span><span class="p">(</span><span class="n">DEFAULT_LOGGING</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LOGGING</span><span class="p">:</span>
        <span class="c"># Backwards-compatibility shim for #16288 fix</span>
        <span class="n">compat_patch_logging_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LOGGING</span><span class="p">)</span>

        <span class="c"># ... then invoke it with the logging settings</span>
        <span class="n">logging_config_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LOGGING</span><span class="p">)</span>
</pre></div>
</div>
<p>This is not a nice change! Sigh!
Opened <a class="reference external" href="http://code.djangoproject.com/ticket/20229">Django ticket #20229</a> to see what they think about it.</p>
</div>
<div class="section" id="where-is-the-mergeaction">
<h2>Where is the MergeAction?<a class="headerlink" href="#where-is-the-mergeaction" title="Permalink to this headline">¶</a></h2>
<p>The <cite>Merge</cite> action (<a class="reference external" href="http://www.lino-framework.org/api/lino.core.merge.html#module-lino.core.merge" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.core.merge</span></code></a>) had disappeared.
Because it was added using the <cite>post_analyze</cite> signal.
But (after a change during the last weeks) that&#8217;s too late, must use pre_analyze.
Actions defined on the model are &#8220;inherited&#8221; by each table on that model.
Since this inheriting is done during the analyze phase, our customization
must happen before.</p>
<p>New method <a class="reference external" href="http://www.lino-framework.org/api/lino.core.model.html#lino.core.model.Model.define_action" title="(in Lino v1.6)"><code class="xref py py-meth docutils literal"><span class="pre">lino.core.model.Model.define_action()</span></code></a>
to make this type of customization more bullet-proof.
TODO: define_action should raise an Exception if it is too
late (because some tables on this model have already been initialized).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0410.html" title="20130410 (Wednesday, 10 April 2013)"
             >next</a> |</li>
        <li class="right" >
          <a href="0408.html" title="20130408 (Monday, 08 April 2013)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2013</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2013/0409.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2013/0409.html">Online Link</a>
    </div>
  </body>
</html>