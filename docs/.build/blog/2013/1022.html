<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20131022 (Tuesday, 22 October 2013) &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2013" href="index.html" />
    <link rel="next" title="20131023 (Wednesday, 23 October 2013)" href="1023.html" />
    <link rel="prev" title="20131021 (Monday, 21 October 2013)" href="1021.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="1023.html" title="20131023 (Wednesday, 23 October 2013)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="1021.html" title="20131021 (Monday, 21 October 2013)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2013</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tuesday-22-october-2013">
<h1>20131022 (Tuesday, 22 October 2013)<a class="headerlink" href="#tuesday-22-october-2013" title="Permalink to this headline">¶</a></h1>
<div class="section" id="miscellaneous-bugfixes">
<h2>Miscellaneous bugfixes<a class="headerlink" href="#miscellaneous-bugfixes" title="Permalink to this headline">¶</a></h2>
<p>Fixed some non-severe bugs which had caused unnecessary internal server
errors:</p>
<div class="highlight-python"><div class="highlight"><pre>- AttributeError at /api/contacts/Partners/null : &#39;NoneType&#39; object has no attribute &#39;name&#39;

- AttributeError at /api/outbox/MyOutbox : &#39;AnonymousUser&#39; object has no attribute &#39;get_typed_instance&#39;
  http://127.0.0.1:8000/api/outbox/MyOutbox?start=0&amp;limit=23&amp;fmt=json

- TypeError: Problem installing fixture &#39;/home/luc/hgwork/faggio/lino_faggio/fixtures/eiche.py&#39;: can&#39;t compare datetime.date to NoneType
</pre></div>
</div>
</div>
<div class="section" id="django-s-languages-setting">
<h2>Django&#8217;s <cite>LANGUAGES</cite> setting<a class="headerlink" href="#django-s-languages-setting" title="Permalink to this headline">¶</a></h2>
<p>Instantiating a <cite>Site</cite> now (again) reduces Django&#8217;s <cite>LANGUAGES</cite>
setting to contain only the languages found in
<code class="xref std std-setting docutils literal"><span class="pre">settings.SITE.languages</span></code>.</p>
<p>Background :
Lino applications don&#8217;t use Django&#8217;s <cite>LANGUAGES</cite> setting because
they have <code class="xref std std-setting docutils literal"><span class="pre">settings.SITE.languages</span></code>.
For some time I thought that consequently we don&#8217;t touch it.
OTOH it is really useless to have it contain all kind of languages,
and Django includes it as part of the email report generated for
each internal server error where it is at least irritating.</p>
</div>
<div class="section" id="thou-shalt-not-use-the-name-of-a-library-module-for-your-own-modules">
<h2>Thou shalt not use the name of a library module for your own modules<a class="headerlink" href="#thou-shalt-not-use-the-name-of-a-library-module-for-your-own-modules" title="Permalink to this headline">¶</a></h2>
<p>I discovered another example for the above commandment:
The doctests in the <code class="xref py py-mod docutils literal"><span class="pre">north.site</span></code> module were not being
tested... because <cite>site</cite> is a Python library module!</p>
<p>This comes because  we use <code class="xref py py-mod docutils literal"><span class="pre">atelier.doctest_utf8</span></code>
(required because we need non-ASCII strings),
which contains code originally copied from Python 2.7 <cite>doctest.py</cite>
which says:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># It is a module -- insert its dir into sys.path and try to</span>
<span class="c"># import it. If it is part of a package, that possibly</span>
<span class="c"># won&#39;t work because of package imports.</span>
</pre></div>
</div>
<p>Workaround:</p>
<ul class="simple">
<li>Renamed <code class="xref py py-mod docutils literal"><span class="pre">north.site</span></code> to  <code class="xref py py-mod docutils literal"><span class="pre">north.north_site</span></code></li>
<li>adapted <code class="file docutils literal"><span class="pre">north/tests/__init.py</span></code></li>
<li>Renamed <code class="xref py py-mod docutils literal"><span class="pre">lino.site</span></code> to  <code class="xref py py-mod docutils literal"><span class="pre">lino.lino_site</span></code></li>
</ul>
</div>
<div class="section" id="checkin">
<h2>Checkin<a class="headerlink" href="#checkin" title="Permalink to this headline">¶</a></h2>
<p>Most tests are now passing (<a class="reference external" href="http://welfare.lino-framework.org/index.html#welfare" title="(in Lino Welfare Reference Manual v1.1)"><span>Lino Welfare</span></a> has some trivial failures
which I leave open until the new conflicting events handling is stable).
Checkin and updated the <a class="reference external" href="http://www.lino-framework.org/demos.html#demos" title="(in Lino v1.6)"><span>Demo sites</span></a>.</p>
</div>
<div class="section" id="shortcut-for-inserting-in-combobox">
<h2>Shortcut for inserting in combobox<a class="headerlink" href="#shortcut-for-inserting-in-combobox" title="Permalink to this headline">¶</a></h2>
<p>The &#8220;Lookup&#8221; button of a combobox
whose value is empty
used to display a message
&#8216;Cannot show detail for empty foreign key.&#8217;
Now it calls the insert handler.</p>
<p>In <cite>linoweb.js</cite> I already increased the <cite>minListWidth</cite> of <cite>Lino.ComboBox</cite>
and implemented a <cite>initList</cite> of <cite>Lino.RemoteComboFieldElement</cite> which shows
that we can add a button to the Pagination toolbar of the list.</p>
<p>Another way might be to add buttons directly in the cell renderer.</p>
<p>Also (optionally) remove clickability of cell
renderers (&#8220;Lino.fk_renderer&#8221;), and in that case a TwinCombo
would make sense also for a grid editor cell (<code class="xref py py-class docutils literal"><span class="pre">lino.ui.elems.ForeignKeyElement</span></code>).
But it doesn&#8217;t yet work from a grid because combo.getValue()
doesn&#8217;t return the primary key...</p>
</div>
<div class="section" id="width-of-date-fields">
<h2>Width of date fields<a class="headerlink" href="#width-of-date-fields" title="Permalink to this headline">¶</a></h2>
<p>Aha! It seems that I fixed a nasty layout bug:
Date fields were often displayed so that their trigger button
(the button used to show the date picker) was hidden by the
next field.</p>
<p>I removed the <cite>boxMinWidth: Lino.chars2width(11)</cite> which obviously
doesn&#8217;t work as expected and anyway (officially) exists only since
ExtJS 3.4.0 and changed the <cite>preferred_width</cite> of
<code class="xref py py-class docutils literal"><span class="pre">DateFieldElement</span></code>
from 8 to 13.</p>
</div>
<div class="section" id="assigncoach-sometimes-fails">
<h2>AssignCoach sometimes fails<a class="headerlink" href="#assigncoach-sometimes-fails" title="Permalink to this headline">¶</a></h2>
<p>In <a class="reference external" href="http://welfare.lino-framework.org/index.html#welfare" title="(in Lino Welfare Reference Manual v1.1)"><span>Lino Welfare</span></a>
<cite>newcomers.AssignCoach</cite> sometimes fails
with a message <cite>&#8216;NoneType&#8217; object has no attribute &#8216;attname&#8217;</cite>.
Tried to reproduce it. Without success.
Added a call to <code class="docutils literal"><span class="pre">coaching.full_clean()</span></code> before saving it.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="1023.html" title="20131023 (Wednesday, 23 October 2013)"
             >next</a> |</li>
        <li class="right" >
          <a href="1021.html" title="20131021 (Monday, 21 October 2013)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2013</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2013/1022.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2013/1022.html">Online Link</a>
    </div>
  </body>
</html>