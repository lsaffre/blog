<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20130228 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2013" href="index.html" />
    <link rel="next" title="20130301" href="0301.html" />
    <link rel="prev" title="20130227" href="0227.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0301.html" title="20130301"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0227.html" title="20130227"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2013</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20130228<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="lino-und-der-neue-prasident-fortsetzung">
<h2>Lino und der neue Präsident (Fortsetzung)<a class="headerlink" href="#lino-und-der-neue-prasident-fortsetzung" title="Permalink to this headline">¶</a></h2>
<p>Noch kleine technische Überraschungen:
Die Standardwerte der Felder <cite>signer1</cite> und <cite>signer2</cite>
sollten in der SiteConfig gespeichert sein.
Diese Felder haben
die gleichen Auswahllisten-Methoden (chooser) wie die,
die für die Verträge gelten.
Also wollen wir das nicht doppelt schreiben,
sondern wiederverwertbar machen.
Die kleinen Unterschiede (<cite>blank</cite>, <cite>null</cite>, <cite>default</cite>)
sind ja dank <cite>dd.update_field</cite> kein Problem.
Klarer Fall für ein Mixin:
<code class="xref py py-class docutils literal"><span class="pre">lino_welfare.modlib.isip.models.Signers</span></code>.</p>
<p>Jetzt muss die <cite>ui.SiteConfig</cite> aber
in <code class="xref py py-attr docutils literal"><span class="pre">lino.Lino.override_modlib_models</span></code> stehen
und wir machen unsere eigene
<code class="xref py py-class docutils literal"><span class="pre">lino_welfare.modlib.pcsw.models.SiteConfig</span></code>
mit diesem Mixin:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SiteConfig</span><span class="p">(</span><span class="n">ui</span><span class="o">.</span><span class="n">SiteConfig</span><span class="p">,</span><span class="n">isip</span><span class="o">.</span><span class="n">Signers</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>Hier musste ich einige Aufrufe von
<a class="reference external" href="http://www.lino-framework.org/api/lino.core.inject.html#lino.core.inject.inject_field" title="(in Lino v1.6)"><code class="xref py py-func docutils literal"><span class="pre">dd.inject_field</span></code></a>,
die bisher direkt die Klasse SiteConfig angaben,
ändern nach &#8220;ui.SiteConfig&#8221;.
Hat was mit Djangos model cache loading order zu tun:
<a class="reference external" href="http://www.lino-framework.org/api/lino.core.inject.html#lino.core.inject.inject_field" title="(in Lino v1.6)"><code class="xref py py-func docutils literal"><span class="pre">dd.inject_field</span></code></a>
funktioniert natürlich nicht, wenn die Unterklasse
des abstrakten Modells schon geladen ist.
Für gut sollte Lino dann eine Fehlermeldung machen,
aber ich habe noch nicht erkannt, wie ich das kontrollieren kann.
En attendat Fausregel: immer einfach die
Modellnamen als string angeben statt das Klassenobjekt.</p>
</div>
<div class="section" id="miscellaneous">
<h2>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><code class="xref py py-mod docutils literal"><span class="pre">lino_welfare.modlib.cbss.tx25</span></code> : Added handler for RetirementCertificates.</li>
<li>Fixed a UnicodeEncodeError caused by
wrongly calling <code class="xref py py-meth docutils literal"><span class="pre">lino.ui.Lino.site_header()</span></code>
in certain appy.pod document templates.</li>
</ul>
<p>TODO:</p>
<ul class="simple">
<li><cite>contacts.QuickTest</cite> fails when called for a Lino-Welfare site.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0301.html" title="20130301"
             >next</a> |</li>
        <li class="right" >
          <a href="0227.html" title="20130227"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2013</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2013/0228.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2013/0228.html">Online Link</a>
    </div>
  </body>
</html>