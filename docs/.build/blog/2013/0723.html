<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20130723 (Tuesday, 23 July 2013) &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2013" href="index.html" />
    <link rel="next" title="20130724 (Wednesday, 24 July 2013)" href="0724.html" />
    <link rel="prev" title="20130722 (Monday, 22 July 2013)" href="0722.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0724.html" title="20130724 (Wednesday, 24 July 2013)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0722.html" title="20130722 (Monday, 22 July 2013)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2013</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tuesday-23-july-2013">
<h1>20130723 (Tuesday, 23 July 2013)<a class="headerlink" href="#tuesday-23-july-2013" title="Permalink to this headline">¶</a></h1>
<div class="section" id="a-pywhich-command">
<h2>A <cite>pywhich</cite> command<a class="headerlink" href="#a-pywhich-command" title="Permalink to this headline">¶</a></h2>
<p>Here is a <cite>pywhich</cite> command defined in my <cite>.bash_aliases</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre>function pywhich() {
  python -c &quot;import $1; print $1.__file__&quot;
}
</pre></div>
</div>
</div>
<div class="section" id="model-model-s-with-pk-pk-r-does-not-exist">
<h2>&#8220;Model %(model)s with pk %(pk)r does not exist.&#8221;<a class="headerlink" href="#model-model-s-with-pk-pk-r-does-not-exist" title="Permalink to this headline">¶</a></h2>
<p>I submitted <a class="reference external" href="http://code.djangoproject.com/ticket/20791">Django ticket #20791</a>. Yes this is nit-picky
but I happen to see that message rather often when loading a backup
in which <code class="xref py py-mod docutils literal"><span class="pre">north.dpy</span></code> has to defer instances.</p>
</div>
<div class="section" id="released-lino-welfare-1-1-8">
<h2>Released Lino-Welfare 1.1.8<a class="headerlink" href="#released-lino-welfare-1-1-8" title="Permalink to this headline">¶</a></h2>
<p>I released <a class="reference external" href="http://welfare.lino-framework.org/changes.html#welfare-changes" title="(in Lino Welfare Reference Manual v1.1)"><span class="xref std std-ref">Lino-Welfare 1.1.8</span></a>.</p>
<p>Determine project interdependencies:
The last release (1.1.7) was 2013-06-04.
By consulting the diffs of the changelogs, I saw that
atelier, djangosite and north had no
runtime-relevant changes since that date.
Lino the framework does have.</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="39%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">project</th>
<th class="head">released version</th>
<th class="head">needs update?</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>atelier</td>
<td>0.0.2</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>djangosite</td>
<td>0.1.5</td>
<td>no</td>
</tr>
<tr class="row-even"><td>north</td>
<td>0.1.5</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>lino</td>
<td>1.6.10</td>
<td>1.6.11</td>
</tr>
<tr class="row-even"><td>lino_welfare</td>
<td>1.1.7</td>
<td>1.1.8</td>
</tr>
</tbody>
</table>
<p>I increased the version numbers already some time ago.</p>
<p>On prodsite, stop services and make a backup:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd /usr/local/django/prod
$ ./stop
$ ./backup
$ ls -l /var/log/lino/backups/b20130723*.py
-rw-r--r-- 1 www-data www-data 23781742 Jul 23 02:02 /var/log/lino/backups/b20130723_020101.py
</pre></div>
</div>
<p>Import that backup to testlino after pulling the latest development
versions:</p>
<div class="highlight-python"><div class="highlight"><pre>$ pull
$ cd /usr/local/django/test
$ . env/bin/activate
$ python manage.py initdb --traceback b20130723_020101
</pre></div>
</div>
<p>On my machine, create <strong>sdist</strong> for lino and welfare and publish them to
<a class="reference external" href="http://www.lino-framework.org/dl">http://www.lino-framework.org/dl</a>:</p>
<div class="highlight-python"><div class="highlight"><pre>$ go welfare
$ fab sdist
$ go lino
$ fab sdist
$ fab docs pub
</pre></div>
</div>
<p>On prodsite, upgrade prod using <cite>pip &#8211;extra-index-url</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd /usr/local/django/prod
$ . env/bin/activate
$ pip install -U --extra-index-url=http://www.lino-framework.org/dl lino-welfare
$ python manage.py initdb --traceback b20130723_020101
</pre></div>
</div>
<p>Noted that this also upgraded <strong>appy</strong> from 0.8.3 to 0.8.4
and <strong>docutils</strong> from 0.10 to 0.11.
Just in case of surprises...</p>
<p>Oops:</p>
<div class="highlight-python"><div class="highlight"><pre>Traceback (most recent call last):
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/django/core/management/base.py&quot;, line 222, in run_from_argv
    self.execute(*args, **options.__dict__)
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/django/core/management/base.py&quot;, line 254, in execute
    self.validate()
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/django/core/management/base.py&quot;, line 280, in validate
    num_errors = get_validation_errors(s, app)
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/django/core/management/validation.py&quot;, line 35, in get_validation_errors
    for (app_name, error) in get_app_errors().items():
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/django/db/models/loading.py&quot;, line 166, in get_app_errors
    self._populate()
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/django/db/models/loading.py&quot;, line 75, in _populate
    self.load_app(app_name)
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/django/db/models/loading.py&quot;, line 96, in load_app
    models = import_module(&#39;.models&#39;, app_name)
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/django/utils/importlib.py&quot;, line 35, in import_module
    __import__(name)
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/lino/modlib/about/models.py&quot;, line 33, in &lt;module&gt;
    from lino import mixins
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/lino/mixins/__init__.py&quot;, line 37, in &lt;module&gt;
    from lino.utils import auth
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/lino/utils/auth.py&quot;, line 51, in &lt;module&gt;
    from lino.core.choicelists import ChoiceList, Choice
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/lino/core/choicelists.py&quot;, line 108, in &lt;module&gt;
    from lino.core import tables
  File &quot;/home/lsaffre/pythonenvs/stable/lib/python2.6/site-packages/lino/core/tables.py&quot;, line 1160, in &lt;module&gt;
    from djangosite.signals import database_ready
ImportError: cannot import name database_ready
</pre></div>
</div>
<p>This means that also djangosite needs a release.</p>
<p>On my machine, create <strong>sdist</strong> for site and publish it to
<a class="reference external" href="http://www.lino-framework.org/dl">http://www.lino-framework.org/dl</a>:</p>
<div class="highlight-python"><div class="highlight"><pre>$ go site
$ fab sdist
$ go lino
$ fab docs pub
</pre></div>
</div>
<p>On prodsite, upgrade prod once more using <cite>pip &#8211;extra-index-url</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd /usr/local/django/prod
$ pip install -U --extra-index-url=http://www.lino-framework.org/dl lino-welfare
$ python manage.py initdb --traceback b20130723_020101
</pre></div>
</div>
<p>After some more changes (which show that it is important to test using
sdist before officially releasing on PyPI) I finally did it:
I officially relased</p>
<ul class="simple">
<li>djangosite   0.1.6</li>
<li>lino         1.6.11</li>
<li>lino_welfare 1.1.8</li>
</ul>
<div class="section" id="new-module-lino-modlib-attestations">
<h3>New module <cite>lino.modlib.attestations</cite><a class="headerlink" href="#new-module-lino-modlib-attestations" title="Permalink to this headline">¶</a></h3>
<p><span class="xref std std-ref">welfare.receptions</span> is not yet fully functional,
but my brain is already preparing the next steps:
There will be a new module <cite>lino.modlib.attestations</cite>.
An &#8220;attestation&#8221; is an &#8220;official&#8221; document
which attests (confirms) something.
Part of the current <cite>lino_welfare.modlib.notes</cite> will move there.
Notes are just &#8220;internal notes&#8221;, but a CV is rather such an attestation.</p>
</div>
<div class="section" id="acting-as-another-user">
<h3>Acting as another user<a class="headerlink" href="#acting-as-another-user" title="Permalink to this headline">¶</a></h3>
<p>Discovered and fixed a first bug in the freshly released Lino 1.6.11:
Acting as somebody else didn&#8217;t work when calling it while in
the main viewport.</p>
</div>
<div class="section" id="ubersicht-art-607-konventionen">
<h3>Übersicht Art-60§7-Konventionen<a class="headerlink" href="#ubersicht-art-607-konventionen" title="Permalink to this headline">¶</a></h3>
<p>Two more bugs fixed:</p>
<ul class="simple">
<li>Übersicht Art-60§7-Konventionen : wenn man im Parameter-Panel
eine Stellenart auswählte, kam Fehlermeldung
&#8220;&#8216;JobType&#8217; object is not iterable&#8221;</li>
<li>Übersicht Art-60§7-Konventionen : Vorschau ist leer.
Da kam stattdessen eine Fehlermeldung in der JS-Console, weil das
Fenster keinen Navigator hatte und dennoch versuchte, die
Navigationsbuttons zu deaktivieren.</li>
</ul>
</div>
<div class="section" id="menustruktur">
<h3>Menüstruktur<a class="headerlink" href="#menustruktur" title="Permalink to this headline">¶</a></h3>
<p>Eher unnütze Gedanken über ein scheinbar banales Thema,
das ich aber für relativ wichtig halte.</p>
<p>Das Modul &#8220;Empfang&#8221; bringt -soweit ich sehen kann- nur zwei
oder höchstens drei neue Befehle hinzu:</p>
<ul class="simple">
<li>&#8220;Klienten&#8221; Der Empfang muss sicherlich eine eigene Ansicht aller
Klienten kriegen, mit nur ein paar Kolonnen und einem eigenen
Detail-Layout.</li>
<li>&#8220;Wartesaal&#8221; oder &#8220;Wartende Besucher&#8221;, also eine Liste der anwesenden
(eingecheckten) Leute.</li>
<li>Der dritte &#8220;Erwartete Besucher&#8221; ist eine theoretisch mögliche Liste
aller Leute, die einen Termin haben (und noch nicht eingecheckt
sind). Habe aber Zweifel, dass ihr den brauchen werdet.</li>
</ul>
<p>Alle drei Befehle sollen potentiell auch für andere Benutzerprofile
aktivierbar sein. Z.B. könnten in kleineren ÖSHZ manche Benutzer
Funktionenhäufung haben.</p>
<p>Die Frage ist: soll ich ein eigenes Menü &#8220;Empfang&#8221; machen oder nicht?</p>
<p>Wenn ich ein eigenes Menü mache, dann wird das Hauptmenü für
Systemverwalter langsam unübersichtlich.</p>
<p>Außerdem widerspricht das der &#8220;allgemeinen Menü-Philosophie&#8221;, die mir vorschwebt.</p>
<p>Welche &#8220;allgemeine Menü-Philosophie&#8221;?</p>
<p>Lino unterscheidet die &#8220;technischen Module&#8221; und die &#8220;Benutzer-Module&#8221;.
Es gibt viel mehr technische Module als Benutzer-Module.</p>
<p>&#8220;Empfang&#8221; ist ein technisches Modul: pro ÖSHZ und pro Benutzerprofil
soll man auswählen können, ob es diese Funktionalität geben soll
oder nicht.</p>
<p>In der &#8220;allgemeinen Menü-Philosophie&#8221;, die mir vorschwebt,
kategorisiere ich bewusst nicht nach &#8220;Modulen&#8221;,
sondern nach... naja, wonach eigentlich?</p>
<p>Vielleicht müssten die Menü-Titel &#8220;DSBE&#8221;, &#8220;Neuanträge&#8221;
und &#8220;Schuldnerberatung&#8221; raus, und stattdessen:</p>
<ul class="simple">
<li>Kontakte : alle Partner, inkl. Stellenabieter, Kursanbieter usw.</li>
<li>Kalender : wie bisher</li>
<li>Verträge : VSEs, Art60§7, Stellen, Stellenangebote</li>
<li>Kurse : Kurse, Anfragen</li>
<li>Berichte :
- DSBE : Übersicht Art60§7, Tätigkeitsbericht</li>
<li>Konfigurierung : (wie bisher)</li>
<li>Explorer : (wie bisher)</li>
</ul>
<p>Murmel, grübel... nein, das wäre falsch.
Befehle wie &#8220;Stellenabieter&#8221; oder &#8220;Kursanbieter&#8221;
kann man nicht einfach mit den allgemeinen Kontakten
in den gleichen Topf werfen.
Und &#8220;Empfang&#8221; ist nicht nur ein technisches Modul,
sondern auch eine &#8220;Abteilung&#8221;, ein &#8220;Dienst&#8221;,
ein &#8220;funktionaler Bereich&#8221;, der für Endbenutzer Sinn macht.</p>
<p>Fazit: Ja, wie brauchen ein neues Menü &#8220;Empfang&#8221;.</p>
<p>Fazit2: Aber was ist mit dem Menü &#8220;Neuzugänge&#8221;?
Das hat ja nur einen einzigen Befehl &#8220;Neue Klienten&#8221;!</p>
</div>
<div class="section" id="klientenansicht-empfang">
<h3>Klientenansicht &#8220;Empfang&#8221;<a class="headerlink" href="#klientenansicht-empfang" title="Permalink to this headline">¶</a></h3>
<p>New <span class="menuselection">Reception ‣ Clients</span>
shows a <span class="xref std std-ref">welfare.reception.Clients</span> table
with simplified columns and detail which
does <em>not</em> inherit from the &#8220;usual&#8221;
<span class="xref std std-ref">welfare.pcsw.Clients</span> table.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0724.html" title="20130724 (Wednesday, 24 July 2013)"
             >next</a> |</li>
        <li class="right" >
          <a href="0722.html" title="20130722 (Monday, 22 July 2013)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2013</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2013/0723.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2013/0723.html">Online Link</a>
    </div>
  </body>
</html>