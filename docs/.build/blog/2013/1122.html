<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20131122 (Friday, 22 November 2013) &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2013" href="index.html" />
    <link rel="next" title="20131123 (Saturday, 23 November 2013)" href="1123.html" />
    <link rel="prev" title="20131121 (Thursday, 21 November 2013)" href="1121.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="1123.html" title="20131123 (Saturday, 23 November 2013)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="1121.html" title="20131121 (Thursday, 21 November 2013)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2013</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="friday-22-november-2013">
<h1>20131122 (Friday, 22 November 2013)<a class="headerlink" href="#friday-22-november-2013" title="Permalink to this headline">¶</a></h1>
<div class="section" id="continued-on-eidreader">
<h2>Continued on <a class="reference external" href="http://www.lino-framework.org/eidreader/index.html#eidreader" title="(in Lino v1.6)"><span>The EIDReader applet</span></a><a class="headerlink" href="#continued-on-eidreader" title="Permalink to this headline">¶</a></h2>
<p>Status summary:</p>
<ul class="simple">
<li>The applet works perfectly on a client with IcedTea (OpenJDK) RTE.</li>
<li>The problem occurs only when using Sun Java client.</li>
</ul>
<p>I noticed that an error (another one) occurs even with an Estonian
eid card (which does not call any third-party code).
Then I noticed that the same message comes when there
is no permission at all.
Which means that it is simply the client configuration!</p>
<p>Here is the console message:</p>
<div class="highlight-python"><div class="highlight"><pre>Java Plug-in 10.45.2.18
Using JRE version 1.7.0_45-b18 Java HotSpot(TM) Client VM
User home directory = C:\Documents and Settings\Luc Saffre
...
javax.smartcardio.CardException: connect() failed
      at sun.security.smartcardio.TerminalImpl.connect(Unknown Source)
      at src.eidreader.EIDReader$2.run(EIDReader.java:453)
      at java.security.AccessController.doPrivileged(Native Method)
      at src.eidreader.EIDReader.readCard(EIDReader.java:438)
      at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
      at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
      at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
      at java.lang.reflect.Method.invoke(Unknown Source)
      at sun.plugin.javascript.Trampoline.invoke(Unknown Source)
      at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
      at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
      at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
      at java.lang.reflect.Method.invoke(Unknown Source)
      at sun.plugin.javascript.JSClassLoader.invoke(Unknown Source)
      at sun.plugin2.liveconnect.JavaClass$MethodInfo.invoke(Unknown Source)
      at sun.plugin2.liveconnect.JavaClass$MemberBundle.invoke(Unknown Source)
      at sun.plugin2.liveconnect.JavaClass.invoke0(Unknown Source)
      at sun.plugin2.liveconnect.JavaClass.invoke(Unknown Source)
      at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo$DefaultInvocationDelegate.invoke(Unknown Source)
      at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo$3.run(Unknown Source)
      at java.security.AccessController.doPrivileged(Native Method)
      at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo.doObjectOp(Unknown Source)
      at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo$LiveConnectWorker.run(Unknown Source)
      at java.lang.Thread.run(Unknown Source)
Caused by: sun.security.smartcardio.PCSCException: SCARD_E_PROTO_MISMATCH
      at sun.security.smartcardio.PCSC.SCardConnect(Native Method)
      at sun.security.smartcardio.CardImpl.&lt;init&gt;(Unknown Source)
      ... 24 more
</pre></div>
</div>
<p>Other observations:</p>
<ul>
<li><p class="first">The answer should be in
<a class="reference external" href="http://docs.oracle.com/javase/7/docs/technotes/guides/security/PolicyFiles.html">Default Policy Implementation and Policy File Syntax</a></p>
<p>Note that</p>
<ul class="simple">
<li><cite>java.home</cite> is <code class="file docutils literal"><span class="pre">c:Program</span> <span class="pre">FilesJavajre7libsecurity</span></code></li>
<li><cite>user.home</cite> is <code class="file docutils literal"><span class="pre">c:Documents</span> <span class="pre">and</span> <span class="pre">SettingsLuc</span> <span class="pre">Saffre</span></code></li>
</ul>
<p>and that the filename is</p>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">java.policy</span></code> for the system policy but</li>
<li><code class="file docutils literal"><span class="pre">.java.policy</span></code> (starts with a dot) for the user policy.</li>
</ul>
</li>
<li><p class="first">Here is somebody with a similar problem:
<a class="reference external" href="http://stackoverflow.com/questions/8882226/self-signed-applet-doesnt-get-a-full-permission">Self-signed applet doesn&#8217;t get a full permission</a></p>
</li>
<li><p class="first">It seems that
<cite>javax.smartcardio.CardPermission</cite>
is a subclass of
<cite>java.security.Permission</cite>
(according to <a class="reference external" href="http://download.java.net/jdk8/docs/jre/api/security/smartcardio/spec/javax/smartcardio/CardPermission.html">this</a>)
and that <cite>java.security.AllPermission</cite> should be enough.</p>
</li>
<li><p class="first">Here are some of the variants of <code class="docutils literal"><span class="pre">grant</span></code> entries I&#8217;ve tried:</p>
<div class="highlight-python"><div class="highlight"><pre>// grant codeBase &quot;file:///t:/applets/-&quot; {
// grant codeBase &quot;file:///t:/applets/eid_test.html&quot; {
// grant codeBase &quot;file:/t:/applets/eid_test.html&quot; {
grant codeBase &quot;file:/t:/applets/eid_test.html&quot; {

        permission java.security.AllPermission;
        // permission javax.smartcardio.CardPermission &quot;OMNIKEY CardMan 1021 0&quot;, &quot;connect&quot;;
        permission javax.smartcardio.CardPermission &quot;*&quot;, &quot;connect&quot;;
};
// grant { permission java.security.AllPermission; };
</pre></div>
</div>
</li>
<li><p class="first">To test whether a policy file is being read at all
I add a word &#8220;foo&#8221; somewhere in that file
to cause a parsing error in the Java console:</p>
<div class="highlight-python"><div class="highlight"><pre>java.security.policy: error parsing file:/C:/Program%20Files/Java/jre7/lib/security/java.policy:
    line 1: expected [;], found [foo]
</pre></div>
</div>
<p>Funnily this does <em>not</em> work when the &#8220;foo &#8221; is in the <em>user</em> policy file.
So there is no proof that this file is being used.</p>
</li>
</ul>
</div>
<div class="section" id="logos-goes-online">
<h2><a class="reference external" href="http://logos.lino-framework.org/index.html#logos" title="(in Lino-Logos Reference Manual v0.0)"><span>Lino Logos</span></a> goes online<a class="headerlink" href="#logos-goes-online" title="Permalink to this headline">¶</a></h2>
<p>I had a phone call with Kai, which I later summarized as follows:</p>
<blockquote>
<div>The SacredPy project is interested in Lino, but it all depends on
whether Jason feels able and willing to continue developing on the
Lino prototype. Before this can happen he would need to invest a
considerable amount of time and energy. Which he won&#8217;t do as long
as he doesn&#8217;t <em>believe</em> that this is -in the long run- the easiest
and best way. Even <em>I</em> in fact just <em>believe</em> it, but wouldn&#8217;t
give my hand for it. As long as Jason doesn&#8217;t clearly tell me
&#8220;Luc, stop to waste your time&#8221; I can try to convince him by
working on a prototype. I&#8217;ll probably do this in sporadic
fallouts. I&#8217;ll also (passively) listen to what they discuss.</div></blockquote>
<p>Later in the evening I had a spontaneous seizure and published the
code of <a class="reference external" href="http://logos.lino-framework.org/index.html#logos" title="(in Lino-Logos Reference Manual v0.0)"><span>Lino Logos</span></a>, my first prototype for the SacredPy project on
which I had worked some weeks ago.  The only remaining serious problem
was to remove certain copyrighted bible texts from the demo fixtures.</p>
<p>So this first prototype is now available for Jason to grab it.</p>
<ul class="simple">
<li>Code <a class="reference external" href="https://github.com/lsaffre/lino-logos">https://github.com/lsaffre/lino-logos</a></li>
<li>Public demo:  <a class="reference external" href="http://logos-demo.lino-framework.org/">http://logos-demo.lino-framework.org/</a></li>
<li>Documentation: <a class="reference external" href="http://logos.lino-framework.org/">http://logos.lino-framework.org/</a></li>
</ul>
<p>I estimate that even I (who knows Lino) would need a few weeks to get
it into a usable state. But it makes no sense that I do it alone since
I don&#8217;t recommend to make that project depend only on me.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="1123.html" title="20131123 (Saturday, 23 November 2013)"
             >next</a> |</li>
        <li class="right" >
          <a href="1121.html" title="20131121 (Thursday, 21 November 2013)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2013</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2013/1122.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2013/1122.html">Online Link</a>
    </div>
  </body>
</html>