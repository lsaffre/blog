<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20100728 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2010" href="index.html" />
    <link rel="next" title="20100729" href="0729.html" />
    <link rel="prev" title="20100727" href="0727.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0729.html" title="20100729"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0727.html" title="20100727"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2010</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20100728<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Nach drei Tagen Pause geht es heute nochmal mit Lino weiter.
Am 23. August treffe ich mich in Eupen mit den zukünftigen Benutzern,
die dann schon immerhin 9 Monate auf ihre Software warten.
Kann sein, dass dann die erste Lino-Anwendung geboren wird.
(Unter &#8220;Geburt&#8221; versteht sich im Fall von Lino, dass er erstmals benutzt wird.)
Bis dahin müssten die folgenden Punkte nach gemacht werden:</p>
<ul class="simple">
<li>Speicherbare Listen-Konfigurationen und Kolonnenfilter</li>
<li>Performance beim Bildschirmaufbau</li>
<li>South in Betrieb nehmen</li>
</ul>
<p>Zu Punkt 1 sehe ich folgende Unterpunkte:</p>
<ul class="simple">
<li>Im <a class="reference external" href="http://127.0.0.1:8000/api/system/ReportConfigs/1?fmt=detail">Detail einer Reportconfig</a> ist die ComboBox von rptname leer.</li>
<li>Um Kolonnen manuell erstellen zu können, müsste er den Kontext für colname setzen.
Tut er aber nicht (weil rptname der fk_name des Reports ist).</li>
<li>Wenn die Sache in der Datenbank steht, muss ichs natürlich noch ins UI einbauen.</li>
</ul>
<p>Also im <a class="reference external" href="http://127.0.0.1:8000/api/system/ReportConfigs/1?fmt=detail">Detail einer Reportconfig</a> ist die ComboBox von rptname leer.
Die Antwort des Servers enthält <cite>data_record.data</cite> wie folgt:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="n">label</span><span class="p">:</span> <span class="s">&quot;test&quot;</span><span class="p">,</span>
    <span class="n">rptname</span><span class="p">:</span> <span class="s">&quot;countries.Countries&quot;</span><span class="p">,</span>
    <span class="nb">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s">&quot;test&quot;</span>
<span class="p">},</span>
</pre></div>
</div>
<p>Wieso gibt es da kein Feld <cite>rptnameHidden</cite>? Richtig, weil das ein Chooser mit <cite>simple_values</cite> ist. Und die ComboBox scheint das nicht zu vertragen. Das hieße, dass das gleiche Problem auch im Detail von NoteType sein müsste für die Combobox von NoteType.template. Aha, dieses Detail gibt es gar nicht. Ist ja eigentlich auch nicht nötig. Aber allein schon um das zu prüfen, mache ich also eine <cite>lino.modlib.notes.models.NoteTypeDetail</cite>. In der Tat, auch dort ist die Combobox leer.</p>
<p>Genau: ext_elems.MainPanel.field2elem() macht immer ein Lino.RemoteComboFieldElement, wenn das Feld einen chooser hat. Das ist zu naiv. Wenn es einen chooser hat, dann muss er noch dessen Attribut <cite>simple_values</cite> schauen, und dann entweder ein ComplexRemoteComboFieldElement oder ein SimpleRemoteComboFieldElement generieren. Und die choices_view in ext_ui.py kann dieses  <cite>simple_values</cite> ebenfalls ausnutzen, um eine effizientere <cite>row2dict()</cite> zu machen wenn ein chooser existiert.</p>
<p>Voilà, die ComboBox von rptname ist nicht mehr leer.</p>
<p>Check-In und Mittagspause.</p>
<p>Abends: Wenn ich in <cite>system.ReportConfigs</cite> in der Liste &#8220;Detail&#8221;
klickte, dann hat die ColumnsByReport-Grid eine leere Extrazeile. Wenn
ich dagegen den <a class="reference external" href="http://127.0.0.1:8000/api/system/ReportConfigs/1?fmt=detail">Permalink</a>
benutzte , stand dort &#8220;Nix gefunden&#8221;. Das lag daran, dass
load_slavegrid() testet, ob die Grid sichtbar ist
(<cite>isVisible()</cite>). Wenn sie es nicht ist, dann setzt sie jetzt einen
event listener für &#8220;show&#8221; bzw. &#8220;render&#8221;. Damit ist wahrscheinlich auch
das folgende Problem gelöst, das noch in der Todo-Liste stand:</p>
<blockquote>
<div><ul class="simple">
<li>Beim Navigieren im Detail von <code class="xref py py-class docutils literal"><span class="pre">lino.modlib.contacts.Persons</span></code> macht er zwar jetzt nicht mehr die
unnützen load_slavegrid() wenn der Reiter mit diesen Komponenten nicht angezeigt ist,
aber wenn man dann den betreffenden Reiter aktiviert, vergißt er, diese Formalität nachzuholen.
(Workaround: man muss z.B. next und dann previous klicken, um sie zu aktualisieren.)</li>
</ul>
</div></blockquote>
<p>Check-In wegen Feierabend.</p>
<p>TODO:</p>
<ul>
<li><p class="first">Wenn ich im <a class="reference external" href="http://127.0.0.1:8000/api/system/ReportConfigs/1?fmt=detail">Detail einer ReportConfig</a> in
colname die ComboBox triggere, schickt er folgenden AJAX-Call los:</p>
<div class="highlight-python"><div class="highlight"><pre>http://127.0.0.1:8000/choices/system/ColumnsByReport/colname?_dc=1280352482122&amp;query=
</pre></div>
</div>
<p>Also colname hat ihren Context nicht gesetzt bekommen...</p>
</li>
<li><p class="first">Noch lustiger: wenn ich zuvor in <cite>contacts.Companies</cite> die
Kolonnen Country und City bearbeitet habe und dann wieder das
Gleiche mache, dann schickt er folgenden Call los:</p>
<div class="highlight-python"><div class="highlight"><pre>http://127.0.0.1:8000/choices/system/ColumnsByReport/colname?_dc=1280352622636&amp;country=FR&amp;query=
</pre></div>
</div>
<p>Also die Context-Parameter werden irgendwo gespeichert wo sie nicht hingehören...</p>
</li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0729.html" title="20100729"
             >next</a> |</li>
        <li class="right" >
          <a href="0727.html" title="20100727"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2010</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2010/0728.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2010/0728.html">Online Link</a>
    </div>
  </body>
</html>