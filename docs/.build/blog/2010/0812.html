<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2010-08-12 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2010" href="index.html" />
    <link rel="next" title="2010-08-21" href="0821.html" />
    <link rel="prev" title="2010-08-11" href="0811.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0821.html" title="2010-08-21"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0811.html" title="2010-08-11"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2010</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>2010-08-12<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="uhr">
<h2>02.30 Uhr<a class="headerlink" href="#uhr" title="Permalink to this headline">¶</a></h2>
<p>Ich hatte gestern Abend begonnen mit dem GC-Manager (<cite>manage_grid_configs</cite> und <cite>edit_grid_config</cite>, aber das muss wenn schon in ein einziges kombiniertes Fenster mit listview links und Detail rechts), aber jetzt fällt mir auf:</p>
<p>Statt eines GC-Managers könnte ich als schnelle Lösung auch einfach nur das Format der cfg-Dateien ändern. Die sind momentan Pickle-Dateien und deshalb nicht editierbar. (Das <a class="reference external" href="http://docs.python.org/library/pickle.html#data-stream-format">Standardformat von Pickle</a> ist zwar notfalls lesbar (&#8220;for debugging or recovery purposes&#8221;), aber eindeutig nicht zum Bearbeiten gedacht.) Ich kann sie aber stattdessen als json-Dateien abspeichern:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span> <span class="s">&quot;default&quot;</span><span class="p">:</span>
  <span class="p">{</span> <span class="n">widths</span><span class="p">:</span> <span class="p">[</span> <span class="o">...</span> <span class="p">],</span> <span class="n">hidden_cols</span><span class="p">:</span> <span class="p">[</span>  <span class="p">],</span> <span class="n">columns</span><span class="p">:</span> <span class="p">[</span> <span class="o">...</span> <span class="p">]</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Oder noch besser als .py-Dateien:</p>
<div class="highlight-python"><div class="highlight"><pre>self.grid_configs = {
  &#39;default&#39;: { &#39;widths&#39;: [ ... ], &#39;hidden_cols&#39;: [  ], &#39;columns&#39;: [ ... ] }
  &#39;narrow&#39;: { &#39;label&#39;:&#39;Eng&#39;, &#39;widths&#39;: [ ... ], &#39;hidden_cols&#39;: [  ], &#39;columns&#39;: [ ... ] }
}
</pre></div>
</div>
<p>Ja, das gefällt mir. Den GC-Manager können wir uns wahrscheinlich bis auf weiteres ersparen!</p>
<p>Der letzte Punkt in diesem Kapitel ist das Auswählen bzw. Aktivieren einer anderen GC. Das wird ja noch lustig.
Zum Beispiel wenn die GC ein label hat, und wenn es eine Main Grid ist, dann muss der Fenstertitel geändert werden.</p>
</div>
<div class="section" id="id2">
<h2>9.30 Uhr<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Also für <cite>contacts.Companies</cite> habe ich mal eine <code class="file docutils literal"><span class="pre">contacts.Companies.py</span></code> erstellen lassen und manuell eine weitere GC dort definiert. Der Button mit der Auswahlliste wird daraufhin nun schon angezeigt.</p>
<p>Cool: <a class="reference external" href="http://www.sencha.com/deploy/dev/docs/?class=Ext.grid.EditorGridPanel">Ext.grid.EditorGridPanel</a> hat eine Methode <cite>setConfig()</cite>. Also die Grid zu rekonfigurieren dürfte kein Problem sein.</p>
<p>Problem ist noch, dass GridFilters im Fall eines reconfigure-Events seiner Grid nichts anderes tun kann, als deren neues colModel zu analysieren. Also meine Idee von <a class="reference internal" href="0810.html"><em>vorgestern</em></a> (Es ist effizienter, meine filters dem GridFilters direkt im Konstruktor zu übergeben statt sie in mein colModel einzupfropfen und den Gridfilters sie dort raussuchen zu lassen) war eine Mausefalle. Ich muss meine Filter doch ins ColumnModel einpfropfen.</p>
<p>Und nicht zu vergessen: wenn ich den Namen eines Feldes ändere oder ein Feld lösche oder ein neues Feld hinzufüge, dann möchte ich nicht, dass man alls GC wegwerfen kann. Wenn man was im Report oder im Datenmodell ändert, dann sollte man relativ schmerzlos die entsprechenden GC-Dateien manuell anpassen können.</p>
<p>Deshalb also neue Struktur der GC-Dateien:</p>
<ul class="simple">
<li>columns: list of strings (columnnames)</li>
<li>widths : list of integers (width for column with name columns[i])</li>
<li>hiddens : list of of columnnames that are hidden</li>
<li>filters : list of objects {field,type,value,comparison}</li>
</ul>
<p>11.57 Uhr : Es funktioniert! Alles funktioniert! Kolonnenfilter, -reihenfolge, -breiten und -sichtbarkeit werden jetzt in der Ansicht (&#8220;grid config&#8221;) gespeichert. Innerhalb eines Reports kann man mehr als eine Ansicht definieren, was der Benutzer dann durch eine Combobox sieht, mit der er zwischen den verschiedenen Ansichten hin und herschalten kann.</p>
<p><a class="reference external" href="http://code.google.com/p/lino/source/detail?r=362efe46d929a1b61bdd89dd3ea3f29bd59a61f0">Check-In</a>,
und jetzt muss ich aufhören zu programmieren und mal anfangen, die Reise vorzubereiten (morgen fliegen wir nach Brüssel).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0821.html" title="2010-08-21"
             >next</a> |</li>
        <li class="right" >
          <a href="0811.html" title="2010-08-11"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2010</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2010/0812.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2010/0812.html">Online Link</a>
    </div>
  </body>
</html>