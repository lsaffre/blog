<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20100724 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2010" href="index.html" />
    <link rel="next" title="20100727" href="0727.html" />
    <link rel="prev" title="20100723" href="0723.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0727.html" title="20100727"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0723.html" title="20100723"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2010</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20100724<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://www.lino-framework.org/ref/javascript.html#Lino.WindowWrapper.show" title="(in Lino v1.6)"><code class="xref js js-func docutils literal"><span class="pre">Lino.WindowWrapper.show()</span></code></a> benutzt jetzt
<cite>suspendEvents()</cite> und <cite>resumeEvents()</cite> (s.h. <a class="reference external" href="http://www.sencha.com/deploy/dev/docs/?class=Ext.util.Observable">Ext.util.Observable</a>).
Aber ich kann leider keine Verbesserung der Performance feststellen.</p>
<p>Hoho, ich habe endlich erste Ideen bekommen, wie ich Kolonnenfilter und speicherbare Report-Konfigurationen implementieren kann!
Zwei neue Modelle ReportConfig und ReportColumn werden die bisherigen window_configs ersetzen.
Die stehen logicherweise in lino.modlib.system.models.</p>
<p>Das Ganze funktioniert schon fast (nach 4 Stunden an einem Samstagabend):</p>
<ul class="simple">
<li>In system.ColumnsByReport ist die Auswahlliste für colname abhängig von rptname. Logisch.
Aber weil das ein Slave-Report ist, wird der Kontext der Combobox noch nicht gesetzt.
Im <cite>WindowWrapper.js_render()</cite> kann dafür kein &#8220;on(&#8216;change&#8217;,...)&#8221; generiert werden, weil der Report gar kein Feld <cite>report</cite> hat zumindest kein sichtbares.</li>
<li>Das Schwierigste war hier ein Bug in choosers: <code class="xref py py-meth docutils literal"><span class="pre">choosers.Chooser.get_choices()</span></code> funktionierte nur für Methoden, die genau ein Argument hatten.</li>
<li>Außerdem habe ich eine ganze Zeitlang mit Dekoratoren rumgespielt. Ich würde ja gerne vermeiden, dass man die alte Syntax verwenden muss, um eine choice method mit simple_values=True zu definieren. Aber das hab ich wieder aufgegeben.</li>
<li>Chooser.get_text_for_value() ist noch nicht implementiert. Also choice methods für &#8220;normale&#8221; Felder (keine ForeignKey) sollten immer simple values machen. Deshalb wird in der Combobox von ReportConfig.rptname nur der Aktorname und nicht der Titel des Repotrs angezeigt. Das ist nicht schlimm (aber es hat mich Zeit gekostet, das Problem zu identifizieren).</li>
</ul>
<p>TODO:</p>
<ul class="simple">
<li>Um Kolonnen manuell erstellen zu können, müsste er den Kontext für colname setzen.
Tut er aber nicht (weil rptname der fk_name des Reports ist).</li>
<li>Wenn die Sache in der Datenbank steht, muss ichs natürlich noch ins UI einbauen.</li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0727.html" title="20100727"
             >next</a> |</li>
        <li class="right" >
          <a href="0723.html" title="20100723"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2010</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2010/0724.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2010/0724.html">Online Link</a>
    </div>
  </body>
</html>