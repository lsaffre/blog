<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20101028 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2010" href="index.html" />
    <link rel="next" title="20101029" href="1029.html" />
    <link rel="prev" title="20101027" href="1027.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="1029.html" title="20101029"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="1027.html" title="20101027"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2010</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20101028<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="started-to-reanimate-igen">
<h2>Started to reanimate iGen<a class="headerlink" href="#started-to-reanimate-igen" title="Permalink to this headline">¶</a></h2>
<p>Ich habe mich mal drangesetzt und <code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.igen</span></code> repariert.
Zumindest <a class="reference external" href="http://www.lino-framework.org/api/lino.management.commands.initdb.html#module-lino.management.commands.initdb" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.management.commands.initdb</span></code></a> funktioniert jetzt
wieder.</p>
<p>Todo:</p>
<ul class="simple">
<li>eigentlich müssten ich Journaled, Bookable &amp; Co als abstract
models implementieren, aber das funktionierte irgendwie nicht.
Laut <a class="reference external" href="http://charlesleifer.com/blog/django-patterns-model-inheritance/">Django Patterns: Model
Inheritance</a>
sollte es das aber eindeutig.</li>
<li>Übergabe der master instance aus dem Hauptmenü
in die DocumentsByJournal-Reports
funktioniert noch nicht</li>
</ul>
<p>Ich habe auch schon erwägt, django_polymorphic auszuprobieren
(<a class="reference external" href="http://bserve.webhop.org/django_polymorphic/">Polymorphic Models for Django</a>,
<a class="reference external" href="http://github.com/bconstantin/django_polymorphic">Code</a>).
Da lass ich aber momentan die Finger von,
hauptsächlich wegen einiger <a class="reference external" href="http://bserve.webhop.org/django_polymorphic/DOCS.html#restrictions-caveats">restrictions &amp; caveats</a>.
Lieber probiere ich weiter mit Mixins und auf die reine
(wenn auch nicht unbedingt feine) Django-Art.</p>
</div>
<div class="section" id="layoutontabchange-isn-t-always-enough">
<h2>layoutOnTabChange isn&#8217;t always enough<a class="headerlink" href="#layoutontabchange-isn-t-always-enough" title="Permalink to this headline">¶</a></h2>
<p>Das Layout-Problem in den tabbed details ist gelöst!
Hier zum Abschied nochmal der Eintrag aus der To-do-Liste:</p>
<ul class="simple">
<li>Im Detail der Personen sind manche Tabs anfangs nicht korrekt gelayoutet.
Dann muss man jeweils auf den Pin-Button oben rechts klicken (der die Seite mit Permalink neu öffnet) um das korrekte Layout sehen zu können.
Condors Antwort in <a class="reference external" href="https://github.com/lsaffre/lino/blob/master/docs/tickets/1">docs/tickets/1</a>
war leider nur die Lösung für den dort beschriebenen spezifischen Fall.
Aber er hat mich auf eine Idee gebracht: die vbox-Layouts sind schuld am Problem.
Deshalb hatte ich ja auch VBorderPanel geschrieben,
aber das wird zumindest in &#8220;Profil 1&#8221; nicht benutzt.</li>
</ul>
<p>Für die Lösung waren drei Stunden Nachtschicht
und am Ende eine Portion Glück nötig...</p>
<p>Gedanken während der Suche:</p>
<blockquote>
<div><p>Das Problem kommt für vertikale Container ohne vflex-Element
(die also layout &#8216;form&#8217; haben), deren items hboxen sind
(also keine einfachen Felder) und die sich selber wiederum in einer hbox befinden.
Wenn diese hbox sich in einer vbox zusammen
mit einem vflex-element befindet (was ja praktisch immer der Fall ist),
fragt die vbox nach ihrer höhe und kriegt darauf nicht die richtige Antwort.
Konkret kommt das vor in allen Tabs außer 4 (Profil 2) des Personen-Details.
Jetzt wo ich das schon mal verstanden habe, könnte ich mal einen neuen showcase
schreiben.</p>
<p>Wobei der erste Tab das Problem auf den ersten Blick nicht hat, weil der par
défaut aktiv ist. Aber wenn man das Detail per Permalink mit einen anderen Tab
aufruft (z.B. <a class="reference external" href="http://127.0.0.1:8000/api/contacts/Persons/16?fmt=detail&amp;tab=1">http://127.0.0.1:8000/api/contacts/Persons/16?fmt=detail&amp;tab=1</a>),
dann ist der erste Tab ebenfalls falsch.</p>
<p>Ein kleiner Erfolg: nachdem ich jetzt TabPanel.layoutOnTabChange auf true setze,
sind die fehlerhaften Tabs ab dem zweiten Aktivieren korrekt.
Also man braucht jetzt nicht mehr den Permalink, sondern es reicht wenn man
ein bisschen in den Tabs rumblättert...</p>
<p>Für das 5. Tab (Notizen) funktioniert dieser Trick allerdings noch nicht,
da hilft weiterhin nur der Permalink. Dieses Tab ist ja auch anders, dort
ist es die HtmlBox von LinksByOwner, die nicht richtig gelayoutet wird.</p>
</div></blockquote>
<p>Nachdem ich das alles notiert hatte und das Problem eigentlich bis morgen ruhen lassen wollte,
probierte ich noch schnell eine andere Idee: statt layoutOnTabChange zu setzen,
rufe ich doLayout() ein bisschen später selber auf, indem ich eine Funktion
Lino.on_tab_activate ans
activate-Event aller Tabs des TabPanels hänge. Und siehe da: es funktioniert!</p>
<p>Für die HtmlBox musste ich außerdem do_when_visible nicht auf cmp sondern auf
cmp.items.get(0) ansetzen.</p>
<p>2.30 Uhr. Puh, jetzt geh ich aber schlafen! Wenn wir 6 Monate früher wären,
ginge jetzt die Sonne schon auf...</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="1029.html" title="20101029"
             >next</a> |</li>
        <li class="right" >
          <a href="1027.html" title="20101027"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2010</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2010/1028.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2010/1028.html">Online Link</a>
    </div>
  </body>
</html>