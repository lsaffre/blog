<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20100930 disabled fields &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2010" href="index.html" />
    <link rel="next" title="20101001 Notizen einfügen" href="1001.html" />
    <link rel="prev" title="0927...28 Layout-Editor fertig" href="0927.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="1001.html" title="20101001 Notizen einfügen"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0927.html" title="0927...28 Layout-Editor fertig"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2010</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="disabled-fields">
<h1>20100930 disabled fields<a class="headerlink" href="#disabled-fields" title="Permalink to this headline">¶</a></h1>
<p>Jetzt wo der Layout-Editor fertig ist, machen wir weiter mit der <a class="reference external" href="http://www.lino-framework.org/todo.html">/todo</a>.</p>
<div class="section" id="id1">
<h2>disabled fields<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Wenn man in der Tabellenansicht versucht, ein <a class="reference external" href="http://www.lino-framework.org/ref/glossary.html#term-disabled-fields" title="(in Lino v1.6)"><span class="xref std std-term">disabled field</span></a>
zu bearbeiten, meldet
er jetzt in der Konsole ein höfliches <cite>Field &#8220;street&#8221; is disabled for this record</cite>.
Diese Meldung formatiere ich jetzt erstmals mit <code class="xref js js-func docutils literal"><span class="pre">String.format()</span></code>.
Um sie zu internationalisieren, muss ich entweder die <a class="reference external" href="http://www.lino-framework.org/ref/files.html#xfile-lino.js" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">lino.js</span></code></a>
ebenfalls beim Serverstart generieren
oder in der <code class="xref std std-xfile docutils literal"><span class="pre">site.js</span></code> eine systemweite Konstante dafür vorsehen.</li>
<li><code class="xref py py-class docutils literal"><span class="pre">ext_store.DisabledFieldsStoreField</span></code> hängt jetzt für normale (nicht Phantom-) Records (d.h. deren <code class="docutils literal"><span class="pre">pk</span></code> nicht <code class="docutils literal"><span class="pre">None</span></code>)
den primary key in die Liste der disabled fields. Also der primary key sollte in
<code class="xref py py-meth docutils literal"><span class="pre">lino.reports.Report.disabled_fields()</span></code> nicht angegeben werden.</li>
<li>disabled ComboBox fields (z.B. Person.city) waren in der Tabellenansicht dennoch editierbar,
weil <code class="xref py py-class docutils literal"><span class="pre">ext_store.DisabledFieldsStoreField</span></code> als Feldnamen <cite>cityHidden</cite> und nicht <cite>city</cite>
in <cite>disabled_fields</cite> eintrug.
Konflikt: FormPanel wollte den Hidden-Namen des Feldes, GridPanel den eigentlichen Namen.
Lösung:
<code class="xref py py-class docutils literal"><span class="pre">ext_store.DisabledFieldsStoreField</span></code> trägt jetzt die eigentlichen Feldnamen (nicht mehr deren Hidden-Version) in in <cite>disabled_fields</cite> ein. Und <cite>Lino.FormPanel.load_master_record</cite> will jetzt auch den eigentlichen Namen (benutzt nicht mehr <a class="reference external" href="http://www.sencha.com/deploy/dev/docs/?class=Ext.form.BasicForm">Ext.form.BasicForm</a>.findField(), sondern <a class="reference external" href="http://www.sencha.com/deploy/dev/docs/?class=Ext.form.FormPanel">Ext.form.FormPanel</a>.find()).</li>
</ul>
</div>
<div class="section" id="detail-of-slave-reports">
<h2>Detail of slave reports<a class="headerlink" href="#detail-of-slave-reports" title="Permalink to this headline">¶</a></h2>
<p>Ein Punkt weniger in der <a class="reference external" href="http://www.lino-framework.org/todo.html">/todo</a>:</p>
<ul class="simple">
<li>In slave reports (z.B. <a class="reference external" href="http://127.0.0.1:8000/api/contacts/Persons/16?fmt=detail&amp;tab=4">NotesByPerson</a>)
funktioniert das Detail nicht (ist immer leer).
Das liegt daran, dass er zum Laden des Records ein <cite>GET /api/notes/NotesByPerson/16</cite>
fragt (also ohne mt und mk).</li>
</ul>
<p>Das Problem kam u.A. daher, dass ich <cite>master record</cite> und <cite>current record</cite> an ein paar Stellen verwechselte.
Jedenfalls einige Änderungen in
<code class="xref py py-meth docutils literal"><span class="pre">ext_ui.ExtUi.a2btn()</span></code>,
<code class="xref py py-meth docutils literal"><span class="pre">ext_windows.MasterWrapper.js_render()</span></code>
und <a class="reference external" href="http://www.lino-framework.org/ref/files.html#xfile-lino.js" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">lino.js</span></code></a></p>
<p>Der master record eines slave reports ist es, der die Query-Parameter mt und mk definiert.
Sowohl FormPanel als auch GridPanel können auf einem Slave Report sein und brauchen dann einen Master.
Aber wo sitzt der Master? Na im WindowWrapper.
Wie wird der Master gesetzt? Momentan lediglich durch die Parameter <cite>record_id</cite> oder <cite>data_record</cite>
Also jedes panel auf einem slave report fragt seinen ww nach dem Master record.
Das Formpanel tat das bisher nicht.
FormPanel ist immer ein MainPanel: davon gibt es immer nur eines pro ww.</p>
</div>
<div class="section" id="deleting-records">
<h2>Deleting records<a class="headerlink" href="#deleting-records" title="Permalink to this headline">¶</a></h2>
<p>Und noch ein Punkt weniger in der <a class="reference external" href="http://www.lino-framework.org/todo.html">/todo</a>:</p>
<ul class="simple">
<li>Löschen auf Extrazeile sollte deaktiviert sein.</li>
</ul>
<p>Dafür wohl ein neuer (nicht so dringender) Punkt:</p>
<ul class="simple">
<li>Ich würde in der Rückfrage ja auch gerne die <cite>__unicode__</cite> der zu löschenden Records anzeigen.
FormPanel und GridPanel.get_selected() geben deshalb jetzt nicht mehr bloß eine Liste der IDs, sondern eine Liste der Records.
Aber das nützt (noch) nichts, denn ich weiß nicht, wie ich den Grid-Store überredet bekomme, außer <cite>data</cite>
auch eine Eigenschaft <cite>title</cite> aus jedem Record rauszulesen.
Auf Serverseite wäre das kein Problem: ich bräuchte einfach nur title in <cite>elem2rec1</cite> statt in <cite>elem2rec_detailed</cite> zu setzen.
Aber das interessiert den Store der Grid nicht. Kann sein, dass ich ihn konfigurieren kann...
Oder ich würde es wie mit <cite>disabled_fields</cite> machen. Also ein neues automatisches virtuelles Feld __unicode__.</li>
</ul>
<p>22 Uhr. Okay, für heute bin ich zufrieden. Check-In.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="1001.html" title="20101001 Notizen einfügen"
             >next</a> |</li>
        <li class="right" >
          <a href="0927.html" title="0927...28 Layout-Editor fertig"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2010</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2010/0930.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2010/0930.html">Online Link</a>
    </div>
  </body>
</html>