<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tuesday, March 3, 2015 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2015" href="index.html" />
    <link rel="next" title="Wednesday, March 4, 2015" href="0304.html" />
    <link rel="prev" title="20150302 (Monday, 02 March 2015)" href="0302.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0304.html" title="Wednesday, March 4, 2015"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0302.html" title="20150302 (Monday, 02 March 2015)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2015</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tuesday-march-3-2015">
<h1>Tuesday, March 3, 2015<a class="headerlink" href="#tuesday-march-3-2015" title="Permalink to this headline">¶</a></h1>
<div class="section" id="lino-and-django-1-7">
<h2>Lino and Django 1.7<a class="headerlink" href="#lino-and-django-1-7" title="Permalink to this headline">¶</a></h2>
<p>Mahmoud and I started yesterday to work on <a class="reference external" href="http://trac.lino-framework.org/ticket/38">#38</a> (Convert to
Django 1.7).</p>
<p>When upgrading to Django 1.7, the <strong class="command">fab initdb</strong> fails already
on the first demo database. You can reproduce the current state as
follows:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd lino/projects/docs
$ ./initdb_tmp
</pre></div>
</div>
<p>In the current development version, this causes an exception:</p>
<blockquote>
<div>Problem installing fixture
&#8216;.../lino/modlib/users/fixtures/demo.py&#8217;:
User(username=&#8217;robin&#8217;,...,language=&#8217;en&#8217;,...) :
{&#8216;language&#8217;: [u&#8221;Value &#8216;en&#8217; is not a valid choice.&#8221;]}</div></blockquote>
</div>
<div class="section" id="cannot-find-first-and-last-names-in-r">
<h2>Cannot find first and last names in %r<a class="headerlink" href="#cannot-find-first-and-last-names-in-r" title="Permalink to this headline">¶</a></h2>
<p>This error message was sent as an admin email when a user had
submitted an insert form with a non-parsable doctor name on a
<a class="reference external" href="http://welfare.lino-framework.org/api/lino_welfare.modlib.aids.models.html#lino_welfare.modlib.aids.models.RefundConfirmation" title="(in Lino Welfare Reference Manual v1.1)"><code class="xref py py-class docutils literal"><span class="pre">lino_welfare.modlib.aids.models.RefundConfirmation</span></code></a>.</p>
<p>It was caused by <code class="xref py py-func docutils literal"><span class="pre">lino.modlib.contacts.utils.parse_name()</span></code>.  I
changed the exception type from <cite>Warning</cite> to <cite>ValidationError</cite>.</p>
<p>Another solution might have been to extend
<a class="reference external" href="http://www.lino-framework.org/api/lino.core.store.html#lino.core.store.Store.form2obj" title="(in Lino v1.6)"><code class="xref py py-meth docutils literal"><span class="pre">lino.core.store.Store.form2obj()</span></code></a> so that it also digests
<cite>Warning</cite> exceptions.  I am undecided which one to prefer.  <cite>Warning</cite>
has the advantage of being a built-in exception type while
<cite>ValidationError</cite> is from Django. On the other hand this built-in
<cite>Warning</cite> is not actually meant for being used by code as mine, it is
used by the <cite>warnings</cite> module as a warning category.</p>
</div>
<div class="section" id="acting-as-a-former-colleague">
<h2>Acting as a former colleague?<a class="headerlink" href="#acting-as-a-former-colleague" title="Permalink to this headline">¶</a></h2>
<p>Hubert fragte:</p>
<blockquote>
<div>da ich den VSE #645 vor Ablauf (30/09/2016) &#8220;beenden&#8221; muss, um einen
neuen Vertrag mit neuem Inhalt/Ziel generieren zu können, müsste ich
arbeiten &#8220;als Nicolas&#8221; (Schöpfer dieses Vertrages). Wenn ich das aber
versuche, kommt folgende Fehlermeldung: Server Error (500)</div></blockquote>
<p>Meine Antwort:</p>
<blockquote>
<div><p>Die momentane Logik ist: Nicolas hat sein Feld Benutzerprofil auf
leer, dadurch ist er deaktiviert. Deshalb kann man auch nicht &#8220;als
Nicolas&#8221; arbeiten. Denn &#8220;als jemand arbeiten&#8221; bedeutet auch, dessen
Benutzerprofil zu übernehmen. Dass Lino den Nicolas trotzdem in der
Auswahlliste &#8220;arbeiten als&#8221; anzeigt, ist ein Bug.</p>
<p>Hubert möchte hier ja auch eigentlich gar nicht &#8220;als Nicolas&#8221;
arbeiten, sondern lediglich (als Hubert) einen Vertrag ändern, dessen
Autor Nicolas ist.</p>
<p>Du könntest Hubert mal kurz zum Dienstleiter ernennen (Profil von 400
auf 410 ändern), damit er anderer Leute Verträge bearbeiten kann.</p>
<p>Das Recht, anderer Leute Verträge bearbeiten zu können, kann momentan
nicht anders erteilt werden als durch so einen Profilwechsel. Macht es
Sinn, dass wir das feiner regelbar machen? Z.B. durch ein Ankreuzfeld
&#8220;Kann anderer Leute Dokumente bearbeiten&#8221; pro Benutzer.</p>
</div></blockquote>
<ul class="simple">
<li>Lino allowed to create appointments for a user without <cite>profile</cite></li>
<li>Lino showed also users without profile in the <span class="menuselection">Act
as...</span> menu of non-manager users.</li>
</ul>
</div>
<div class="section" id="about-prompt-consultations-and-newcomer-appointments">
<h2>About prompt consultations and newcomer appointments<a class="headerlink" href="#about-prompt-consultations-and-newcomer-appointments" title="Permalink to this headline">¶</a></h2>
<p>I recently thought that <cite>newcomer_appointments</cite> and
<cite>newcomer_consultations</cite> are useless because we can test
<cite>newcomer_quota</cite> instead. Nope, I was wrong.</p>
<p>In <a class="reference external" href="http://welfare.lino-framework.org/api/lino_welfare.modlib.reception.html#module-lino_welfare.modlib.reception" title="(in Lino Welfare Reference Manual v1.1)"><code class="xref py py-mod docutils literal"><span class="pre">lino_welfare.modlib.reception</span></code></a> we use them as additional
arguments to the <a class="reference external" href="http://welfare.lino-framework.org/api/lino_welfare.modlib.reception.models.html#lino_welfare.modlib.reception.models.appointable_users" title="(in Lino Welfare Reference Manual v1.1)"><code class="xref py py-func docutils literal"><span class="pre">appointable_users</span></code></a> function
because we want to see only</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0304.html" title="Wednesday, March 4, 2015"
             >next</a> |</li>
        <li class="right" >
          <a href="0302.html" title="20150302 (Monday, 02 March 2015)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2015</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2015/0303.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2015/0303.html">Online Link</a>
    </div>
  </body>
</html>