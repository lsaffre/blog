<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20120704 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2012" href="index.html" />
    <link rel="next" title="20120705" href="0705.html" />
    <link rel="prev" title="20120703" href="0703.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0705.html" title="20120705"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0703.html" title="20120703"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2012</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20120704<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="done">
<h2>Done<a class="headerlink" href="#done" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Wenn ein Fehler während Tx25.Result passiert, bleiben jetzt nicht mehr die
Daten der vorigen Person da stehen.</p>
</li>
<li><p class="first">Neue Fälle Tx25: wrote handlers for DeclaredBirthDate,
ResidenceUpdateDates, DocumentTypes, ...</p>
</li>
<li><p class="first">Übersetzungen. in &#8220;Wohnsitze&#8221; stand noch ein &#8220;Language&#8221;,
Organization, RegistrationRegister (Eintragungsregister),
[Show all], ...</p>
</li>
<li><p class="first">html2text : holte alle Umlaute raus. Das war zu viel des Guten.</p>
</li>
<li><p class="first">IPR PhoneticSearch ist jetzt vorausgefüllt.
(Couldn&#8217;t reproduce this. )</p>
</li>
<li><p class="first">IPR.duplicate kopiert birth_date nicht.
Genauer gesagt rief er dann <cite>person_changed</cite> auf und setzte folglich für
alle Paremeterfelder wieder die Standardwerte ein.</p>
</li>
<li><p class="first">The label of the <cite>user</cite> field of a <code class="xref py py-class docutils literal"><span class="pre">lino.mixins.UserAuthored</span></code>
is now &#8220;Author&#8221; instead of &#8220;User&#8221;.</p>
</li>
<li><p class="first">debts.Budgets and cal.Tasks now also have their separate insert window</p>
</li>
<li><p class="first">Hilfetexte für &#8220;nicht blockierend&#8221;, &#8220;Zugriffsklasse&#8221; und &#8220;Status&#8221;</p>
</li>
<li><p class="first">Übersetzung Task-Status &#8220;Started&#8221; ist &#8220;Begonnen&#8221; nicht &#8220;Beginn&#8221;.
Added new Task State &#8220;sleeping&#8221;.</p>
</li>
<li><p class="first">To-Do-Liste darf nur todo-Einträge (und &#8220;Begonnen&#8221;) anzeigen. Aber nicht die mit leerem Status.</p>
</li>
<li><p class="first"><a class="reference external" href="http://www.lino-framework.org/ref/glossary.html#term-watch-tim" title="(in Lino v1.6)"><span class="xref std std-term">watch_tim</span></a> : Wenn &#8220;Herr&#8221; bzw. &#8220;Frau&#8221; in Anrede steht -&gt; nicht übernehmen.
Auch <code class="xref py py-mod docutils literal"><span class="pre">lino.apps.pcsw.migrate</span></code>, so dass bestehende Daten korrekt übernommen werden.
Momentan werden folgende Anreden ignoriert: &#8220;Herr&#8221;,&#8221;Herrn&#8221;,&#8221;Frau&#8221;,&#8221;Fräulein&#8221;,&#8221;Madame&#8221;</p>
</li>
<li><p class="first">Im Calendar-Panel steht im Titel von Terminen anderer Benutzer deren Benutzername.</p>
</li>
<li><p class="first">CalendarApp statt nur CalendarPanel: der Kalender zeigt jetzt links die Liste der
Kalender an, mit denen man die Termine der anderen Benutzer ausschalten kann.</p>
</li>
<li><p class="first">Lino setzte dann die Uhrzeit von leer auf 00:00, wenn man einen Ganztagstermin verschob.
(<code class="xref py py-meth docutils literal"><span class="pre">lino.modlib.cal.models.ComponentBase.set_datetime()</span></code> now tests for empty time.)</p>
</li>
<li><p class="first">Termin im Status &#8220;Entwurf&#8221; -&gt; Klick auf &#8220;Geplant&#8221;
meldet &#8220;Uncaught TypeError: Cannot call method &#8216;get_record_url&#8217; of undefined&#8221;</p>
<p>This happened after having saved the record. <cite>FormPanel.save()</cite> didn&#8217;t
pass <cite>requesting_panel</cite> (URL_PARAM_PANEL), so the
<code class="xref py py-meth docutils literal"><span class="pre">workflow_buttons</span></code>
of the <cite>data_record</cite> returned by the POST or PUT
got rendered with &#8220;None&#8221; as requesting panel id.</p>
</li>
<li><p class="first">Workflow actions (i.e. who have a <cite>states</cite> requirement)
are now shown only in the
<code class="xref py py-meth docutils literal"><span class="pre">workflow_buttons</span></code>
field while &#8220;stateless&#8221; actions
are now always shown only in the bottom toolbar (or the context menu).</p>
</li>
<li><p class="first">Nicht (mehr?) reproduzierbar:
CalendarPanel : &#8220;Detail editieren&#8221; bewirkt &#8220;Uncaught TypeError: Cannot read property &#8216;ID&#8217;
of undefined&#8221;</p>
</li>
</ul>
</div>
<div class="section" id="yet-to-do">
<h2>Yet to do<a class="headerlink" href="#yet-to-do" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Automatisch erstellte Auswertungstermine haben Terminart leer.
Sollte konfigurierbar sein.
Auch eine Uhrzeit sollte gesetzt werden, weil sie im CalendarPanel sonst als Ganztagestermine
behandelt werden.</li>
<li>Hilfetexte auf die Workflow-Buttons</li>
<li>Wenn Termin Status &#8220;Verjährt&#8221; hat und von gestern nach übermorgen verschoben
wird, darf Status nicht auf verjährt bleiben. Muss &#8220;geplant&#8221; werden.</li>
<li>Was heißt das Glöckchen hinter dem Titel eines Termins im CalendarPanel?</li>
<li>Doku : Anweisungen um Default.eml.html zu bearbeiten</li>
</ul>
</div>
<div class="section" id="remarks">
<h2>Remarks<a class="headerlink" href="#remarks" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">html2text: Updated from 3.02 to 3.1.
Added <a class="reference external" href="http://www.lino-framework.org/api/lino.utils.html2text.html#module-lino.utils.html2text" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.utils.html2text</span></code></a> to autodoc and to
the <a class="reference external" href="http://www.lino-framework.org/about/thanks.html">/about/thanks</a> page.</p>
</li>
<li><p class="first"><code class="xref py py-class docutils literal"><span class="pre">lino.ui.console.Console</span></code> now forwards <cite>get_handle</cite> to <code class="xref py py-mod docutils literal"><span class="pre">lino.extjs.ui</span></code>.
Here is why:</p>
<div class="highlight-python"><div class="highlight"><pre>Error while evaluating the expression &quot;table(self.Result(ar))&quot; defined in the &quot;from&quot; part of a statement.
File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
File &quot;t:\hgwork\lino\lino\utils\appy_pod.py&quot;, line 272, in insert_table
columns = ah.list_layout.main.columns
&lt;type &#39;exceptions.AttributeError&#39;&gt;: TableHandle instance has no attribute &#39;list_layout&#39;
</pre></div>
</div>
<p>Had to modify the local script <code class="file docutils literal"><span class="pre">print_tx25.py</span></code> (which then was again
very useful for adding new handlers to <code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.cbss.tx25</span></code>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">lino.ui.console</span> <span class="kn">import</span> <span class="n">Console</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;Must specify Lino number of Tx25&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pk</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ui</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">lino.modlib.cbss.tx25</span> <span class="kn">import</span> <span class="n">RetrieveTIGroupsRequests</span> <span class="k">as</span> <span class="n">Tx25</span>
<span class="n">ui</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">Tx25</span><span class="o">.</span><span class="n">print_action</span><span class="p">,</span><span class="n">pk</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">The default <cite>duplicate_row</cite> method (which does nothing) is now defined on
<code class="xref py py-class docutils literal"><span class="pre">lino.code.modeltools.Model</span></code>, and <code class="xref py py-func docutils literal"><span class="pre">lino.core.kernel.analyze_models()</span></code>
now injects this to models that don&#8217;t have it.
<code class="xref py py-meth docutils literal"><span class="pre">lino.mixins.duplicable.Duplicable.duplicate_row()</span></code>
no longer tests whether related slaves are an instance
of <code class="xref py py-mod docutils literal"><span class="pre">lino.mixins.duplicable.Duplicable</span></code> before calling their on_duplicate.</p>
</li>
<li><p class="first">When creating a new debts.Budget, Lino had an AttributeError:</p>
<div class="highlight-python"><div class="highlight"><pre>&#39;NoneType&#39; object has no attribute &#39;REQUEST&#39;
TRACEBACK:
  ...
  File &quot;t:\hgwork\lino\lino\modlib\debts\models.py&quot;, line 470, in render
    html += ar.ui.table2xhtml(sar)
  File &quot;t:\hgwork\lino\lino\ui\extjs3\ext_ui.py&quot;, line 2595, in table2xhtml
    self.ar2html(ar,t)
  File &quot;t:\hgwork\lino\lino\ui\extjs3\ext_ui.py&quot;, line 2604, in ar2html
    widths = [x for x in ar.request.REQUEST.getlist(ext_requests.URL_PARAM_WIDTHS)]
</pre></div>
</div>
</li>
<li><p class="first">Changed signature of <code class="xref py py-meth docutils literal"><span class="pre">lino.core.layouts.BaseLayout.__init__()</span></code>
because application code should be allowed to write:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">insert_layout</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">FormLayout</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">partner</span>
<span class="s">date user</span>
<span class="s">&quot;&quot;&quot;</span><span class="p">,</span><span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="s">&#39;auto&#39;</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p class="first">It was the first time that I added <em>translatable</em> hard-coded <cite>help_text</cite>
to some fields.</p>
</li>
</ul>
</div>
<div class="section" id="workflow-versus-stateless-actions">
<h2>&#8220;Workflow&#8221; versus &#8220;Stateless&#8221; actions<a class="headerlink" href="#workflow-versus-stateless-actions" title="Permalink to this headline">¶</a></h2>
<p>A &#8220;workflow action&#8221; is an action that has a <cite>states</cite> requirement.
Other actions are called &#8220;stateless&#8221;.
Stateless actions are shown in the bottom toolbar,
Workflow actions in the
<code class="xref py py-meth docutils literal"><span class="pre">workflow_buttons</span></code>
field.</p>
<p>The <code class="xref py py-meth docutils literal"><span class="pre">set_required</span></code>
method of an action also sets the
<cite>show_in_bbar &lt;lino.core.actions.Action.show_in_bbar&gt;</cite>
and
<cite>show_in_workflow &lt;lino.core.actions.Action.show_in_workflow&gt;</cite>
attributes.</p>
<p>Application developers
can define a <code class="xref py py-meth docutils literal"><span class="pre">setup_table</span></code>
method on a Table
which calls
<code class="xref py py-meth docutils literal"><span class="pre">Action.set_required</span></code>
to turn e.g. the &#8220;Print&#8221; action into a
workflow action:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">setup_table</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="n">t</span><span class="o">.</span><span class="n">create_mail</span><span class="o">.</span><span class="n">set_required</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;scheduled&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0705.html" title="20120705"
             >next</a> |</li>
        <li class="right" >
          <a href="0703.html" title="20120703"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2012</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2012/0704.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2012/0704.html">Online Link</a>
    </div>
  </body>
</html>