<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20120228 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2012" href="index.html" />
    <link rel="next" title="20120229" href="0229.html" />
    <link rel="prev" title="20120227" href="0227.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0229.html" title="20120229"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0227.html" title="20120227"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2012</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20120228<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="site-de-demonstration-imio">
<h2>Site de démonstration IMIO<a class="headerlink" href="#site-de-demonstration-imio" title="Permalink to this headline">¶</a></h2>
<p>Début des travaux pour un site de démonstration en collaboration
avec l&#8217;<a class="reference external" href="http://www.imio.be">IMIO</a>.
Pour avoir des données de démonstration un peu réalistes, j&#8217;ai
pris une <a class="reference external" href="http://www.lavoute.org/debuter/Belgique.htm">liste des noms de familles belges</a>,
une <a class="reference external" href="http://meilleursprenoms.com/site/LesClassiques/LesClassiques.htm">liste des prénoms classiques en France</a>
et une <a class="reference external" href="http://fr.wikipedia.org/wiki/Liste_des_rues_de_Li%C3%A8ge">liste des rues de Liège</a>,
j&#8217;en fais un mix aléatoire pour obtenir 200 personnes fictives habitant
dans la région de Liège...</p>
<a class="reference internal image-reference" href="../../_images/0228.jpg"><img alt="../../_images/0228.jpg" src="../../_images/0228.jpg" style="width: 595.0px; height: 436.0px;" /></a>
<p>(Il y a de quoi fignoler: générer également des NISS, des n° de GSM,...)</p>
<p>Voici aussi le code source de cette <em>fixture</em> dans le repository de Lino:
<a class="reference external" href="https://github.com/lsaffre/lino/blob/master//lino/modlib/contacts/fixtures/demo_fr.py">/lino/modlib/contacts/fixtures/demo_fr.py</a>.</p>
</div>
<div class="section" id="no-more-x-masked-relative">
<h2>No more <cite>x-masked-relative</cite><a class="headerlink" href="#no-more-x-masked-relative" title="Permalink to this headline">¶</a></h2>
<p>The following effect happens in Lino/PCSW 1.4.2 in the insert window of a
<code class="xref py py-class docutils literal"><span class="pre">Job</span> <span class="pre">Contract</span></code> (and only there):</p>
<a class="reference internal image-reference" href="../../_images/0228b.jpg"><img alt="../../_images/0228b.jpg" src="../../_images/0228b.jpg" style="width: 595.0px; height: 436.0px;" /></a>
<p>After clicking <cite>Speichern</cite>, Lino switches to the detail window where the effect
does <em>not</em> happen, although both windows use the same class
<cite>Lino.jobs.Contracts.FormPanel</cite>:</p>
<a class="reference internal image-reference" href="../../_images/0228e.jpg"><img alt="../../_images/0228e.jpg" src="../../_images/0228e.jpg" style="width: 595.0px; height: 436.0px;" /></a>
<p>The difference is that the two grids in the lower hbox are
<strong>disabled</strong> in the &#8220;insert&#8221; version of our FormPanel.</p>
<p>Let&#8217;s go back to the insert window and inspect those misplaced grids.
Aha. The effect comes because the two disabled grids have
a css class <cite>x-masked-relative</cite> which sets their
<cite>position</cite> to &#8220;relative&#8221;:</p>
<a class="reference internal image-reference" href="../../_images/0228c.jpg"><img alt="../../_images/0228c.jpg" src="../../_images/0228c.jpg" style="width: 625.5px; height: 416.5px;" /></a>
<p>Manually disabling the rule visibly solves the problem:</p>
<a class="reference internal image-reference" href="../../_images/0228d.jpg"><img alt="../../_images/0228d.jpg" src="../../_images/0228d.jpg" style="width: 595.0px; height: 436.0px;" /></a>
<p>The class <cite>x-masked-relative</cite> is defined in <code class="file docutils literal"><span class="pre">core.css</span></code>
and does nothing else than overriding that
<cite>position</cite> property to &#8220;relative&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre>.x-masked-relative {
    position: relative !important;
}
</pre></div>
</div>
<p>Why do disabled panels have a class <cite>x-masked-relative</cite>?
Can I tell ExtJS to not use it?
It is applied to elements during the <cite>mask()</cite> method, when
their position was &#8220;static&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre>mask : function(msg, msgCls) {
    ...
    if (!(/^body/i.test(dom.tagName) &amp;&amp; me.getStyle(&#39;position&#39;) == &#39;static&#39;)) {
        me.addClass(XMASKEDRELATIVE);  // 20120228
    }
    ...
    mask = dh.append(dom, {cls : &quot;ext-el-mask&quot;}, true);
    ...
    return mask;
},
</pre></div>
</div>
<p>When I remove the
<code class="docutils literal"><span class="pre">me.addClass(XMASKEDRELATIVE)</span></code> instruction
in above <cite>Ext.Element.mask()</cite>, everything seems to work fine.
The future will tell us whether this hack causes side-effects.</p>
<p>Since I don&#8217;t want to tell every Lino user to patch their ExtJS sources,
I overwrite that method in <a class="reference external" href="http://www.lino-framework.org/ref/files.html#xfile-linolib.js" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">linolib.js</span></code></a>.</p>
<p>But what was the purpose of that operation?
Why does the css class <cite>x-masked-relative</cite> exist?
I have no idea...</p>
<p>Independently of that problem, I modified the general layout
of that FormPanel after this :</p>
<a class="reference internal image-reference" href="../../_images/0228f.jpg"><img alt="../../_images/0228f.jpg" src="../../_images/0228f.jpg" style="width: 595.0px; height: 436.0px;" /></a>
</div>
<div class="section" id="und-noch-ein-bug">
<h2>Und noch ein Bug<a class="headerlink" href="#und-noch-ein-bug" title="Permalink to this headline">¶</a></h2>
<p>Hackerzacker, kaum habe ich nach fast zweistündigem Wursteln obigen Bug gelöst,
finde ich noch einen. Diesmal im Kalender-Panel und in meinem eigenen Code.
Für die Benutzer sah es so aus, dass das Popup-Fenster zum Einfügen eines
Termins sich nicht schloss, wenn man bestätigte.
Lag daran, dass
<code class="xref py py-meth docutils literal"><span class="pre">lino.modlib.cal.models.ExtAllDayField.set_value_in_object()</span></code>
selber ein <cite>save()</cite> aufrief.</p>
</div>
<div class="section" id="preparing-to-release-1-4-3">
<h2>Preparing to release 1.4.3<a class="headerlink" href="#preparing-to-release-1-4-3" title="Permalink to this headline">¶</a></h2>
<p><code class="xref py py-func docutils literal"><span class="pre">lino.apps.pcsw.migrate.migrate_from_1_4_2()</span></code></p>
<p>Zwischendurch auch noch ein ganz einfacher Bug:</p>
<ul class="simple">
<li>Wenn man einen Kolonnenfilter setzte, kam auf dem Server ein Traceback
&#8220;global name &#8216;json&#8217; is not defined&#8221;</li>
</ul>
<p>Und dann wollte ich eigentlich endlich die strenge Version des
<code class="xref py py-class docutils literal"><span class="pre">OverlappingContractsTest</span></code>
aktivieren, aber dann fand er doch noch eine ganze Serie von
Beanstandungen bei Datenimport.
Wieso denn das?
Die Datenkontrollliste war doch leer?
Tilt! Die Datenkontrollliste zeigte nur deshalb keine Fehlermeldungen an,
weil die Antwort des Servers mehr als 30 Sekunden brauchte.
Das ist der Defaultwert für <cite>Ext.Ajax.timeout</cite>
(ein Parameter, den ich gerade erst entdeckt habe).
Statt den Timeout jetzt einfach zu erhöhen, sollte ich wohl besser mal
überlegen, wie Lino solche längeren Prozesse verwalten sollte.
Es gibt ja den <cite>Ext.ProgressBar</cite>.
Jedenfalls bleibt der
<code class="xref py py-class docutils literal"><span class="pre">OverlappingContractsTest</span></code>
zunächst mal noch in der
Datenkontrollliste.</p>
<p>Et voilà: released <a class="reference external" href="http://www.lino-framework.org/releases/1.4.3.html">/releases/1.4.3</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0229.html" title="20120229"
             >next</a> |</li>
        <li class="right" >
          <a href="0227.html" title="20120227"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2012</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2012/0228.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2012/0228.html">Online Link</a>
    </div>
  </body>
</html>