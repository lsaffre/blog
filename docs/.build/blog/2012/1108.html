<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20121108 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2012" href="index.html" />
    <link rel="next" title="20121109" href="1109.html" />
    <link rel="prev" title="20121107" href="1107.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="1109.html" title="20121109"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="1107.html" title="20121107"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2012</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20121108<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="eid-karten-einlesen">
<h2>eID-Karten einlesen<a class="headerlink" href="#eid-karten-einlesen" title="Permalink to this headline">¶</a></h2>
<p>Tilt!
Nee, die erste Implementierung (ohne Actor) war nix.
Viel schöner ist, wenn ich sie als
<code class="xref py py-class docutils literal"><span class="pre">lino_welfare.modlib.pcsw.models.BeIdReadCardAction</span></code>
definiere!</p>
<p>eid-javascript-lib übergab das Geburtsdatum anfangs
als
<code class="docutils literal"><span class="pre">birthDate:1968-06-01T00:00:00</span></code>.
Sollte aber laut <code class="xref py py-attr docutils literal"><span class="pre">lino.Lino.date_format_extjs</span></code> sein.
Und was ist mit unkompletten Geburtsdaten?</p>
</div>
<div class="section" id="unbekannte-nr-nummern">
<h2>Unbekannte NR-Nummern<a class="headerlink" href="#unbekannte-nr-nummern" title="Permalink to this headline">¶</a></h2>
<p>Neue Regel: die NR-Nr. eines Klienten darf ab jetzt <em>wohl</em> leer sein.
Die Konvention, dass bei Klienten mit unbekannter oder ungültiger
NR-Nr stattdessen die Partnernummer im Feld NR-Nr stehen muss, ist also nicht mehr nötig.
Wenn die NR-Nr ausgefüllt ist, muss sie weiterhin einzig sein.
Bei Dubletten kann man z.B. a, b dahinter setzen.
Dadurch wird die Nummer (als NR-Nummer) freilich ungültig,
was aber okay ist <em>solange der Klient nicht &#8220;Begleitet&#8221; ist</em>.</p>
<p>Ich dachte bisher, dass das technisch nicht möglich ist, but
after reading the thread <a class="reference external" href="http://stackoverflow.com/questions/454436/unique-fields-that-allow-nulls-in-django">Unique fields that allow nulls in Django</a>
on stackoverflow I decided to use this for the <cite>national_id</cite> field of a
<a class="reference external" href="http://welfare.lino-framework.org/api/lino_welfare.modlib.pcsw.models.html#lino_welfare.modlib.pcsw.models.Client" title="(in Lino Welfare Reference Manual v1.1)"><code class="xref py py-class docutils literal"><span class="pre">Client</span></code></a>.</p>
<p>Diese Neuerung ist zwar lästig (Buggefahr), aber prinzipiell gut.
Auslöser war vor allem folgendes:
Wenn eine eId-Karte eingelesen wird, für deren NR-Nr wir keinen Klienten
haben, dann sollte Lino nicht schon sogleich vorschlagen, den neuen
Klienten anzulegen, sondern erstmal schauen, ob es diese Person nicht
schon ohne NR-Nr gibt.
Mit unserer Konvention, dass anstelle von ungültigen
NR-Nummern die Partnernummer im Feld NR-Nr stehen soll, wird das ein
suboptimales Query.</p>
</div>
<div class="section" id="printing-a-table-from-command-line">
<h2>Printing a table from command line<a class="headerlink" href="#printing-a-table-from-command-line" title="Permalink to this headline">¶</a></h2>
<p>New table <a class="reference external" href="http://www.lino-framework.org/api/lino.modlib.users.models.html#lino.modlib.users.models.UsersOverview" title="(in Lino v1.6)"><code class="xref py py-class docutils literal"><span class="pre">lino.modlib.users.models.UsersOverview</span></code></a>
and new shortcut <code class="xref py py-meth docutils literal"><span class="pre">lino.core.actors.Actor.to_rst()</span></code>.
Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python manage.py shell
&gt;&gt;&gt; from lino.modlib.users.models import UsersOverview as T; print T.to_rst()
INFO Starting Lino...
INFO Analyzing models...
INFO Lino Site &#39;DSBE@armand&#39; started. Languages: de, fr, en. 296 actors.
INFO Using Lino/Welfare 1.0.1, Lino 1.5.1, Django 1.5.dev17942, python-dateutil 1.5, Cheetah 2.4.4, OdfPy ODFPY/0.9.4, docutils 0.9.1, suds 0.4.1, PyYaml 3.08, Appy 0.8.0 (2011/12/15 22:41), Python 2.7.1.
============ ===================================== =======
Benutzername Benutzerprofil                        Sprache
============ ===================================== =======
alicia       Integration Agent                     de
caroline     Berater Neuanträge                    de
charles      CBSS only                             de
elmar        Anonymous                             de
gerd         Verwalter                             de
hubert       Integration Agent                     de
kerstin      Schuldenberater                       de
luc          Verwalter                             de
melanie      Integrations-Assistent (Dienstleiter) fr
root         Verwalter                             de
============ ===================================== =======

&gt;&gt;&gt; from lino.utils import babel
&gt;&gt;&gt; babel.set_language(&#39;en&#39;)
&gt;&gt;&gt; print T.to_rst()
======== ========================== ========
Username User Profile               Language
======== ========================== ========
alicia   Integration Agent          de
caroline Newcomers consultant       de
charles  CBSS only                  de
elmar    Anonymous                  de
gerd     Administrator              de
hubert   Integration Agent          de
kerstin  Debts consultant           de
luc      Administrator              de
melanie  Integration Agent (Senior) fr
root     Administrator              de
======== ========================== ========
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="1109.html" title="20121109"
             >next</a> |</li>
        <li class="right" >
          <a href="1107.html" title="20121107"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2012</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2012/1108.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2012/1108.html">Online Link</a>
    </div>
  </body>
</html>