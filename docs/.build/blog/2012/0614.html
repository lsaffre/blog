<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20120614 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2012" href="index.html" />
    <link rel="next" title="20120615" href="0615.html" />
    <link rel="prev" title="20120613" href="0613.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0615.html" title="20120615"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0613.html" title="20120613"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2012</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20120614<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Eigentlich wollte ich heute weiter arbeiten am Ausdruck bzw. der Verwertung
des Resultats einer <code class="xref py py-class docutils literal"><span class="pre">Tx25</span></code>.</p>
<p>Aber weil es beim Testen relativ lästig war,
dass man nach jeder Änderung mehrmals klicken
muss um das Resultat zu sehen,
habe ich mir folgendes Script geschrieben:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">lino.modlib.cbss.models</span> <span class="kn">import</span> <span class="n">RetrieveTIGroupsRequests</span> <span class="k">as</span> <span class="n">Tx25</span>
<span class="kn">from</span> <span class="nn">lino.ui.console</span> <span class="kn">import</span> <span class="n">Console</span>
<span class="n">ui</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
<span class="n">ui</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">Tx25</span><span class="o">.</span><span class="n">print_action</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Also ich klicke sozusagen programmatisch auf den <cite>Drucken</cite>-Knopf
auf der Tx25 # 1.
Aufruf ist wie folgt:</p>
<div class="highlight-python"><div class="highlight"><pre>T:\data\luc\lino_local\dsbe&gt;python manage.py shell &lt; tx25.py
</pre></div>
</div>
<p>Der Output ist nicht besonders schön, weil die &#8220;&gt;&gt;&gt;&#8221; der interaktiven
<cite>shell</cite> stören:</p>
<div class="highlight-python"><div class="highlight"><pre>Python 2.7.1 (r271:86832, Nov 27 2010, 18:30:46) [MSC v.1500 32 bit (Intel)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
(InteractiveConsole)
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; INFO Starting Lino...
INFO Lino Site &#39;DSBE@armand&#39; started. Languages: de, fr. 232 actors.
INFO Using Lino 1.4.4, Django 1.5.dev17937, python-dateutil 1.5, Cheetah 2.4.4, OdfPy ODFPY/0.9.4, docutils 0.7, suds 0.
4.1, PyYaml 3.08, Appy 0.8.0 (2011/12/15 22:41), Python 2.7.1.
&gt;&gt;&gt; INFO AppyOdtBuildMethod Tx25 Request #1 -&gt; overwrite existing t:\data\luc\lino_local\dsbe\media\userdocs\appyodt\cbs
s.RetrieveTIGroupsRequest-1.odt.
INFO appy.pod render t:\hgwork\lino\lino\modlib\cbss\config\cbss\RetrieveTIGroupsRequest\Default.odt -&gt; t:\data\luc\lino
_local\dsbe\media\userdocs\appyodt\cbss.RetrieveTIGroupsRequest-1.odt (language=&#39;de&#39;,params={&#39;ooPort&#39;: 8100, &#39;pythonWith
UnoPath&#39;: &#39;C:\\PROGRA~1\\LIBREO~1.4\\program\\python.exe&#39;}
{&#39;open_url&#39;: &#39;/media/userdocs/appyodt/cbss.RetrieveTIGroupsRequest-1.odt&#39;, &#39;success&#39;: True}
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt;
</pre></div>
</div>
<p>Aber es funktioniert.
Da wir uns nicht im Web sondern in einer Console befinden, wird die
action response &#8216;open_url&#8217; mittels <code class="docutils literal"><span class="pre">os.startfile()</span></code> gestartet.
Cool!</p>
<p>Damit das funktionierte, musste ich dann doch einige subtile interne Änderungen machen:
Neues Modul <code class="xref py py-mod docutils literal"><span class="pre">lino.extjs</span></code>, und <code class="xref py py-mod docutils literal"><span class="pre">lino.ui.console</span></code>
ist komplett neu geschrieben (funktionierte sowieso schon lange nicht mehr).
Außerdem kamen ein paar Bugs (seit den gestrigen Änderungen)
beim Rendern gewisser Feldarten zum Vorschein.
Hier als Souvenir zwei der Fehlermeldungen, die heute waren:</p>
<div class="highlight-python"><div class="highlight"><pre>Error while evaluating the expression &quot;table(self.Result(ar))&quot; defined in the &quot;from&quot; part of a statement.
File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
File &quot;t:\hgwork\lino\lino\utils\appy_pod.py&quot;, line 279, in insert_table
columns = ar.ah.list_layout.main.columns
&lt;type &#39;exceptions.AttributeError&#39;&gt;: TableHandle instance has no attribute &#39;list_layout&#39;

Error while evaluating the expression &quot;table(ar)&quot; defined in the &quot;from&quot; part of a statement.
File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
File &quot;t:\hgwork\lino\lino\utils\appy_pod.py&quot;, line 452, in insert_table
value2cell(ar,i,fld,v,stylename,tc)
File &quot;t:\hgwork\lino\lino\utils\appy_pod.py&quot;, line 418, in value2cell
tc.addElement(p)
File &quot;l:\snapshots\odfpy-0.9.4\odf\element.py&quot;, line 363, in addElement
raise IllegalChild, &quot;&lt;%s&gt; is not allowed in &lt;%s&gt;&quot; % ( element.tagName, self.tagName)
&lt;class &#39;odf.element.IllegalChild&#39;&gt;: &lt;text:span&gt; is not allowed in &lt;table:table-cell&gt;
</pre></div>
</div>
<p>Und die eigentliche Arbeit (Ausdruck einer
Tx25) ist darüber für heute liegengeblieben. C&#8217;est la vie...</p>
<p>Noch schnell vor Feierabend ein neuer Management-Befehl
<a class="reference external" href="http://www.lino-framework.org/api/lino.management.commands.run.html#module-lino.management.commands.run" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">run</span></code></a>,
der ein lokales Skript wie unser <cite>tx25.py</cite> ausführt ohne die unschönen
Zwischenbemerkungen der interaktiven <cite>shell</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre>T:\data\luc\lino_local\dsbe&gt;python manage.py run tx25.py
INFO Starting Lino...
INFO Lino Site &#39;DSBE@armand&#39; started. Languages: de, fr. 232 actors.
INFO Using Lino 1.4.4, Django 1.5.dev17937, python-dateutil 1.5, Cheetah 2.4.4, OdfPy ODFPY/0.9.4, docutils 0.7, suds 0.
4.1, PyYaml 3.08, Appy 0.8.0 (2011/12/15 22:41), Python 2.7.1.
INFO AppyOdtBuildMethod Tx25 Request #1 -&gt; overwrite existing t:\data\luc\lino_local\dsbe\media\userdocs\appyodt\cbss.Re
trieveTIGroupsRequest-1.odt.
INFO appy.pod render t:\hgwork\lino\lino\modlib\cbss\config\cbss\RetrieveTIGroupsRequest\Default.odt -&gt; t:\data\luc\lino
_local\dsbe\media\userdocs\appyodt\cbss.RetrieveTIGroupsRequest-1.odt (language=&#39;de&#39;,params={&#39;ooPort&#39;: 8100, &#39;pythonWith
UnoPath&#39;: &#39;C:\\PROGRA~1\\LIBREO~1.4\\program\\python.exe&#39;}
</pre></div>
</div>
<p>Und dann doch noch schnell vorm Schlafengehen ausprobieren,
ob die eigentliche Arbeit nun besser geht.
Resultat: super!</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0615.html" title="20120615"
             >next</a> |</li>
        <li class="right" >
          <a href="0613.html" title="20120613"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2012</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2012/0614.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2012/0614.html">Online Link</a>
    </div>
  </body>
</html>