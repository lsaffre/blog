<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20120307 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2012" href="index.html" />
    <link rel="next" title="20120309" href="0309.html" />
    <link rel="prev" title="20120306" href="0306.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0309.html" title="20120309"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0306.html" title="20120306"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2012</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20120307<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="sellerie-und-mohren-nicht-notig">
<h2>Sellerie und Möhren nicht nötig<a class="headerlink" href="#sellerie-und-mohren-nicht-notig" title="Permalink to this headline">¶</a></h2>
<p>Ich hatte gestern ein wenig gesurft, gelesen und nachgedacht über die
Frage,
wie Lino mit langlaufenden Prozessen umgehen soll.
Die Idee ist, dass der Server dem Client auf manche Ajax-Calls
antworten kann &#8220;Das dauert was.
Hier hast du die Prozessnummer,
frag später nochmal nach, wie es gelaufen ist.&#8221;
<a class="reference external" href="https://github.com/lsaffre/lino/blob/master/docs/tickets/61">docs/tickets/61</a>.</p>
<p>Um das zu ermöglichen bräuchte es rein serverseitig
schon eine ganze Menge von Zutaten,
die technisch interessant und relativ gut dokumentiert,
aber eben auch recht komplex sind:</p>
<ul class="simple">
<li><a class="reference external" href="http://celeryproject.org">http://celeryproject.org</a></li>
<li><a class="reference external" href="http://ask.github.com/carrot/index.html">http://ask.github.com/carrot/index.html</a></li>
<li><a class="reference external" href="http://www.rabbitmq.com/how.html">http://www.rabbitmq.com/how.html</a></li>
</ul>
<p>Und nach einer Nacht entscheide ich &#8211;zumindest bis auf weiteres&#8211;:
Nein, diese ganze Suppe ist nicht nötig!
Ich setze den timeout aller Ajax-Calls auf 0 und basta.
Wem das drehende &#8220;Bitte warten&#8221; zu lang wird, der kann ja ein zweites
Lino-Fenster öffnen und dort parallel arbeiten.</p>
<p>Also einfach eine Codezeile in der <a class="reference external" href="http://www.lino-framework.org/ref/files.html#xfile-linolib.js" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">linolib.js</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre>Ext.Ajax.timeout = 15 * 60 * 1000; /* fifteen minutes */
</pre></div>
</div>
<p>Um das zu probieren, mach ich ein Release auf Jana. Wenn ich auf der
Kontrollliste Klienten das Feld <cite>nur aktive am</cite> auf leer setze,
dann dauert das Erstellen (auf dem Server) der ersten Bildschirmseite
knapp anderthalb Minuten:</p>
<div class="highlight-python"><div class="highlight"><pre>201203-07 07:48:57 INFO models : Building ClientsTest data rows...
201203-07 07:50:13 INFO models : Building ClientsTest data rows: done
</pre></div>
</div>
<p>Und voilà. Der Client wartet nun geduldig wie ein Lamm,
bis die Antwort kommt.
Genau das wollte ich.
Gefällt mir.
Also Sellerie und Möhren brauchen wir vorerst nicht!</p>
</div>
<div class="section" id="noch-ein-xmlsyntaxerror">
<h2>Noch ein XMLSyntaxError<a class="headerlink" href="#noch-ein-xmlsyntaxerror" title="Permalink to this headline">¶</a></h2>
<p>Ups, da kommt im Fenster <code class="xref py py-class docutils literal"><span class="pre">lino.About</span></code> noch ein Bug,
der durch die Umstellung von xmlgen nach lxml verursacht wird:</p>
<div class="highlight-python"><div class="highlight"><pre>XMLSyntaxError
Opening and ending tag mismatch: CourseProvider line 5 and span, line 8, column 12

TRACEBACK:
  File &quot;/var/snapshots/django/django/core/handlers/base.py&quot;, line 111, in get_response
    response = callback(request, *callback_args, **callback_kwargs)

  File &quot;/usr/local/django/dsbe_eupen/using/lino/lino/ui/extjs3/ext_ui.py&quot;, line 1743, in api_element_view
    elem = ar.create_instance()

  File &quot;/usr/local/django/dsbe_eupen/using/lino/lino/core/actions.py&quot;, line 464, in create_instance
    obj = self.report.create_instance(self,**kw)

  File &quot;/usr/local/django/dsbe_eupen/using/lino/lino/core/actors.py&quot;, line 639, in create_instance
    kw = req.ah.store.row2dict(req,obj)

  File &quot;/usr/local/django/dsbe_eupen/using/lino/lino/ui/extjs3/ext_store.py&quot;, line 1002, in row2dict
    v = fld.full_value_from_object(ar,row)

  File &quot;/usr/local/django/dsbe_eupen/using/lino/lino/ui/extjs3/ext_store.py&quot;, line 621, in full_value_from_object
    return unbound_meth(obj,request)

  File &quot;/usr/local/django/dsbe_eupen/using/lino/lino/utils/tables.py&quot;, line 830, in meth
    s = etree.tostring(ui.table2xhtml(ar))

  File &quot;/usr/local/django/dsbe_eupen/using/lino/lino/ui/extjs3/ext_ui.py&quot;, line 2610, in table2xhtml
    return html.TABLE(*list(f()),cellspacing=&quot;3px&quot;,bgcolor=&quot;#ffffff&quot;, width=&quot;100%&quot;)

  File &quot;/usr/local/django/dsbe_eupen/using/lino/lino/ui/extjs3/ext_ui.py&quot;, line 2598, in f
    cells = [TD(x) for x in ar.ah.store.row2html(ar,fields,row,sums)]

  File &quot;/usr/local/django/dsbe_eupen/using/lino/lino/ui/extjs3/ext_ui.py&quot;, line 2583, in TD
    x = etree.XML(x)

  File &quot;lxml.etree.pyx&quot;, line 2512, in lxml.etree.XML (src/lxml/lxml.etree.c:48421)

  File &quot;parser.pxi&quot;, line 1545, in lxml.etree._parseMemoryDocument (src/lxml/lxml.etree.c:72245)

  File &quot;parser.pxi&quot;, line 1417, in lxml.etree._parseDoc (src/lxml/lxml.etree.c:71041)

  File &quot;parser.pxi&quot;, line 898, in lxml.etree._BaseParser._parseUnicodeDoc (src/lxml/lxml.etree.c:67581)

  File &quot;parser.pxi&quot;, line 539, in lxml.etree._ParserContext._handleParseResultDoc (src/lxml/lxml.etree.c:64257)

  File &quot;parser.pxi&quot;, line 625, in lxml.etree._handleParseResult (src/lxml/lxml.etree.c:65178)

  File &quot;parser.pxi&quot;, line 565, in lxml.etree._raiseParseError (src/lxml/lxml.etree.c:64521)
</pre></div>
</div>
<p>Und in der Logdatei steht:</p>
<blockquote>
<div>201203-07 07:43:20 WARNING ext_ui : Invalid XML value u&#8217;&lt;span&gt;n    Ein konkreter Kurs, der an einem bestimmten Datum beginnt.n    Fxfcr jeden Kurs muss ein entsprechendes Angebot existieren, n    das u.A. den <code class="xref py py-class docutils literal"><span class="pre">Kursinhalt</span></code> n    und <code class="xref py py-class docutils literal"><span class="pre">Kursanbieter</span></code> n    detailliert. Also selbst fxfcr einen einmalig stattfindenden n    Kurs muss ein Angebot erstellt werden.n    &lt;/span&gt;&#8217;</div></blockquote>
<p>Aha. Ja, das kommt davon, wenn man alles so genau nimmt.
Genau genommen ist es ein Zufall, dass diese Zellen bisher einigermaßen
korrekt angezeigt wurden.</p>
<p>Eigentlich müsste ich die docstrings vorher durch
<a class="reference external" href="http://www.lino-framework.org/api/lino.utils.restify.html#lino.utils.restify.restify" title="(in Lino v1.6)"><code class="xref py py-func docutils literal"><span class="pre">restify</span></code></a> laufen lassen...
mal probieren: genau, damit geht es. Auch wenn restify sich natürlich
über
&#8220;Unknown interpreted text role &#8220;term&#8221;.&#8221; und
&#8220;Unknown interpreted text role &#8220;class&#8221;.&#8221; beklagt.
Das ist ein fundamentaleres Projekt:
die Sphinx-Dokumentation zum online-Konsultieren anbieten...
aber das lass ich für später.</p>
<p>Schade, dass man in
<code class="xref py py-class docutils literal"><span class="pre">lino.Models</span></code>
nicht per Doppelklick
die Felder eines Models ansehen kann...
Neue Tabelle <code class="xref py py-class docutils literal"><span class="pre">lino.FieldsByModel</span></code>.
Aber weil <code class="xref py py-class docutils literal"><span class="pre">lino.Models</span></code> eine VirtualTable
ist, geht das momentan noch nicht.
Das ist ungerecht! Auch virtuelle Tabekllen sollen
Details haben können.
Ein Hindernis ist die Tatsache, dass die rows einer VirtualTable
keine id haben und deshalb vom GridStore als phantom rows behandelt werden.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0309.html" title="20120309"
             >next</a> |</li>
        <li class="right" >
          <a href="0306.html" title="20120306"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2012</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2012/0307.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2012/0307.html">Online Link</a>
    </div>
  </body>
</html>