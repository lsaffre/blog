<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20120517 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2012" href="index.html" />
    <link rel="next" title="20120518" href="0518.html" />
    <link rel="prev" title="20120516" href="0516.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0518.html" title="20120518"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0516.html" title="20120516"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2012</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20120517<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Ha, das war lustig!
<code class="xref py py-meth docutils literal"><span class="pre">lino.ui.extjs3.ext_ui.ExtUI.build_site_cache()</span></code>
generiert die lino*.js-Dateien jetzt korrekt so,
dass unnötige Elemente gar nicht erst drin stehen.</p>
<p>Und gestern schrieb ich ja:</p>
<blockquote>
<div>It would be theoretically more &#8220;logical&#8221; to also use
<code class="xref py py-meth docutils literal"><span class="pre">lino.core.actors.Actor.get_permission()</span></code>
for deciding whether a menu command should be created or not.
Lino doesn&#8217;t currently do this because it feels more &#8220;sane&#8221; to do
these decicions in the <cite>setup_XXX_menu</cite> functions.</div></blockquote>
<p>Aber jetzt wo auch das Menü schon einmalig beim Server-Start generiert
werden kann statt bei jedem request (tut es zwar noch nicht, aber das
ist jetzt möglich), revidiere ich meine gestrige Meinung. Habe z.B. begonnen,
dass der Demo-Benutzer Caroline die Quicklinks &#8220;Meine Klienten&#8221;, &#8220;Meine VSE&#8221;
und &#8220;Meine Art-60-7-Konventionen&#8221; nicht mehr sieht.
Die <cite>lino_caroline_*.js</cite> sind dadurch schon von 2 auf 1,5 MB geschrumpft.</p>
<p>Bevor ich jetzt noch die Test-Suite aufräume, mach ich ein Checkin:
<a class="reference external" href="http://code.google.com/p/lino/source/detail?r=7ab4496fb3d9">Checkin 7ab4496fb3d9</a>.</p>
<p>Für die Test-Suite gibt es noch ein Detail zu beachten:
Lokale Fixtures dürfen zum Testen eigentlich nicht geladen werden.
Wie könnte ich das automatisch abstellen?
Momentan sehe ich noch keine Lösung. En addendant gilt: falls lokale
fixtures existieren sollte man das Verzeichnis kurzfristig umbenennen
oder sonstwie deaktivieren, wenn man <cite>manage.py test</cite> startet.</p>
<p>Folgende Demo-Benutzer sollten in <cite>lino.apps.pcsw</cite> existieren:</p>
<ul class="simple">
<li>Der bisherige Benutzer &#8220;user&#8221; kommt raus.</li>
<li>root : Experte für alle Module</li>
<li>luc : profile=&#8217;root&#8217;</li>
<li>melanie : Manager integ</li>
<li>hubert : Einfacher Benutzer integ</li>
<li>alicia : profile=&#8217;hubert&#8217;</li>
<li>caroline : Einfacher Benutzer newcomers</li>
<li>kerstin : Einfacher Benutzer debts</li>
</ul>
<p>Oder anders:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.lino-framework.org/api/lino.modlib.users.fixtures.demo.html#module-lino.modlib.users.fixtures.demo" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.users.fixtures.demo</span></code></a> macht die Benutzer <cite>root</cite> und <cite>luc</cite></li>
<li><code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.newcomers.fixtures.demo</span></code> macht den Benutzer <cite>caroline</cite></li>
<li><code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.debts.fixtures.demo</span></code> macht den Benutzer <cite>kerstin</cite></li>
<li><code class="xref py py-mod docutils literal"><span class="pre">lino.apps.pcsw.fixtures.demo</span></code> macht die Benutzer <cite>melanie</cite> , <cite>hubert</cite> und <cite>alicia</cite>.</li>
</ul>
<p>Das ist gut. Benutzer <cite>kerstin</cite>, <cite>root</cite> und <cite>luc</cite> sehen
einen Reiter &#8220;Budgets&#8221; im Detail einer Person, die anderen nicht.</p>
<p>Jetzt haben wir noch ein &#8220;kleines&#8221; Problem: der Reiter &#8220;Verträge&#8221;
enthält zwei GridPanels, die nur für <cite>integ</cite>-Benutzer sichtbar sind,
also nicht z.B. für kerstin. Und somit ist dieser Reiter bei kerstin jetzt leer.
Er sollte aber nicht nur leer sein, sondern ganz verschwinden.
Und zwar automatisch.
Ein Container, der nichts Sichtbares enthält, soll ebenfalls unsichtbar werden.
Provisorische Lösung: <code class="xref py py-meth docutils literal"><span class="pre">lino.ui.extjs3.ext_elems.Panel.get_view_permission()</span></code>
macht einen Vorschau-Loop durch seine Elemente. Wenn kein einziges sichtbar
ist, wird auch das Panel selbst unsichtbar.
Das ist ein bischen Ressourcenverschwendung, aber immerhin nur beim Generieren
der <code class="xref std std-xfile docutils literal"><span class="pre">lino*.js</span></code>.
Cool. Funktioniert sogar.</p>
<p>Optimaler wäre wahrscheinlich, dass (1) ext_store aus dem UI rauskommt und (2)
die LayoutHandles und TableHandles gar nicht mehr aufbewahrt werden, sondern
pro Benutzerprofil instanziert und nach dem Generieren weggeworfen werden:
die sind nämlich gar nicht nötig während des laufenden Betriebs. Zu überprüfen.
Nicht so dringend.</p>
<p>Auch der Reiter &#8220;Stellenanfragen&#8221;
(der lediglich <code class="xref py py-class docutils literal"><span class="pre">lino.modlib.jobs.models.CandidaturesByPerson</span></code> enthält)
ist bei Kerstin jetzt verschwunden.
Einfach nur, indem ich <code class="xref py py-class docutils literal"><span class="pre">lino.modlib.jobs.models.Candidatures</span></code>
jetzt von <code class="xref py py-class docutils literal"><span class="pre">lino.apps.pcsw.models.IntegTable</span></code> erben lasse.</p>
<p>Dann noch etwas, das mir zwischendurch auffiel:
<code class="xref py py-class docutils literal"><span class="pre">lino.modlib.debts.models.Actor</span></code> braucht ein Feld <cite>partner</cite>,
damit man bei der manuellen Eingabe der Akteure eines Budgets
zunächst eine Person auswählen kann.
Was noch fehlt, ist eine Möglichkeit, um in der (normalerweise leeren)
Auswahlliste für <cite>Actor.sub_budget</cite> dann ein leeres Budget erstellen zu
können.</p>
<p>Unter <code class="xref py py-class docutils literal"><span class="pre">lino.modlib.debts.models.BudgetDetail</span></code>
habe ich mal ein paar Screenshots platziert.</p>
<p><a class="reference external" href="http://code.google.com/p/lino/source/detail?r=54bbbb071079">Checkin 54bbbb071079</a>.</p>
<p>Abends kam mir dann noch die spontane Erkenntnis,
dass unsere geniale, super-flexible Struktur
mit den verschachtelbaren Budgets für die Benutzer zumindest
momentan noch nicht gut ist. Die Leute sind gewohnt,
die Beträge der Aktoren in zwei Kolonnen nebeneinander zu haben.
Und zwar auch schon bei der Eingabe.
Ich glaube nicht, dass die sich mit der momentanen Methode
anfreunden werden.</p>
<p>Also die Version von heute nachmittag in die <cite>lino.sandbox</cite>
rein und die neue Idee ausprobiert.
Und nach nur anderthalb Stunden funktioniert es!
Oder zumindest fast: Am Ausdruck und der Zusammenfassung
muss ich noch was spielen. Aber jetzt gehe ich erstmal schlafen.</p>
<p><a class="reference external" href="http://code.google.com/p/lino/source/detail?r=10c18c5721f3">Checkin 10c18c5721f3</a>.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0518.html" title="20120518"
             >next</a> |</li>
        <li class="right" >
          <a href="0516.html" title="20120516"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2012</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2012/0517.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2012/0517.html">Online Link</a>
    </div>
  </body>
</html>