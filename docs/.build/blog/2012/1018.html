<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20121018 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2012" href="index.html" />
    <link rel="next" title="20121020" href="1020.html" />
    <link rel="prev" title="20121017" href="1017.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="1020.html" title="20121020"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="1017.html" title="20121017"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2012</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20121018<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="hilfetexte">
<h2>Hilfetexte<a class="headerlink" href="#hilfetexte" title="Permalink to this headline">¶</a></h2>
<p>Momentan ist es nicht möglich, die Tooltips
von Parameterfeldern zu bearbeiten.</p>
<p>Die Hilfetexte (Tooltips) müssten insgesamt noch etwas verbessert
werden:</p>
<ul>
<li><p class="first">HelpText.label und HelpText.text sollten Babelfelder werden</p>
</li>
<li><dl class="first docutils">
<dt>HelpText.type und HelpTextType:</dt>
<dd><p class="first last">dbfield
action
param_field</p>
</dd>
</dl>
</li>
<li><p class="first">HelpText.actor statt HelpText.content_type</p>
</li>
</ul>
<p>Das ist aber eigentlich nicht so dringend. Als pragmatische Lösung
habe ich begonnen, die deutschen Hilfetexte
direkt im Sourcecode einzugeben.</p>
<p>renamed <cite>is_deprecated</cite> to <cite>is_obsolete</cite></p>
</div>
<div class="section" id="allow-cascaded-delete">
<h2>allow_cascaded_delete<a class="headerlink" href="#allow-cascaded-delete" title="Permalink to this headline">¶</a></h2>
<p><code class="xref py py-attr docutils literal"><span class="pre">allow_cascaded_delete</span> <span class="pre">&lt;lino.core.Model.allow_cascaded_delete</span></code>
is no longer a boolean but a list.</p>
<p>Bisher konnte man nur sagen Ja oder Nein, aber das war zu einfach gedacht.
Zum Beispiel Akteure eines Budgets: die sollen automatisch gelöscht werden,
wenn das Budget gelöscht wird. Aber nicht, wenn der Partner gelöscht wird.
Aber bisher wurden sie dadurch auch automatisch wenn der Partner gelöscht
wurde.
Einen Partner zu löschen, der als Akteur in einem Budget verwendet wird,
<em>das</em> darf Lino <em>nicht</em> erlauben.</p>
<p>Begleitungen hatten
<code class="xref py py-attr docutils literal"><span class="pre">allow_cascaded_delete</span> <span class="pre">&lt;lino.core.Model.allow_cascaded_delete</span></code>
noch nicht gesetzt. Lino meldete fälschlicherweise Dinge wie
&#8220;Kann Kient X nicht löschen, weil 1 Begleitungen darauf verweisen.&#8221;</p>
</div>
<div class="section" id="miscellaneous">
<h2>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Discovered and fixed a little bug:
editing was <em>not</em> disabled when
<a class="reference external" href="http://www.lino-framework.org/api/lino.core.actors.html#lino.core.actors.Actor.editable" title="(in Lino v1.6)"><code class="xref py py-attr docutils literal"><span class="pre">lino.core.actors.Actor.editable</span></code></a> was set to True.</li>
<li>Außerdem ein Bug, der wahrscheinlich schon länger da war:
Wenn man nach [Neu] in contacts/Partners das Insert-Fenster
bestätigte, kam &#8220;contacts_partner.created may not be NULL&#8221;.</li>
</ul>
</div>
<div class="section" id="changes-and-mti">
<h2>changes and mti<a class="headerlink" href="#changes-and-mti" title="Permalink to this headline">¶</a></h2>
<p>Mir ist aufgefallen, dass Änderungen noch nicht funktionierten,
wenn man sie auf mehreren Ebenen einer MTI-Familie haben will.
Also z.B. nicht nur für Klienten, sondern für alle Partner.
Und wir wollen das im Lino für ÖSHZ, wo watch_tim
auch immer wieder mal Partnermetamorphosen durchführt
(Client becomes Partner, Person becomes Company etc.).</p>
<p>Resultat: einige intere Änderungen, und die Konfiguration sieht jetzt so aus:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">on_site_startup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">contacts</span><span class="o">.</span><span class="n">Partner</span><span class="o">.</span><span class="n">watch_changes</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">contacts</span><span class="o">.</span><span class="n">Person</span><span class="o">.</span><span class="n">watch_changes</span><span class="p">(</span><span class="n">master_key</span><span class="o">=</span><span class="s">&#39;partner_ptr&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">contacts</span><span class="o">.</span><span class="n">Company</span><span class="o">.</span><span class="n">watch_changes</span><span class="p">(</span><span class="n">master_key</span><span class="o">=</span><span class="s">&#39;partner_ptr&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">pcsw</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">watch_changes</span><span class="p">(</span><span class="n">master_key</span><span class="o">=</span><span class="s">&#39;partner_ptr&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">pcsw</span><span class="o">.</span><span class="n">Coaching</span><span class="o">.</span><span class="n">watch_changes</span><span class="p">(</span><span class="n">master_key</span><span class="o">=</span><span class="s">&#39;client__partner_ptr&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">pcsw</span><span class="o">.</span><span class="n">ClientContact</span><span class="o">.</span><span class="n">watch_changes</span><span class="p">(</span><span class="n">master_key</span><span class="o">=</span><span class="s">&#39;client__partner_ptr&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">Candidature</span><span class="o">.</span><span class="n">watch_changes</span><span class="p">(</span><span class="n">master_key</span><span class="o">=</span><span class="s">&#39;person__partner_ptr&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Die Tabelle ChangesByMaster steht jetzt nicht mehr im Reiter &#8220;Chronik&#8221; eines Klienten,
sondern in einen eigenen Reiter &#8220;Änderungen&#8221; eines Partners.
Das ist logisch: die Änderungen eines Klienten machen nur Sinn, wenn man auch
eventuelle Metamorphosen des Partners mit betrachtet.</p>
<p>Das neue System funktioniert auch schon fast.</p>
<p>TODO:</p>
<ul class="simple">
<li>mti.EnableChild loggt noch nichts.</li>
<li>weiter mit watch_tim, der ja ebenfalls jetzt über <cite>Changes</cite> loggen soll.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="1020.html" title="20121020"
             >next</a> |</li>
        <li class="right" >
          <a href="1017.html" title="20121017"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2012</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2012/1018.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2012/1018.html">Online Link</a>
    </div>
  </body>
</html>