<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Sunday, August 31, 2014 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2014" href="index.html" />
    <link rel="next" title="Monday, September 1, 2014" href="0901.html" />
    <link rel="prev" title="Saturday, August 30, 2014" href="0830.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0901.html" title="Monday, September 1, 2014"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0830.html" title="Saturday, August 30, 2014"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2014</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sunday-august-31-2014">
<h1>Sunday, August 31, 2014<a class="headerlink" href="#sunday-august-31-2014" title="Permalink to this headline">¶</a></h1>
<div class="section" id="refreshing-the-home-page">
<h2>Refreshing the home page<a class="headerlink" href="#refreshing-the-home-page" title="Permalink to this headline">¶</a></h2>
<p>In the middle of the night I found a workaround for yesterday&#8217;s
problem:</p>
<p>The explanation is as follows: when an Ext.Window is being
instantiated, then this object is somehow &#8220;linked&#8221; to &#8220;the current DOM
element&#8221;. When a <cite>WindowAction.run()</cite> is called from the menu, then it
will be linked to the DOM element of the menu item. And in our case it
is linked to some element which will later be replaced by new html
chunk.  For example, yesterday&#8217;s problem works only for windows which
have been instantiated by a click on such a symbol.</p>
<p>The workaround is to add the following code to <cite>Lino.Viewport.refresh</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre>{% for T in settings.SITE.get_admin_main_items() %}
     if (Lino.{{T.default_action.full_name()}}) {
         Lino.{{T.default_action.full_name()}}.window = null;
     }
{% endfor %}
</pre></div>
</div>
<p>That is, we delete the cached <cite>Ext.Window</cite> instance for those actions
that are callable from the <a class="reference external" href="http://www.lino-framework.org/ref/files.html#xfile-admin_main.html" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">admin_main.html</span></code></a>.</p>
<p>This workaround also required us to remove the <cite>ar</cite> argument from the
signature of <a class="reference external" href="http://www.lino-framework.org/api/lino.core.site.html#lino.core.site.Site.get_admin_main_items" title="(in Lino v1.6)"><code class="xref py py-meth docutils literal"><span class="pre">lino.core.site.Site.get_admin_main_items()</span></code></a>.</p>
<p>Not very elegant, but it works.</p>
<p>Checkin and update of the <a class="reference external" href="http://www.lino-framework.org/demos.html#demos" title="(in Lino v1.6)"><span>Demo sites</span></a>.</p>
</div>
<div class="section" id="removed-admin-item-limit-from-admin-main-html">
<h2>Removed <cite>admin_item_limit</cite> from <a class="reference external" href="http://www.lino-framework.org/ref/files.html#xfile-admin_main.html" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">admin_main.html</span></code></a><a class="headerlink" href="#removed-admin-item-limit-from-admin-main-html" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://www.lino-framework.org/marked_changes.html#mustconfig" title="(in Lino v1.6)"><span>Change in local config</span></a>:
How to configure how many rows Lino should display in
<a class="reference external" href="http://www.lino-framework.org/ref/files.html#xfile-admin_main.html" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">admin_main.html</span></code></a> for the tables returned by
<a class="reference external" href="http://www.lino-framework.org/api/lino.core.site.html#lino.core.site.Site.get_admin_main_items" title="(in Lino v1.6)"><code class="xref py py-meth docutils literal"><span class="pre">lino.core.site.Site.get_admin_main_items()</span></code></a>?</p>
<p>Until now I had a parameter <cite>admin_item_limit</cite> defined as a template
variable:</p>
<div class="highlight-python"><div class="highlight"><pre>{% if not admin_item_limit %}
{% set admin_item_limit = 5 %}
{% endif %}
</pre></div>
</div>
<p>I removed this because it was not comfortable (not &#8220;the Lino way&#8221;).
Configuration is now done by setting
<code class="xref py py-attr docutils literal"><span class="pre">dd.AbstractTable.preview_limit</span></code>.</p>
</div>
<div class="section" id="id1">
<h2>Refreshing the home page<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>I discovered that the workaround which I found tonight doesn&#8217;t always
work. E.g. for quick links. So my search had to continue.</p>
<p>And I found another workaround which is a little bit less hackerish
than the first one: <cite>Lino.WindowAction.getWindow()</cite> now calls the
cached window object&#8217;s <cite>getBox()</cite> method and checks whether it
specifies a width of 0. If the width is 0, then we know that the
window has fallen into this strange kind of hiddenness and that we
need to instantiate a new one.</p>
<p>Checkin and update of the online <a class="reference external" href="http://www.lino-framework.org/demos.html#demos" title="(in Lino v1.6)"><span>Demo sites</span></a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0901.html" title="Monday, September 1, 2014"
             >next</a> |</li>
        <li class="right" >
          <a href="0830.html" title="Saturday, August 30, 2014"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2014</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2014/0831.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2014/0831.html">Online Link</a>
    </div>
  </body>
</html>