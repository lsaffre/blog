<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Monday, May 5, 2014 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2014" href="index.html" />
    <link rel="next" title="Tuesday, May 6, 2014" href="0506.html" />
    <link rel="prev" title="Thursday, May 1, 2014" href="0501.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0506.html" title="Tuesday, May 6, 2014"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0501.html" title="Thursday, May 1, 2014"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2014</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="monday-may-5-2014">
<h1>Monday, May 5, 2014<a class="headerlink" href="#monday-may-5-2014" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-actions-api-needs-a-show-record-method">
<h2>The actions API needs a <cite>show_record</cite> method<a class="headerlink" href="#the-actions-api-needs-a-show-record-method" title="Permalink to this headline">¶</a></h2>
<p>(Sorry, the following isn&#8217;t very clear even to me. Don&#8217;t worry if you
can&#8217;t seen to follow.)</p>
<p>This weekend I tried to solve the following issue:</p>
<ul class="simple">
<li>Summary panels don&#8217;t get refreshed, e.g. when I add a new upload
then I must click the Refresh button in order to have the summary
panel updated.</li>
</ul>
<p>Which turned out to be surprisingly hard, maybe even impossible with
the current actions API.  I started to understand more about the
actions API.  The first implementation of the (customizable)
SubmitInsert method is still too specific, we need to get it more
abstract. For example it is not the <cite>SubmitInsert</cite> action who should
decide whether we can send a full <cite>data_record</cite> or must reduce the
answer to a <cite>record_id</cite>. Functionally these two responses mean the
same: they ask the client to &#8220;show this record in a detail window&#8221;.
But in certain AJAX contexts (when uploading files) it is not possible
to encode a whole record. There is a technical reason, some encoding
problem, I don&#8217;t even remember the details. So this decision should
clearly not be responsibility of any application code. We need a
<cite>show_record</cite> method for ActionRequest to encapsulate this.</p>
<p>Another thing that I tried to introduce is the &#8220;editing
mode&#8221;. Meanwhile I think that this is also too technical for
application code. An &#8220;editing mode&#8221; is technical stuff. Action code
should never worry about such things.</p>
<p>We then have the <cite>stay_in_grid</cite> option. This is clearly application
responsibility. It is the application developper who says whether a
given table (which has a detail layout) prefers to open that detail
after inserting a new record or not. <cite>stay_in_grid</cite> is rather
exceptional. One use case is the <cite>MedicalUploadsByClient</cite> table. This
table <em>does</em> have a <cite>detail_layout</cite> but does <em>not</em> want to display a
detail of each new upload. The detail window should open only &#8220;when
explicitely asked&#8221;. The concrete implementation of this option must
remain up to the user interface.</p>
<p>So our API needs another change...</p>
<p>Yes, a SubmitInsert action should return detailed information about
the record that has been created.</p>
<p>When i click the &#8220;+&#8221; button in a <cite>MedicalUploadsByClient</cite> summary,
this will run the Javascript implementation of the <cite>insert</cite> action,
which opens the <cite>MedicalUploadsByClient.insertPanel</cite>. When the user
then clicks OK in that window, the current SubmitInsert action returns
a <cite>data_record</cite>, yes, but in that context we don&#8217;t want to use that
information.</p>
<p>Another challenge: The SubmitAction knows that it is to be called from
an InsertRow action. InsertRow is a windowed action (<cite>opens_a_window</cite>
is True): it opens the Insert window. And &#8220;of course&#8221; this window
should get closed when <cite>SubmitAction</cite> returns successfully.  Question:
should <cite>SubmitAction</cite> explicitely set <cite>close_window</cite> or not?  Let&#8217;s
say yes.  But then how to handle the special case which happens when
the user presses F2 on the phantom record of a grid (and then confirms
cell editing)? Lino.GridPanel currently translates this to a call to
<cite>SubmitInsert</cite>. But it is a special context since here we have no
insert window opened.</p>
<p>Checkin at 15:05 : the new vision seems usable...</p>
<p>... there are still some details to fix. For example:</p>
<ul class="simple">
<li>open a GridPanel &#8211;&gt; Double-click on a row &#8211;&gt; change some value and
save &#8211;&gt; close the detail window</li>
<li>Now I must click twice on the close button of the GridPanel in order
to have it disappear</li>
</ul>
<p>But before tidying up these details I decided to do another dirty
work: make the DeleteSelected action customizable.</p>
<p>This wasn&#8217;t so hard. And now the confirmation message before deleting
records is more clear because it lists the records to be deleted.</p>
<p>I am rather satisfied because these were some dirty works that had
been waiting since a long time.  And funny but true: the summary
panels still don&#8217;t get refreshed...</p>
<p>Checkin wegen Feierabend.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0506.html" title="Tuesday, May 6, 2014"
             >next</a> |</li>
        <li class="right" >
          <a href="0501.html" title="Thursday, May 1, 2014"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2014</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2014/0505.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2014/0505.html">Online Link</a>
    </div>
  </body>
</html>