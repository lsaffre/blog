<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20110211 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2011" href="index.html" />
    <link rel="next" title="20110212" href="0212.html" />
    <link rel="prev" title="20110208" href="0208.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0212.html" title="20110212"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0208.html" title="20110208"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2011</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20110211<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="bitte-warten">
<h2>Bitte warten...<a class="headerlink" href="#bitte-warten" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Alle GridPanels benutzen jetzt ein Ext.LoadMask, das die Grid
durch einen Hinweis &#8220;Bitte warten...&#8221; verdeckt, solange sie am laden
ist.</p>
<p>Das ist einerseits eine wichtige Info,
aber sorgt andererseits für relativ viel &#8220;Action&#8221; am Bildschirm.</p>
<p>Besser wäre vielleicht ein einziges LoadMask für alle Grids...
Oder einfach nur ein unauffälliges &#8220;Purzelmännchen&#8221;, z.B. dass der
Refresh-Button des FormPanels inactive bleibt solange nicht alle
Grids geladen sind.</p>
</li>
<li><p class="first">Ich habe begonnen, die <a class="reference external" href="http://www.lino-framework.org/ref/files.html#xfile-lino.js" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">lino.js</span></code></a> zu übersetzen.
Dazu benutze ich einen Trick, den ich ganz allein erfunden habe:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">LINOLIB_MESSAGES</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">tpl</span> <span class="o">=</span> <span class="n">CheetahTemplate</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mytranslate</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">LINOLIB_MESSAGES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">tpl</span><span class="o">.</span><span class="n">_</span> <span class="o">=</span> <span class="n">mytranslate</span>
</pre></div>
</div>
<p>generiere ich die dort verwendeten <cite>_</cite>-Aufrufe in eine
Datei <code class="file docutils literal"><span class="pre">lino.ui.extjs.dummy_messages.py</span></code>.
TODO:
Das ist eigentlich nur auf dem Development Server sinnvoll.</p>
</li>
<li><p class="first">Neues Modul <a class="reference external" href="http://www.lino-framework.org/api/lino.utils.jscompressor.html#module-lino.utils.jscompressor" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.utils.jscompressor</span></code></a>.
Das ist ein JS-Kompressor, den Michael Palmer 2006 als Recipe auf
<a class="reference external" href="http://code.activestate.com/recipes/496882/">http://code.activestate.com/recipes/496882/</a>
gepostet hat.</p>
<p>Funktioniert.</p>
<p>Aber ist erstens langsam (was nicht sehr schlimm ist,
weil das nur einmal nach den Server-Restart läuft),
und zweitens verkleinert er die <a class="reference external" href="http://www.lino-framework.org/ref/files.html#xfile-lino.js" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">lino.js</span></code></a> nur von
1.680.892 auf 1.456.788 Bytes.
Ich hatte mehr erhofft...</p>
</li>
</ul>
<p>Also die beiden folgenden Punkte betrachte ich bis auf Weiteres
als abgeschlossen:</p>
<ol class="arabic simple">
<li>In Suchliste anzeigen, wann er am Suchen ist.</li>
<li>Ext.LoadMask nutzen:
<a class="reference external" href="http://www.sencha.com/forum/showthread.php?64420-how-to-show-a-wait-message-while-calling-store-load">http://www.sencha.com/forum/showthread.php?64420-how-to-show-a-wait-message-while-calling-store-load</a></li>
</ol>
</div>
<div class="section" id="check-in-20110211">
<h2>Check-in 20110211<a class="headerlink" href="#check-in-20110211" title="Permalink to this headline">¶</a></h2>
<p>Zwecks Zwischenrelease in Eupen</p>
</div>
<div class="section" id="comboboxen-jetzt-ohne-typeahead">
<h2>Comboboxen jetzt ohne typeAhead<a class="headerlink" href="#comboboxen-jetzt-ohne-typeahead" title="Permalink to this headline">¶</a></h2>
<p>Hier noch ein Punkt behoben:</p>
<ol class="arabic simple">
<li>Comboboxen : wenn man z.B. beim Auswählen der Muttersprache
einer Person langsam d, e, u tippte, dann kamen verwirrende Effekte.</li>
</ol>
<p>Das kam durch den Konfigurationsparameter <cite>typeAhead</cite> des <a class="reference external" href="http://www.sencha.com/deploy/dev/docs/?class=Ext.PagingToolbar">Ext.PagingToolbar</a>.</p>
</div>
<div class="section" id="ubersetzungen-in-der-lino-js">
<h2>Übersetzungen in der <a class="reference external" href="http://www.lino-framework.org/ref/files.html#xfile-lino.js" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">lino.js</span></code></a><a class="headerlink" href="#ubersetzungen-in-der-lino-js" title="Permalink to this headline">¶</a></h2>
<p>Eine weitere Serie von Textfragmenten in der <a class="reference external" href="http://www.lino-framework.org/ref/files.html#xfile-lino.js" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">lino.js</span></code></a>
ist jetzt ebenfalls ins Deutsche übersetzt.
Das ist seit heute morgen möglich.</p>
</div>
<div class="section" id="keine-doppelten-ajax-calls-mehr">
<h2>Keine doppelten AJAX-Calls mehr<a class="headerlink" href="#keine-doppelten-ajax-calls-mehr" title="Permalink to this headline">¶</a></h2>
<p>Und auch der folgende Punkt ist m.E. jetzt fertig:</p>
<ol class="arabic simple">
<li>Main-Grids könnten mit <cite>autoHeight=true</cite> arbeiten. Dadurch würde der zweite Ajax-call unnötig.
autoHeight resizes the height to show all records.</li>
</ol>
<p>Ich benutze nicht wie damals geplant <cite>autoHeight=true</cite>
(in einem Ext.Window macht das wenig Sinn),
sondern setze <cite>lino.reports.Report.page_length</cite> auf 30,
das ist wahrscheinlich das Maximum, das auf eine Bildschirmseite passt.
Und wenn die 30 Records nicht draufpassen,
macht die Grid einen vertikalen Scrollbar.
Und in <a class="reference external" href="http://www.lino-framework.org/ref/javascript.html#Lino.WindowWrapper.show" title="(in Lino v1.6)"><code class="xref js js-func docutils literal"><span class="pre">Lino.WindowWrapper.show()</span></code></a> ruft er jetzt ein refresh()
(das war bisher nicht nötig, weil wir das resize-Event abfragten,
was wir jetzt nicht mehr tun).</p>
<p>Scheint benutzbar.
Keine doppelten AJAX-Calls mehr!</p>
<p>Bemerkung: kann auch sein, dass <code class="xref js js-func docutils literal"><span class="pre">Lino.gridPanel.calculatePageSize()</span></code>
lediglich besser integriert hätte werden müssen.
Er setzte GridPanel.pageSize auf False wenn die Grid noch nicht gerendert war...
das war ja wohl auch nicht toll.</p>
</div>
<div class="section" id="csv-export">
<h2>CSV-Export<a class="headerlink" href="#csv-export" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Wenn man CSV eines Slave-Reports anfragte, war die Datei immer leer.
Behoben.</li>
<li>Von ForeignKey-Feldern wurde nur die ID exportiert. Behoben.</li>
</ul>
<p>Aber das Encoding-Problem.</p>
<p>Laut <a class="reference external" href="http://forum.de.selfhtml.org/archiv/2008/3/t168392/">http://forum.de.selfhtml.org/archiv/2008/3/t168392/</a>
kommt unser encoding-Problem der CSV-Datei daher,
dass CSV-Dateien nun mal keine Möglichkeit vorsehen,
die verwendete Kodierung anzugeben.</p>
<p>Kann man in Excel vielleicht irgendwie einstellen,
dass er bei CSV-Dateien UTF-8 als Encoding vorsehen soll?</p>
<p>Ich kann alternativ die Dateien freilich mit einem &#8220;excelfreundlichen&#8221;
charset exportieren, indem ich das pro Site konfigurierbar mache.</p>
<p>Kleine Änderung in <cite>api_list_view</cite>, damit er als charset
im Content-Type-Header das encoding aus
<code class="xref py py-attr docutils literal"><span class="pre">lino.LinoSite.csv_params</span></code> holt.
Möglich, dass das nicht nötig ist, aber zur Sicherheit.</p>
<p>In der lokalen <code class="xref py py-class docutils literal"><span class="pre">lino.LinoSite</span></code>
(die in der <a class="reference external" href="http://www.lino-framework.org/dev/settings.html#xfile-settings.py" title="(in Lino v1.6)"><code class="xref std std-xfile docutils literal"><span class="pre">settings.py</span></code></a> definiert wird) kann man
nun einfach mal rumspielen mit verschiedenen encodings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">csv_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;,&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s">&#39;FOO&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Wobei ich für <code class="docutils literal"><span class="pre">FOO</span></code> die folgenden Werte (in dieser Reihenfolge)
ausprobieren möchte:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">utf_8_sig</span>
<span class="n">utf_16</span>
<span class="n">utf_16_le</span>
<span class="n">utf_16_be</span>
<span class="n">iso</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span>
<span class="n">cp1252</span>
</pre></div>
</div>
<p>Nach jeder Änderung muss man allerdings den Server neu starten.</p>
<p>Unter
<a class="reference external" href="http://docs.python.org/library/codecs.html#standard-encodings">http://docs.python.org/library/codecs.html#standard-encodings</a>
gibt es weitere Infos zu den möglichen Kodierungen.</p>
<p>Check-in 20110211b zwecks eventuellem
Zwischenrelease in Eupen um den CSV-Export zu testen.</p>
</div>
<div class="section" id="upgrading-to-python-2-7">
<h2>Upgrading to Python 2.7<a class="headerlink" href="#upgrading-to-python-2-7" title="Permalink to this headline">¶</a></h2>
<p>Sphinx Version 1.0.7 no longer runs on Python 2.5.
And a new stable Debian (Squeeze) has been released.
So there is no more reason to remain stucked with Python 2.5</p>
<p>A first consequence is that I removed the call to
<code class="xref py py-func docutils literal"><span class="pre">locale.setlocale()</span></code>
in
<code class="xref py py-func docutils literal"><span class="pre">lino.utils.babel.setlang()</span></code>.
Because it caused an &#8220;unsupported locale&#8221; error.
And because setlocale() is not thread-safe on most systems.
At because least for babel it is not necessary.</p>
</div>
<div class="section" id="save-changes-before-printing">
<h2>Save changes before printing<a class="headerlink" href="#save-changes-before-printing" title="Permalink to this headline">¶</a></h2>
<p>Und noch ein Punkt behoben:</p>
<ol class="arabic simple">
<li>Wenn man in einem Vertrag eine Angabe ändert
und dann &#8220;Drucken&#8221; klickt, dann wird die
Änderung irritierenderweise nicht gespeichert.</li>
</ol>
<p>Check-in 20110211c wegen Feierabend.</p>
</div>
<div class="section" id="debian-dist-upgrade-from-lenny-to-squeeze">
<h2>Debian dist-upgrade from lenny to squeeze<a class="headerlink" href="#debian-dist-upgrade-from-lenny-to-squeeze" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre>Unable to migrate to dependency-based boot system

Tests have determined that problems in the boot system exist which prevent migration to dependency-based boot
sequencing:

insserv: warning: script &#39;K20oood&#39; missing LSB tags and overrides, insserv: warning: script &#39;K20watch_tim&#39;
missing LSB tags and overrides, insserv: warning: script &#39;oood&#39; missing LSB tags and overrides, insserv:
warning: script &#39;watch_tim&#39; missing LSB tags and overrides,

If the reported problem is a local modification, it needs to be fixed manually. If it&#39;s a bug in the package, it
should be reported to the BTS and fixed in the package. See
http://wiki.debian.org/LSBInitScripts/DependencyBasedBoot for more information about how to fix the problems
preventing migration.

To reattempt the migration process after the problems have been fixed, run &quot;dpkg-reconfigure sysv-rc&quot;.
</pre></div>
</div>
<p>Ich schätze, dass ich meine beiden init.d-Scripts mal deinstallieren und dann wieder neu installieren muss.</p>
<div class="highlight-python"><div class="highlight"><pre>Reboot needed after this upgrade

You are currently upgrading udev using an incompatible kernel version. A compatible version is installed or
being installed on the system, but you need to reboot using this new kernel as soon as the upgrade is complete.

Without a reboot with this new kernel version, the system may become UNUSABLE.

OK
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>The new Linux kernel version provides different drivers for some PATA (IDE) controllers. The names of some hard
disk, CD-ROM, and tape devices may change.

It is now recommended to identify disk devices in configuration files by label or UUID (unique identifier)
rather than by device name, which will work with both old and new kernel versions.

If you choose to not update the system configuration automatically, you must update device IDs yourself before
the next system reboot or the system may become unbootable.

Update disk device IDs in system configuration?

Yes
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Boot loader configuration check needed

The boot loader configuration for this system was not recognized. These settings in the configuration may need
to be updated:

 * The root device ID passed as a kernel parameter;
 * The boot device ID used to install and update the boot loader.


You should generally identify these devices by UUID or label. However, on MIPS systems the root device must be
identified by name.
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Configuration file `/etc/modprobe.d/blacklist.conf&#39;
 ==&gt; File on system created by you or by a script.
 ==&gt; File also in package provided by package maintainer.
   What would you like to do about it ?  Your options are:
    Y or I  : install the package maintainer&#39;s version
    N or O  : keep your currently-installed version
      D     : show the differences between the versions
      Z     : start a shell to examine the situation
 The default action is to keep your current version.
*** blacklist.conf (Y/I/N/O/D/Z) [default=N] ?
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Configuration file `/etc/apache2/envvars&#39;
 ==&gt; Modified (by you or by a script) since installation.
 ==&gt; Package distributor has shipped an updated version.
   What would you like to do about it ?  Your options are:
    Y or I  : install the package maintainer&#39;s version
    N or O  : keep your currently-installed version
      D     : show the differences between the versions
      Z     : start a shell to examine the situation
 The default action is to keep your current version.
*** envvars (Y/I/N/O/D/Z) [default=N] ?
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Configuration file `/etc/apache2/sites-available/default&#39;
 ==&gt; Modified (by you or by a script) since installation.
 ==&gt; Package distributor has shipped an updated version.
   What would you like to do about it ?  Your options are:
    Y or I  : install the package maintainer&#39;s version
    N or O  : keep your currently-installed version
      D     : show the differences between the versions
      Z     : start a shell to examine the situation
 The default action is to keep your current version.
*** default (Y/I/N/O/D/Z) [default=N] ?
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Starting web server: apache2(2)No such file or directory: apache2: could not open error log file /etc/apache2/${APACHE_L
OG_DIR}/error.log.
Unable to open logs
Action &#39;start&#39; failed.
The Apache error log may have more information.
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Setting up update-inetd (4.38+nmu1) ...
ERROR 1577 (HY000) at line 1: Cannot proceed because system tables used by Event Scheduler were found damaged at server
start
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>lino:/usr/local/lib/python2.6# /etc/init.d/apache2 start
Starting web server: apache2(2)No such file or directory: apache2: could not open error log file /etc/apache2/${APACHE_LOG_DIR}/error.log.
Unable to open logs
Action &#39;start&#39; failed.
The Apache error log may have more information.
 failed!
</pre></div>
</div>
<p>Lösung: von
<a class="reference external" href="http://ubuntuforums.org/showthread.php?t=1639623">http://ubuntuforums.org/showthread.php?t=1639623</a>
habe ich mir eine Originalversion der <cite>/etc/apache2/envvars</cite> kopiert.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0212.html" title="20110212"
             >next</a> |</li>
        <li class="right" >
          <a href="0208.html" title="20110208"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2011</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2011/0211.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2011/0211.html">Online Link</a>
    </div>
  </body>
</html>