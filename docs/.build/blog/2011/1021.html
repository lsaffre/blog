<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20111021 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2011" href="index.html" />
    <link rel="next" title="20111023" href="1023.html" />
    <link rel="prev" title="20111020" href="1020.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="1023.html" title="20111023"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="1020.html" title="20111020"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2011</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20111021<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="launch-office-application-on-webdav-link-using-applet">
<h2>Launch Office application on webdav link using Applet<a class="headerlink" href="#launch-office-application-on-webdav-link-using-applet" title="Permalink to this headline">¶</a></h2>
<p>Worked on <a class="reference external" href="https://github.com/lsaffre/lino/blob/master/docs/tickets/45">docs/tickets/45</a> using a Java Applet.
Files <a class="reference external" href="https://github.com/lsaffre/lino/blob/master//media/applets/davopen_test.html">/media/applets/davopen_test.html</a> and <a class="reference external" href="https://github.com/lsaffre/lino/blob/master//java">/java</a></p>
<p>Insgesamt ist es erschreckend, wie kompliziert diese Lösung wird!</p>
<p>Hier ein Snippet, das <cite>java.utils.prefs</cite> benutzt um aus der Windows-Registry
zu lesen: <a class="reference external" href="http://www.kodejava.org/examples/236.html">http://www.kodejava.org/examples/236.html</a>
Aber das nützt uns nichts, denn es kann nur unterhalb von
<cite>HKCUSoftwareJavaSoftPrefs</cite> lesen und schreiben.</p>
<p>Dann hier noch ein Projekt, das aus der Windows-Registry lesen
kann und keine dll auf den Clients benötigt:
| <a class="reference external" href="http://sourceforge.net/projects/java-registry/">http://sourceforge.net/projects/java-registry/</a>
| <a class="reference external" href="http://code.google.com/p/java-registry/">http://code.google.com/p/java-registry/</a></p>
<p>Hier auch ein interessantes Beispiel dazu:</p>
<p><a class="reference external" href="http://www.java-forum.org/codeschnipsel-u-projekte/38144-registry-auslesen.html#post268674">http://www.java-forum.org/codeschnipsel-u-projekte/38144-registry-auslesen.html#post268674</a></p>
<p>Es zeigt diesen zweifachen Zugriff, den ich auch schon in meiner
startfile.js (aber nur mit FF) mache. Das Beispiel ist allerdings zum
<em>Setzen</em> der Verknüpfung, ich muss es noch adaptieren zum <em>Lesen</em>.</p>
<p>Die beste Dokumentation zu diesem Package ist (ähnlich wie bei Lino)
der Source-Code:
<a class="reference external" href="http://code.google.com/p/java-registry/source/browse/trunk/src/at/jta/Regor.java">http://code.google.com/p/java-registry/source/browse/trunk/src/at/jta/Regor.java</a></p>
<p>Das könnte klappen... vorher muss ich noch neu lernen,
wie ich das installiere und ins
Applet einpacke. Denn was der Autor da macht ist zu komplex um einfach
rauszukopieren und selber zu warten.</p>
<p>Aber nein! Das wird schon allein scheitern, wenn ein Benutzer keine Administrator-Rechte hat. Vergiss es!</p>
<p>Eine mögliche Lösung scheint, dass wir eine hardkodierte Liste von
möglichen Pfaden und Verknüpfungen haben, und dass unser Applet die
Festplatte des Clients absucht, ob es ein taugliches Programm findet.
Das Resultat der Suche schreibt es sich in die Preferences.
Wenn man es dann manuell ändern will, kann ein Verwalter
das unter Windows mit regedit. Der Verwalter könnte auch (wenn er will)
auf allen Clients schon den bekannten Werte dort einschreiben.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="51%" />
<col width="41%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ext.</th>
<th class="head">Binaries (Windows)</th>
<th class="head">Binaries (Unix)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>doc</td>
<td>windword.exe, soffice.exe</td>
<td>soffice</td>
</tr>
<tr class="row-odd"><td>xls</td>
<td>excel.exe, soffice.exe</td>
<td>soffice</td>
</tr>
<tr class="row-even"><td>rtf</td>
<td>windword.exe, soffice.exe</td>
<td>soffice</td>
</tr>
<tr class="row-odd"><td>odt</td>
<td>soffice.exe</td>
<td>soffice</td>
</tr>
</tbody>
</table>
<p>Um nicht alle Festplatten von oben bis unten zu durchsuchen,
können wir eine hardcodierte Liste von Verzeichnissen erstellen:</p>
<ul class="simple">
<li>Windows : &#8220;Program Files&#8221;</li>
<li>Unix : &#8220;/usr/bin&#8221;</li>
</ul>
</div>
<div class="section" id="unicodedecodeerror-at-api-dsbe-languageknowledgesbyperson-279">
<h2>UnicodeDecodeError at /api/dsbe/LanguageKnowledgesByPerson/279<a class="headerlink" href="#unicodedecodeerror-at-api-dsbe-languageknowledgesbyperson-279" title="Permalink to this headline">¶</a></h2>
<p>Den Fehler, der diese Fehlermeldung hervorrief,
habe ich nicht reproduzieren können, aber
während der Suche habe ich zwei andere Bugs behoben:</p>
<ul class="simple">
<li><code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.countries.fixtures.few_languages</span></code> filled only in Englisch.
Now it respects <a class="reference external" href="http://www.lino-framework.org/ref/settings.html#setting-LANGUAGES" title="(in Lino v1.6)"><code class="xref std std-setting docutils literal"><span class="pre">LANGUAGES</span></code></a>.</li>
<li>Es war nicht möglich, in Feldern wie
<cite>spoken</cite> oder <cite>written</cite> in
<code class="xref py py-class docutils literal"><span class="pre">lino.apps.dsbe.models.LanguageKnowledge</span></code>
einen einmal gesetzten Wert wieder auf leer zu setzen.
Das galt für alle Felder mit einer <code class="xref py py-class docutils literal"><span class="pre">lino.utils.choicelists.ChoiceList</span></code>.</li>
</ul>
</div>
<div class="section" id="new-option-strict-for-resolve-model">
<h2>New Option &#8220;strict&#8221; for <cite>resolve_model</cite><a class="headerlink" href="#new-option-strict-for-resolve-model" title="Permalink to this headline">¶</a></h2>
<p><code class="xref py py-func docutils literal"><span class="pre">lino.tools.resolve_model()</span></code> has a new option strict.
When <cite>strict=True</cite>, it raises an exception instead of returning
<code class="xref py py-class docutils literal"><span class="pre">lino.tools.UnresolvedModel</span></code>.
Helped me to understand that <a class="reference external" href="http://www.lino-framework.org/ref/settings.html#setting-INSTALLED_APPS" title="(in Lino v1.6)"><code class="xref std std-setting docutils literal"><span class="pre">INSTALLED_APPS</span></code></a> in
<code class="xref py py-mod docutils literal"><span class="pre">lino.apps.std.settings</span></code> needs to include
<a class="reference external" href="http://www.lino-framework.org/api/lino.modlib.users.html#module-lino.modlib.users" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.users</span></code></a> to avoid problems during autodoc.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="1023.html" title="20111023"
             >next</a> |</li>
        <li class="right" >
          <a href="1020.html" title="20111020"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2011</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2011/1021.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2011/1021.html">Online Link</a>
    </div>
  </body>
</html>