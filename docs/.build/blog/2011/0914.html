<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20110914 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2011" href="index.html" />
    <link rel="next" title="20110915" href="0915.html" />
    <link rel="prev" title="20110913" href="0913.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0915.html" title="20110915"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0913.html" title="20110913"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2011</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20110914<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="mails">
<h2>Mails<a class="headerlink" href="#mails" title="Permalink to this headline">¶</a></h2>
<p>Database change in <code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.mails</span></code>: there&#8217;s only one table
<cite>Mail</cite>, not two separate tables <cite>OutMail</cite> and <cite>InMail</cite>.</p>
</div>
<div class="section" id="job-requests">
<h2>Job Requests<a class="headerlink" href="#job-requests" title="Permalink to this headline">¶</a></h2>
<p>Tilt! <code class="xref py py-mod docutils literal"><span class="pre">lino.modlib.jobs</span></code> does not need a PersonsByOffer,
but a RequestsByOffer.
Entering a Job Offer now gives reasonable results in the &#8220;Candidate&#8221;
slave grid.
Added some sectors and functions in dsbe/demo fixture.</p>
</div>
<div class="section" id="sending-mails">
<h2>Sending Mails<a class="headerlink" href="#sending-mails" title="Permalink to this headline">¶</a></h2>
<p>Event instances now also have a &#8220;Create Mail&#8221; button.</p>
<p>There was a conceptual problem about the <code class="xref py py-meth docutils literal"><span class="pre">setup_report()</span></code>
model method: we cannot use super() in such a method because
the ultimate base class of all models, Django&#8217;s <cite>models.Model</cite>
class, doesn&#8217;t have this method. That&#8217;s why I wrote
<a class="reference external" href="http://www.lino-framework.org/api/lino.utils.html#lino.utils.call_on_bases" title="(in Lino v1.6)"><code class="xref py py-func docutils literal"><span class="pre">lino.utils.call_on_bases()</span></code></a>. <code class="xref py py-meth docutils literal"><span class="pre">setup_report()</span></code>
methods should not call <cite>super()</cite>, but Lino will call
automagically call the <cite>setup_report</cite> method of all base
classes. This also means that you cannot avoid them being called
(as would be possible if we could use <cite>super()</cite>)</p>
</div>
<div class="section" id="deleting-mails">
<h2>Deleting Mails<a class="headerlink" href="#deleting-mails" title="Permalink to this headline">¶</a></h2>
<p>Lino refused to delete a Mail when it had Recipients.
You had to delete the Recipients first.</p>
<p>To solve this, we added the magic <code class="xref py py-meth docutils literal"><span class="pre">allow_cascaded_delete()</span></code>
Model attribute.</p>
<p>This is now set to True in the following models:</p>
<div class="line-block">
<div class="line"><a class="reference external" href="http://www.lino-framework.org/api/lino.modlib.uploads.models.html#lino.modlib.uploads.models.Upload" title="(in Lino v1.6)"><code class="xref py py-class docutils literal"><span class="pre">lino.modlib.uploads.models.Upload</span></code></a></div>
<div class="line"><code class="xref py py-class docutils literal"><span class="pre">lino.modlib.mails.models.Recipient</span></code></div>
<div class="line"><code class="xref py py-class docutils literal"><span class="pre">lino.modlib.mails.models.Attachment</span></code></div>
<div class="line"><code class="xref py py-class docutils literal"><span class="pre">lino.modlib.links.models.Link</span></code></div>
</div>
</div>
<div class="section" id="deleting-a-row-didn-t-refresh-the-grid">
<h2>Deleting a row didn&#8217;t refresh the grid<a class="headerlink" href="#deleting-a-row-didn-t-refresh-the-grid" title="Permalink to this headline">¶</a></h2>
<p>The action&#8217;s <cite>after_success</cite> (set to the panel&#8217;s <cite>after_delete</cite>)
was never called after a successful DELETE action because the
response to DELETE has no response text.</p>
<p>As a result, when do_action now calls <cite>after_success</cite>, it now no
longer passes the result as first parameter (a feature which wasn&#8217;t
used anyway).</p>
</div>
<div class="section" id="translations">
<h2>Translations<a class="headerlink" href="#translations" title="Permalink to this headline">¶</a></h2>
<p>Upated German and French translation files.</p>
</div>
<div class="section" id="classmethod-objects-have-no-im-func-in-python-2-6">
<h2>classmethod objects have no <cite>im_func</cite> in Python 2.6<a class="headerlink" href="#classmethod-objects-have-no-im-func-in-python-2-6" title="Permalink to this headline">¶</a></h2>
<p>Mist, mein Trick mit <a class="reference external" href="http://www.lino-framework.org/api/lino.utils.html#lino.utils.call_on_bases" title="(in Lino v1.6)"><code class="xref py py-func docutils literal"><span class="pre">lino.utils.call_on_bases()</span></code></a>
von heute morgen funktioniert nicht in Python 2.6.</p>
<p>Mal überlegen: was will ich eigentlich?
Also ich will, dass man in Models optional eine Klassenmethode namens
<cite>setup_report</cite> definieren kann, die dann von jedem Report mit diesem
Model aufgerufen wird.
Das ging zunächst ganz gut, aber wenn ich ein Model mit mehreren Basisklassen
definiere von denen einige so eine Methode haben, dann musste ich dran denken,
dort auch eine setup_report zu schreiben, die das dispatching macht.
Z.B. in <cite>cal.Guest</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">setup_report</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="n">rpt</span><span class="p">):</span>
    <span class="n">mixins</span><span class="o">.</span><span class="n">CachedPrintable</span><span class="o">.</span><span class="n">setup_report</span><span class="p">(</span><span class="n">rpt</span><span class="p">)</span>
    <span class="n">Mailable</span><span class="o">.</span><span class="n">setup_report</span><span class="p">(</span><span class="n">rpt</span><span class="p">)</span>
</pre></div>
</div>
<p><cite>super()</cite> kann ich nicht benutzen, weil <cite>django.db.models.Model</cite>
keine Methode <cite>setup_report</cite> hat.</p>
<p>Ich habe noch mit einer <a class="reference external" href="http://www.lino-framework.org/api/lino.utils.html#lino.utils.call_optional_super" title="(in Lino v1.6)"><code class="xref py py-func docutils literal"><span class="pre">lino.utils.call_optional_super()</span></code></a> probiert,
aber das klappt auch nicht.</p>
<p>Also weiterhin wie bisher: Vorsicht wenn ich ein Modell mit mehreren Mixins
definiere: Falls mehr als eine der Basisklassen eine <cite>setup_report</cite> hat,
muss ich auch selber eine <cite>setup_report</cite> definieren,
die die <cite>setup_report</cite> der Basisklassen aufruft.
Wenn ich das nicht mache, wird nur die erstbeste <cite>setup_report</cite> gerufen.
Doof, aber so isses.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0915.html" title="20110915"
             >next</a> |</li>
        <li class="right" >
          <a href="0913.html" title="20110913"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2011</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2011/0914.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2011/0914.html">Online Link</a>
    </div>
  </body>
</html>