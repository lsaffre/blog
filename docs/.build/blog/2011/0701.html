<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20110701 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2011" href="index.html" />
    <link rel="next" title="20110711" href="0711.html" />
    <link rel="prev" title="20110630" href="0630.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0711.html" title="20110711"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0630.html" title="20110630"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2011</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20110701<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="uber-datetimefields">
<h2>Über DateTimeFields<a class="headerlink" href="#uber-datetimefields" title="Permalink to this headline">¶</a></h2>
<p>DateTimeField und TimeField wurden an verschiedenen Stellen noch nicht korrekt
verarbeitet, z.B. in ext_store, dpy,...)</p>
<p>Das <cite>Ext.ux.form.DateTime</cite>-Feld von Jozef Sakáloš funktioniert schön.
Aber heute habe ich gemerkt, dass ich es bis auf weiteres nicht brauchen werde,
weil ich gar keine bearbeitbaren Timestamps (DateTimeField) habe.
Da finde ich es eleganter,
nicht editierbare Timestamps wie die von
<a class="reference external" href="http://www.lino-framework.org/api/lino.mixins.html#lino.mixins.CreatedModified" title="(in Lino v1.6)"><code class="xref py py-class docutils literal"><span class="pre">lino.mixins.CreatedModified</span></code></a>
als einfache <cite>Ext.form.DisplayField</cite> anzuzeigen.</p>
<p>Falls aber doch irgendwann mal jemand ein editierbares DateTimeField
definieren sollte, müsste das theoretisch auch funktionieren und als
<cite>Ext.ux.form.DateTime</cite> gerendert werden.</p>
<p>Zu bemerken auch, dass <code class="xref py py-attr docutils literal"><span class="pre">lino.Lino.time_format_strftime</span></code>
ja keine Sekunden anzeigt. Momentan kann ich mir nicht vorstellen,
dass mal jemand Uhrzeiten mit einer größeren Genauigkeit
als Minuten eingeben will.
Timestamps werden deshalb bis auf weiteres nicht unter
Verwendung der lokaliserten date/time-Formate
sondern hardkodiert im ISO-Format angezeigt (YYYY-MM-DD hh:mm:ss).</p>
</div>
<div class="section" id="checkboxen-abschalten">
<h2>Checkboxen abschalten<a class="headerlink" href="#checkboxen-abschalten" title="Permalink to this headline">¶</a></h2>
<p>Upps, gerade sehe ich, dass man Checkboxen momentan (auch in <a class="reference external" href="http://www.lino-framework.org/releases/2011/0615.html">/releases/2011/0615</a>)
nicht abschalten konnte. Behoben.</p>
<p>Checkin 20110701</p>
</div>
<div class="section" id="standardfilter">
<h2>Standardfilter<a class="headerlink" href="#standardfilter" title="Permalink to this headline">¶</a></h2>
<p>Inaktive Personen nicht anzeigen in
<span class="menuselection">Kontakte ‣ Personen</span> und Auswahllisten.</p>
<p>Ein allgemeiner Filter ist ja leicht zu machen,
einfach <cite>Persons.filter`auf `dict(is_active=True)</cite> setzen.
Aber</p>
<ul class="simple">
<li>Wenn ein zuvor sichtbarer Record durch die Änderung verschwindet,
kommt nach dem Save momentan eine endlose Schleife von &#8220;Save changes to current record?&#8221;</li>
<li>wie mache ich es,
dass der Benutzer die inaktiven Leute bei Bedarf dann doch sehen kann?
Indem ich eine GridConfig dafür erstelle?
das wäre nicht ganz korrekt, denn das sollte eher eine
Option in allen Gridconfigs sein...</li>
<li>Auch zeigt er momentan nicht mehr das Detail solcher versteckten Personen an,
wenn ich von einem bestehenden ForeignKey darauf klicke.</li>
</ul>
<p>Die endlose Schleife von &#8220;Save changes to current record?&#8221; kam daher:</p>
<div class="highlight-python"><div class="highlight"><pre>if (rec.navinfo &amp;&amp; rec.navinfo.recno == 0) {
    /*
      recno 0 means &quot;the requested pk exists but is not contained in the requested queryset&quot;.
      This can happen e.g. after search_change on a detail.
    */
    //~ this_.goto_record_id(rec.navinfo.first);
    this_.load_record_id(rec.navinfo.first);
</pre></div>
</div>
<p>Der einzige Unterschied zwischen <cite>goto_record_id</cite> und <cite>load_record_id</cite> ist, dass
ersterer nachfragt, ob gespeichert werden soll. Und nach einem submit success
wird die Form nicht automatisch auf clean zurück gesetzt.
In diesem Sonderfall soll er das nie nachprüfen.</p>
<p>Um die beiden anderen Probleme zu lösen, habe ich das neue Attribut
<cite>lino.reports.Report.default_params</cite> gemacht.
Für die Auswahllisten funktioniert das jetzt schon.
Aber für die Befehle des Hauptmenüs muss ich mir noch was einfallen lassen.
Das Menü arbeitet ja dann mit get_request_url und müsste wenn schon
das &#8220;is_active=true&#8221; in der URL mit angeben.
Hmm...
Das System ist übrigens sowieso auch ziemlich aufwendig.</p>
<p>Checkin 20110701b</p>
</div>
<div class="section" id="report-default-params-wieder-raus">
<h2><cite>Report.default_params</cite> wieder raus<a class="headerlink" href="#report-default-params-wieder-raus" title="Permalink to this headline">¶</a></h2>
<p>Abends vor dem Einschlafen kam mir die Lösung: <cite>Report.default_params</cite> war Quatsch,
stattdessen mach ich einen eigenen Report und ein neues Optionales Attribut
<cite>_lino_choices_report</cite> in den Modellen.
Größtes Problem war noch, dass ich für Report.label unbedingt den <cite>verbose_name</cite> des Modells
wiederverwerten wollte.</p>
<p>Checkin 20110701c</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0711.html" title="20110711"
             >next</a> |</li>
        <li class="right" >
          <a href="0630.html" title="20110630"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2011</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.5/88x31.png" /></a>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 Generic License</a>.<br />
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
<a href="../../_sources/blog/2011/0701.txt">Show Source</a> 
    <a href="http://luc.lino-framework.org/blog/2011/0701.html">Online Link</a>
    </div>
  </body>
</html>