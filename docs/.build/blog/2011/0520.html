<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20110520 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2011" href="index.html" />
    <link rel="next" title="20110521" href="0521.html" />
    <link rel="prev" title="20110516" href="0516.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0521.html" title="20110521"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0516.html" title="20110516"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2011</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20110520<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Für heute habe ich mir vorgenommen, das Projekt <a class="reference external" href="http://www.lino-framework.org/tickets/4.html">/tickets/4</a>
mal endlich durchzuziehen.</p>
<p>After having done the second copy, re-applied all adjustments
and started the VM, I get the following init log:</p>
<div class="highlight-python"><div class="highlight"><pre>starting init logger
INIT: version 2.86 booting
stty: standard input: Invalid argument
mkdir: cannot create directory `/lib/init/rw/sendsigs.omit.d/&#39;: File exists
udev requires hotplug support, not started. failed!
failed!
Setting the system clock.
hwclock is unable to get I/O port access: the iopl(3) call failed.
Unable to set System Clock to: Fri May 20 14:05:02 EEST 2011 (warning).
Activating swap...done.
mount: permission denied
Couldnt get a file descriptor referring to the console
KDGKBMODE: Bad file descriptor
loadkeys: error reading keyboard mode
Problem when loading /etc/console/boottime.kmap.gz, use install-keymap (warning).
Setting the system clock.
hwclock is unable to get I/O port access: the iopl(3) call failed.
Unable to set System Clock to: Fri May 20 14:05:12 EEST 2011 (warning).
Cleaning up ifupdown....
Setting the system clock.
hwclock is unable to get I/O port access: the iopl(3) call failed.
Unable to set System Clock to: Fri May 20 14:05:12 EEST 2011 (warning).
Setting up networking....
Mounting local filesystems...done.
Activating swapfile swap...done.
Activating swap...done.
mount: permission denied
Setting the system clock.
hwclock is unable to get I/O port access: the iopl(3) call failed.
Unable to set System Clock to: Fri May 20 14:05:12 EEST 2011 (warning).
/etc/network/options still exists and it will be IGNORED! Read README.Debian of netbase. (warning).
Configuring network interfaces...if-up.d/mountnfs[venet0]: waiting for interface venet0:0 before doing NFS mounts (warning).
done.
Setting kernel variables (/etc/sysctl.conf)...done.
Setting kernel variables (/etc/sysctl.d/bindv6only.conf)...done.
Setting up X server socket directory /tmp/.X11-unix....
Setting up ICE socket directory /tmp/.ICE-unix....
Starting portmap daemon....
/etc/rcS.d/S15urandom: line 37: /dev/urandom: Permission denied
Cleaning up ifupdown....
Loading kernel module unix.
FATAL: Could not load /lib/modules/2.6.18-1-pve/modules.dep: No such file or directory
Loading kernel module af_packet.
FATAL: Could not load /lib/modules/2.6.18-1-pve/modules.dep: No such file or directory
Loading kernel module dummy.
FATAL: Could not load /lib/modules/2.6.18-1-pve/modules.dep: No such file or directory
Loading kernel module 8139too.
FATAL: Could not load /lib/modules/2.6.18-1-pve/modules.dep: No such file or directory
Loading kernel module rtl8139.
FATAL: Could not load /lib/modules/2.6.18-1-pve/modules.dep: No such file or directory
FATAL: Could not load /lib/modules/2.6.18-1-pve/modules.dep: No such file or directory
Creating device-mapper devices...unable to continue without /proc/misc and /proc/devices.
Creating device-mapper devices...unable to continue without /proc/misc and /proc/devices.
Loading device-mapper support.
Checking file systems...fsck 1.41.3 (12-Oct-2008)
done.
Setting kernel variables (/etc/sysctl.conf)...done.
Setting kernel variables (/etc/sysctl.d/bindv6only.conf)...done.
Mounting local filesystems...done.
Activating swapfile swap...done.
Running 0dns-down to make sure resolv.conf is ok...done.
Setting up networking....
/etc/network/options still exists and it will be IGNORED! Read README.Debian of netbase. (warning).
Configuring network interfaces...SIOCADDRT: File exists
Failed to bring up venet0.
done.
Starting portmap daemon....
Starting NFS common utilities: statd.
Loading the saved-state of the serial devices...
/dev/ttyS0: No such file or directory
/dev/ttyS0: No such file or directory
Setting sensors limitsNo sensors found!
Make sure you loaded all the kernel drivers you need.
Try sensors-detect to find out which these are.
No sensors found!
Make sure you loaded all the kernel drivers you need.
Try sensors-detect to find out which these are.
.
Setting console screen modes and fonts.
/etc/rcS.d/S55urandom: line 37: /dev/urandom: Permission denied
Recovering nvi editor sessions...none found.
Setting up X server socket directory /tmp/.X11-unix....
Setting up ICE socket directory /tmp/.ICE-unix....
INIT: Entering runlevel: 2
stty: standard input: Invalid argument
Starting system log daemon....
Starting kernel log daemon....
Starting system message bus: dbus.
Starting portmap daemon....
Starting Avahi mDNS/DNS-SD Daemon: avahi-daemon.
Starting enhanced syslogd: rsyslogd.
Starting deferred execution scheduler: atdStarting periodic command scheduler: crond.
Starting Postfix Mail Transport Agent: postfix.
Starting OpenBSD Secure Shell server: sshd.
Starting OpenBSD Secure Shell server: sshd.
Starting portmap daemon....
Starting PostgreSQL 8.3 database server: mainsh: /dev/null: Permission denied
fgets failure: Success
The program &quot;postgres&quot; is needed by pg_ctl but was not found in the
same directory as &quot;/usr/lib/postgresql/8.3/bin/pg_ctl&quot;.
Check your installation.
Removed stale pid file. Use of uninitialized value in subroutine entry at /usr/bin/pg_ctlcluster line 323. Use of uninitialized value in subroutine entry at /usr/bin/pg_ctlcluster line 324. Error: could not exec /usr/lib/postgresql/8.3/bin/pg_ctl /usr/lib/postgresql/8.3/bin/pg_ctl start -D /var/lib/postgresql/8.3/main -l /var/log/postgresql/postgresql-8.3-main.log -s -o -c config_file=&quot;/etc/postgresql/8.3/main/postgresql.conf&quot; : failed!
failed!
SpamAssassin Mail Filter Daemon: disabled, see /etc/default/spamassassin
Starting serpento: dictd.
Starting DirMngr: dirmngr.
Not starting fancontrol; run pwmconfig first. (warning).
Starting printer spooler: lpd.
Starting Mailman master qrunner: mailmanctl.
Starting MySQL database server: mysqld ..
Checking for corrupt, not cleanly closed and upgrade needing tables..
Starting NFS common utilities: statd.
FATAL: Could not load /lib/modules/2.6.18-1-pve/modules.dep: No such file or directory
Not starting NFS kernel daemon: no support in current kernel. (warning).
Starting internet superserver: inetd.
Starting Postfix Mail Transport Agent: postfix.
rsync daemon not enabled in /etc/default/rsync, not starting... (warning).
Starting Samba daemons: nmbd smbd.
saned disabled; edit /etc/default/saned
To enable saslauthd, edit /etc/default/saslauthd and set START=yes (warning).
Starting serpento: serpento.
Setting up X font server socket directory /tmp/.font-unix...done.
Starting X font server: xfs.
Starting Xprint servers: Xprt.
Traceback (most recent call last):
File &quot;/usr/lib/serpento/serpento.py&quot;, line 365, in ?
server = TCPServer(address, DictServer)
File &quot;/usr/lib/python2.4/SocketServer.py&quot;, line 330, in __init__
self.server_bind()
File &quot;/usr/lib/serpento/serpento.py&quot;, line 346, in server_bind
self.socket.bind(self.server_address)
File &quot;&lt;string&gt;&quot;, line 1, in bind
socket.error: (98, &#39;Address already in use&#39;)
/etc/rc2.d/S20xprint: ## ERROR: Can&#39;t find &quot;/usr/X11R6/bin/Xprt&quot;.
Zope starting all instances....
&#39;titaga&#39; is an old/purged instance, not started
Starting file alteration monitor: FAM.
Can&#39;t start Hardware abstraction layer - sysfs not mounted on /sys failed!
Starting deferred execution scheduler: atdStarting periodic command scheduler: crond failed!
Starting web server: apache2.
INIT: no more processes left in this runlevel
</pre></div>
</div>
<p>Hm, da funktioniert also noch einiges nicht.</p>
<p>Aha, zumindest eines habe ich noch gar nicht gemacht:
&#8220;Disable services that are no longer needed on a VM&#8221;, also</p>
<p>for SERVICE in <cite>checkfs.sh checkroot.sh
console-screen.sh
hwclock.sh
hwclockfirst.sh
lm-sensors
udev udev-mtab
keymap.sh</cite>
do</p>
<div class="highlight-python"><div class="highlight"><pre>update-rc.d  -f SERVICE remove
</pre></div>
</div>
<p>15 Uhr. Oh je! Jetzt habe ich
das Obige versehentlich <em>auf proxmox statt auf mops</em>
gemacht! Das habe ich zwar zum Glück dann gemerkt und für jeden Service
ein <cite>update-rc.d SERVICE default</cite> gemacht, aber das hat nichts gebracht.
Nach dem Restart meldet sich
proxmox nicht mehr. Weder das Web-Interface noch sshd. Jetzt muss ich also
zuerst mal Proxmox neu installieren (d.h. vorher den Rechner
aus dem Schrank ausbauen und eine Konsole anschließen...).
Nein... ich hab keine Lust!</p>
<p>Tastatur und Bildschirm angeschlossen und Neustart: in der Tat, da sind
lauter &#8220;failed!&#8221; im Bootlog.
Und er kommt auch mit Konsole gar nicht bis zum Login.
Ja, das Effizienteste ist jetzt, nochmal ganz von vorne zu beginnen:
Proxmox-Installations-CD rein und booten.</p>
<p>Meine Installations-CD ist eine Version 1.5 von Januar 2010,
also schon recht alt.
Aber ich werde ja keine neue CD brennen solange ich mit der alten Version
noch an keine Grenzen gestoßen bin.</p>
<p>Oh, ein Problem scheint wohl damit zu tun zu haben:
ich kann keine Templates runterladen.
Oder zumindest nicht das von Debian 6, das mich interessiert.</p>
<p>Er sagt:</p>
<div class="highlight-python"><div class="highlight"><pre>download finished     Abort
starting download: debian-6.0-standard_6.0-1_i386.tar.gz
--2011-05-20 15:51:15-- http://download.proxmox.com/appliances/system/debian-6.0-standard_6.0-1_i386.tar.gz
Resolving download.proxmox.com... 188.165.145.222
Connecting to download.proxmox.com|188.165.145.222|:80... connected.
HTTP request sent, awaiting response... 404 Not Found
2011-05-20 15:51:15 ERROR 404: Not Found.
</pre></div>
</div>
<p>Ich nehme an, dass die Liste der Standard-Templates
Teil der Proxmox-Version ist, und dass sich inzwischen Dateinamen
geändert haben.
In der Section &#8216;system&#8217; gibt es folgende Auswahl:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="12%" />
<col width="10%" />
<col width="34%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Description</td>
<td>Version</td>
<td>Type</td>
<td>Package name</td>
</tr>
<tr class="row-even"><td>CentOS 4 (standard)</td>
<td>4.7-1</td>
<td>openvz</td>
<td>centos-4-standard</td>
</tr>
<tr class="row-odd"><td>CentOS 5 (standard)</td>
<td>5.2-1</td>
<td>openvz</td>
<td>centos-5-standard</td>
</tr>
<tr class="row-even"><td>Debian 4.0 (standard)</td>
<td>4.0-5</td>
<td>openvz</td>
<td>debian-4.0-standard</td>
</tr>
<tr class="row-odd"><td>Debian 5.0 (standard)</td>
<td>5.0-2</td>
<td>openvz</td>
<td>debian-5.0-standard</td>
</tr>
<tr class="row-even"><td>Debian 6.0 (standard)</td>
<td>6.0-1</td>
<td>openvz</td>
<td>debian-6.0-standard</td>
</tr>
<tr class="row-odd"><td>Fedora 9 (standard)</td>
<td>9-2</td>
<td>openvz</td>
<td>fedora-9-standard</td>
</tr>
<tr class="row-even"><td>Ubuntu Hardy (standard)</td>
<td>8.04-3</td>
<td>openvz</td>
<td>ubuntu-8.04-standard</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Also mal ein <cite>dist-upgrade</cite> des Servers probieren. <cite>ssh root&#64;192.168.1.160</cite>
und dann:</p>
<div class="highlight-python"><div class="highlight"><pre>proxmox:~# aptitude update dist-upgrade
Reading package lists... Done
Building dependency tree
Reading state information... Done
Reading extended state information
Initializing package states... Done
Reading task descriptions... Done
The following NEW packages will be installed:
  libbind9-50{a} libdns58{a} libisc50{a} libisccc50{a} libisccfg50{a} liblwres50{a} pve-kernel-2.6.18-6-pve{a}
The following packages will be upgraded:
  apache2 apache2-mpm-prefork apache2-utils apache2.2-common apt apt-utils base-files bind9-host bzip2 cpio
  debian-archive-keyring dhcp3-client dhcp3-common dnsutils dpkg gzip iputils-ping libapache2-mod-perl2 libapr1
  libaprutil1 libbind9-40 libbz2-1.0 libc6 libc6-i386 libdns45 libexpat1 libfreetype6 libgd2-noxpm libgnutls26
  libhtml-parser-perl libisc45 libisccc40 libisccfg40 libkrb53 libldap-2.4-2 liblwres40 libmysqlclient15off
  libnewt0.52 libperl5.10 libpng12-0 libpq5 libpve-storage-perl libsmbclient libssl0.9.8 libwbclient0 libwww-perl
  libxext6 libxml2 locales login lvm2 man-db mysql-common nano nfs-common ntp open-iscsi openssl passwd perl
  perl-base perl-modules perl-suid postfix proxmox-ve-2.6.18 pve-firmware pve-manager pve-qemu-kvm-2.6.18 python2.5
  python2.5-minimal qemu-server samba-common smbfs tar tzdata usbutils vzctl vzdump vzprocps w3m wget whiptail
The following packages are RECOMMENDED but will NOT be installed:
  ca-certificates libapache2-reload-perl libbsd-resource-perl libfribidi0 libhtml-format-perl xml-core
82 packages upgraded, 7 newly installed, 0 to remove and 0 not upgraded.
Need to get 93.3MB of archives. After unpacking 767kB will be used.
</pre></div>
</div>
<p>Das aktualisiert zwar meinen Proxmox auf die Version 1.8, aber ändert
nichts daran, dass ich das Template für Debian 6.0 nicht runterladen kann.</p>
<p>Aha: Debian 5.0 geht wohl. Das hatte ich vor dem dist-upgrade nicht probiert.
Na gut, dann nehmen wir eben Lenny statt Squeeze, das ist mir ja egal,
ich mach ja sowieso nur einen Dummy.</p>
<p>Na wer sagts denn. So schlimm war es gar nicht.
Von Null bis zum ersten großen <cite>rsync</cite> hat es ja jetzt gar nicht
mehr lange gedauert, ich kriege mittlerweile Routine...</p>
<p>Aber jetzt hat er 5 Stunden zu tun, und ich habe viel Arbeit im Garten.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0521.html" title="20110521"
             >next</a> |</li>
        <li class="right" >
          <a href="0516.html" title="20110516"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2011</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2011/0520.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2011/0520.html">Online Link</a>
    </div>
  </body>
</html>