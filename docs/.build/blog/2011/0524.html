<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20110524 &mdash; Luc&#39;s website</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/centeredlogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/taglist_tags.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Luc&#39;s website"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Luc&#39;s website" href="../../index.html" />
    <link rel="up" title="2011" href="index.html" />
    <link rel="next" title="20110525" href="0525.html" />
    <link rel="prev" title="20110523" href="0523.html" />
   
<script src="../../.htmldata/lightbox/js/jquery-1.11.0.min.js"></script>
<script src="../../.htmldata/lightbox/js/lightbox.min.js"></script>
<link href="../../.htmldata/lightbox/css/lightbox.css" rel="stylesheet" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="0525.html" title="20110525"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="0523.html" title="20110523"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">2011</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>20110524<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="wysiwyg-editor">
<h2>Wysiwyg-Editor<a class="headerlink" href="#wysiwyg-editor" title="Permalink to this headline">¶</a></h2>
<p>10 Uhr. Die <a class="reference external" href="http://blogs.byte-force.com/xor/tinymce/index.html">TinyMCE-Komponente für ExtJS</a>
von Andrew Mayorov funktioniert.
<code class="xref py py-attr docutils literal"><span class="pre">lino.Lino.use_tinymce</span></code>.
Ich weiß noch lange nicht alles über TinyMCE (die Seite
<a class="reference external" href="http://tinymce.moxiecode.com/wiki.php/%22For_Dummies%22">TinyMCE for Dummies</a>
war genau was ich brauchte), aber die Integration in Lino war ein erfreuliches
Erlebnis.</p>
<p>Außer natürlich, dass auch TinyMCE in HTML und nicht in XHTML speichert.
Da ist wahrscheinlich am effizientesten (für mich, nicht für die
armen CPUs, auf denen Lino läuft), wenn ich mein
<a class="reference external" href="http://www.lino-framework.org/api/lino.utils.html2xhtml.html#module-lino.utils.html2xhtml" title="(in Lino v1.6)"><code class="xref py py-mod docutils literal"><span class="pre">lino.utils.html2xhtml</span></code></a> fertig mache. Und mit &#8220;fertig&#8221; meine
ich natürlich &#8220;brauchbar&#8221;.</p>
<p>Checkin 20110524 mit ersten Erfolgserlebnissen und folgenden noch
offenen Problemen:</p>
<ul>
<li><p class="first">Zentrierte Absätze werden nicht zentriert gedruckt</p>
</li>
<li><p class="first">Der Editor wird nicht schreibgeschützt, wenn die Notiz ausgedruckt wurde.
<cite>Ext.ux.TinyMCE</cite> ignoriert offenbar die Option <cite>disabled</cite>.</p>
</li>
<li><p class="first">Mindestens eines der Sonderzeichen &#8220;Ω&#8221;, &#8220;Φ&#8221; oder &#8220;→&#8221; führt beim Ausdrucksversuch zur Fehlermeldung
<code class="docutils literal"><span class="pre">'charmap'</span> <span class="pre">codec</span> <span class="pre">can't</span> <span class="pre">encode</span> <span class="pre">character</span> <span class="pre">u'\u03a9'</span> <span class="pre">in</span> <span class="pre">position</span> <span class="pre">278:</span>
<span class="pre">character</span> <span class="pre">maps</span> <span class="pre">to</span> <span class="pre">&lt;undefined&gt;</span></code>.</p>
</li>
<li><p class="first">Der folgende HTML-Inhalt in einer <cite>Note.body</cite> wird zwar korrekt
angezeigt, aber wenn ich ihn bearbeite, werden die Änderungen
nicht gespeichert:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;p&gt;&lt;span id=&quot;ext-gen416&quot; style=&quot;background-color: #ffffff;&quot;&gt;Also ich probier mal.&lt;br /&gt;Schreibe ein bisschen Text.&lt;br /&gt;&lt;br /&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&quot;ext-gen418&quot;&gt;&lt;span style=&quot;background-color: #ffffff;&quot;&gt;&lt;span id=&quot;ext-gen408&quot; style=&quot;font-size: 32px; font-weight: bold;&quot;&gt;Aufz&amp;auml;hlungen:&lt;/span&gt;&lt;/span&gt;&lt;/h1&gt;
&lt;ol&gt;&lt;li&gt;Eins&lt;/li&gt; &lt;li&gt;Zwei&lt;/li&gt;  &lt;li&gt;Drei&lt;/li&gt; &lt;li&gt;Vier&lt;/li&gt; &lt;li&gt;F&amp;uuml;nf&lt;/li&gt;&lt;/ol&gt;
&lt;p&gt;&lt;span style=&quot;background-color: #ffffff;&quot;&gt;&lt;span style=&quot;background-color: #ffffff;&quot;&gt;&lt;br /&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div id=&quot;ext-gen420&quot;&gt;&lt;span style=&quot;border-collapse: collapse; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px;&quot;&gt;Aber f&amp;uuml;r :field:`notes&lt;/span&gt;&lt;span style=&quot;border-collapse: collapse; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px;&quot;&gt;.Note.body` gilt das nicht.&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;border-collapse: collapse; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px;&quot;&gt;Daf&amp;uuml;r ist er ideal. Auch der Ausdruck funktioniert einfach,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;border-collapse: collapse; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px;&quot;&gt;indem ich in&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;border-collapse: collapse; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px;&quot;&gt;&lt;a href=&quot;https://github.com/VinylFox/ExtJS.ux.HtmlEditor.Plugins&quot; target=&quot;_self&quot;&gt;appy.pod&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div id=&quot;ext-gen420&quot;&gt;&lt;span style=&quot;border-collapse: collapse; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px;&quot;&gt;die folgende Formel verwende::&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style=&quot;border-collapse: collapse; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px;&quot;&gt;&lt;br /&gt;&lt;/span&gt;&lt;/div&gt;
&lt;blockquote class=&quot;webkit-indent-blockquote&quot; style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;
&lt;div&gt;&lt;span style=&quot;border-collapse: collapse; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px;&quot;&gt;&amp;nbsp; do text&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span style=&quot;border-collapse: collapse; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px;&quot;&gt;&amp;nbsp; from xhtml(self.body)&lt;/span&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;div&gt;&lt;span style=&quot;border-collapse: collapse; -webkit-border-horizontal-spacing: 2px; -webkit-border-vertical-spacing: 2px;&quot;&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;
</pre></div>
</div>
<p>Der HTML-Code stammt glaube ich von meinen Experimenten mit VinylFox.
Ich tippe momentan darauf, dass die SPANs mit den
style-Angaben den TinyMCE durcheinanderbringen,
aber weil das Phänomen nur in diesem Fall auftritt,
lass ich das momentan offen.</p>
</li>
</ul>
</div>
<div class="section" id="dokumentation">
<h2>Dokumentation<a class="headerlink" href="#dokumentation" title="Permalink to this headline">¶</a></h2>
<p>Ha! Zwischenducrh ist mir eine plötzliche Eingebung gekommen, wie ich ein
altes Problem beim Generieren der Dokumentation mit Autodoc lösen kann.</p>
<p>Ich kann in der Dokumentation jetzt alle Model-Klassen
wie <code class="xref py py-class docutils literal"><span class="pre">lino.apps.dsbe.models.CourseRequest</span></code>
referenzieren.</p>
<p>Django erlaubt es, auch mehrere Lino-Anwendungen gleichzeitig zu importieren.
Die sind dann nur nicht aktiv.</p>
<p>Ich musste lediglich eine kleine Änderung machen:
<code class="xref py py-func docutils literal"><span class="pre">lino.core.kernel.setup_site()</span></code> hält jetzt Ausschau, ob ein Modell eine Klassenmethode
<cite>site_setup</cite> definiert hat. Falls ja, ruft er sie auf.</p>
<p>Wenn man vorher schrieb:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="o">...</span>
<span class="n">FOO_SPECIAL_FIELDS</span> <span class="o">=</span> <span class="n">reports</span><span class="o">.</span><span class="n">fields_list</span><span class="p">(</span><span class="n">Foo</span><span class="p">,</span><span class="s">&#39;name remarks&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Dann muss es jetzt so gemacht werden:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="o">...</span>
<span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">site_setup</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="n">lino</span><span class="p">):</span>
    <span class="n">lino</span><span class="o">.</span><span class="n">FOO_SPECIAL_FIELDS</span> <span class="o">=</span> <span class="n">reports</span><span class="o">.</span><span class="n">fields_list</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="s">&#39;name remarks&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Der Grund dafür ist, dass Autodoc das Modul ansonsten nicht
importieren könnte, wenn es nicht in den INSTALLED_APPS
des DJANGO_SETTINGS_MODULE steht.</p>
<p>Könnte ich das nicht stattdessen mit dem
<a class="reference external" href="http://docs.djangoproject.com/en/dev/ref/signals/#class-prepared">class_prepared-Signal</a>
implementieren?
Antwort: nein, denn diese Methoden sollen erst aufgerufen werden,
wenn Django <em>alle</em>  Models prepared hat.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About me</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="https://github.com/lsaffre" target="_blank">GitHub</a>
<br/><a href="http://www.lino-framework.org" target="_blank">Lino</a>
<br/><a href="http://www.saffre-rumma.net" target="_blank">Rumma & Ko</a>
</p>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="0525.html" title="20110525"
             >next</a> |</li>
        <li class="right" >
          <a href="0523.html" title="20110523"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Blog</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >2011</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2015 Luc Saffre.
      Last updated on 2015-03-31.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.
    <a href="https://raw.github.com/lsaffre/blog/master/docs/blog/2011/0524.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://luc.lino-framework.org/blog/2011/0524.html">Online Link</a>
    </div>
  </body>
</html>